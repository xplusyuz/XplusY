
<!DOCTYPE html>
<html lang="uz"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Courses — Grid Cards</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
<link rel="icon" href="data:,">
<style>

:root{
  --bg:#f6f9fb; --card:#fff; --ink:#0d1b1e; --muted:#61726f;
  --pri:#10b981; --pri2:#059669; --ring:rgba(16,185,129,.35);
  --granite: radial-gradient(1200px 400px at 0% 0%, #ffffff 0%, #f6faf7 25%, #eff7f3 45%, #e9f3ef 60%, #e2efe9 75%, #dceae4 95%);
  --shadow:0 10px 30px rgba(16,185,129,.15); --radius:16px;
}
*{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--ink);
  font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans",sans-serif}
.btn{appearance:none;border:1px solid #dbe7e2;background:#fff;color:#0b3b32;padding:10px 14px;border-radius:12px;cursor:pointer;transition:.2s;box-shadow:0 2px 0 #e8f3ef}
.btn:hover{transform:translateY(-1px)}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.cards-wrap{max-width:1200px;margin:0 auto;padding:20px}
.cards-grid{display:grid;gap:18px}
.card3d{position:relative;border-radius:var(--radius);background:var(--granite);border:1px solid #e4eeea;box-shadow:0 1px 0 #f2faf6,0 12px 30px rgba(16,185,129,.12);overflow:hidden;transform-style:preserve-3d;transition:transform .25s, box-shadow .25s, border-color .25s}
.card3d:hover{transform:translateY(-6px) rotateX(2deg) rotateY(-2deg);box-shadow:0 18px 40px rgba(16,185,129,.22),0 2px 0 #e8f3ef;border-color:#cfeee3}
.media{aspect-ratio:16/10;width:100%;object-fit:cover;display:block;filter:saturate(1.05) contrast(1.02)}
.body{padding:14px 14px 16px}
.ctitle{margin:0 0 6px 0;font-size:18px;display:flex;align-items:center;gap:8px;flex-wrap:wrap;color:#064e3b}
.tag{font-size:12px;padding:4px 8px;border-radius:999px;border:1px solid rgba(16,185,129,.2);background:rgba(16,185,129,.08);color:#059669}
.desc{margin:0;color:#5b6a67;font-size:13px;min-height:2lh}
.foot{display:flex;justify-content:space-between;align-items:center;margin-top:12px}
.price{font-weight:800}.price.free{color:#047857}
.pill{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:999px;border:1px solid rgba(16,185,129,.35);background:#ffffff;text-decoration:none;color:#064e3b;font-weight:700;transition:transform .2s, box-shadow .2s;box-shadow:0 2px 0 #e8f3ef}
.pill:hover{transform:translateY(-1px);box-shadow:0 10px 22px rgba(16,185,129,.25)}
.pill[disabled]{opacity:.6;pointer-events:none}

/* Pretty toolbar */
.toolbar{position:sticky;top:0;z-index:10;display:flex;gap:10px;flex-wrap:wrap;align-items:center;
  background:rgba(255,255,255,.75);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);
  border:1px solid #e7f3ef;border-radius:14px;padding:12px;box-shadow:0 8px 24px rgba(16,185,129,.08)}
.toolbar .control{position:relative}
.toolbar select,.toolbar input[type=search]{
  appearance:none;border:1px solid #dbe7e2;background:#fff;border-radius:999px;padding:10px 38px 10px 40px;
  box-shadow:0 2px 0 #e8f3ef, 0 10px 22px rgba(16,185,129,.06); outline:none; min-width:170px;
}
.toolbar select:focus,.toolbar input[type=search]:focus{box-shadow:0 0 0 3px var(--ring), 0 2px 0 #e8f3ef}
/* Icons for controls */
.toolbar .icon{position:absolute;left:12px;top:50%;transform:translateY(-50%);pointer-events:none;opacity:.7}
.toolbar .clear{position:absolute;right:10px;top:50%;transform:translateY(-50%);border:none;background:transparent;cursor:pointer;opacity:.5}
.toolbar .clear:hover{opacity:.9}
.toolbar .badge{margin-left:auto;background:#e9f7f1;border:1px solid #c9efdf;color:#065f46;font-weight:700;padding:8px 12px;border-radius:999px}
.toolbar .reset{margin-left:0}

/* Dropdown chevron for <select> */
.toolbar select{
  background-image:url('data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2220%22 height=%2220%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%23059669 stroke-width=%222%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22><polyline points=%226 9 12 15 18 9%22/></svg>');
  background-repeat:no-repeat; background-position:right 12px center; background-size:18px;
}

.cards-grid{grid-template-columns: repeat(3, minmax(0,1fr));}
@media (max-width:1024px){ .cards-grid{grid-template-columns: repeat(2,minmax(0,1fr));} }
@media (max-width:640px){ .cards-grid{grid-template-columns: 1fr;} }
</style></head>
<body>
<div class="cards-wrap">
  <div class="toolbar">
    <div class="control">
      <i class="fa-solid fa-layer-group icon"></i>
      <select id="f1"><option value="">Barcha bo'limlar</option></select>
    </div>
    <div class="control">
      <i class="fa-solid fa-cubes icon"></i>
      <select id="f2"><option value="">Bo'lim 2</option></select>
    </div>
    <div class="control">
      <i class="fa-solid fa-cube icon"></i>
      <select id="f3"><option value="">Bo'lim 3</option></select>
    </div>
    <div class="control">
      <i class="fa-solid fa-tags icon"></i>
      <select id="ft">
        <option value="">Barchasi</option>
        <option value="free">FREE</option>
        <option value="pro">PRO</option>
        <option value="new">NEW</option>
      </select>
    </div>
    <div class="control" style="flex:1 1 260px; min-width:220px">
      <i class="fa-solid fa-magnifying-glass icon"></i>
      <input id="fq" type="search" placeholder="Qidirish (sarlavha, tavsif)">
      <button class="clear" id="clear-q" title="Tozalash"><i class="fa-solid fa-xmark"></i></button>
    </div>
    <button class="btn reset" id="reset"><i class="fa-solid fa-eraser"></i> Reset</button>
    <div class="badge" id="badge">0 ta</div>
  </div>

  <div id="chips" class="row" style="margin:12px 0 0 2px"></div>

  <div id="cards" class="cards-grid" style="margin-top:14px"></div>
  <div class="row" style="justify-content:center;margin-top:16px">
    <button id="prev" class="btn">⟵ Oldingi</button>
    <strong id="pi" style="min-width:90px;text-align:center"></strong>
    <button id="next" class="btn">Keyingisi ⟶</button>
  </div>
</div>
<script>
(function(){
  const $=(s,c=document)=>c.querySelector(s);
  const LS_KEY="xplusy_admin_v3";
  const PAGE_SIZE=12;
  function uniq(list,k){const s=new Set();list.forEach(c=>{const v=(c[k]||'').trim(); if(v) s.add(v)}); return Array.from(s).sort((a,b)=>a.localeCompare(b));}
  function el(h){const t=document.createElement('template');t.innerHTML=h.trim();return t.content.firstChild;}
  function price(v){v=+v||0; return v<=0?'<span class="price free">FREE</span>':'<span class="price">'+v.toLocaleString('uz-UZ')+' so\'m</span>';}

  const raw=localStorage.getItem(LS_KEY);
  let items=[];
  if(raw){ try{ const o=JSON.parse(raw); items=o.items||[]; }catch(e){} } else { items=__SEED__; }

  let cat='',cat2='',cat3='',tg='',q=''; let page=1;

  function match(c){
    if('courses'==='courses' && c.type!=='course') return false;
    if('courses'==='simulators' && c.type!=='sim') return false;
    if('courses'==='tests' && c.type!=='test') return false;
    if(cat && String(c.cat||'').trim()!==cat) return false;
    if(cat2 && String(c.cat2||'').trim()!==cat2) return false;
    if(cat3 && String(c.cat3||'').trim()!==cat3) return false;
    if(tg && String(c.tag||'').toLowerCase()!==tg) return false;
    if(q){ const s=((c.title||'')+' '+(c.desc||'')).toLowerCase(); if(!s.includes(q.toLowerCase())) return false; }
    return true;
  }
  function filtered(){ return items.filter(match); }
  function totalPages(){ return Math.max(1, Math.ceil(filtered().length/PAGE_SIZE)); }
  function clamp(){ const t=totalPages(); if(page>t) page=t; if(page<1) page=1; }

  function chip(label, onclear){
    const d=document.createElement('button');
    d.className='btn'; d.style.borderRadius='999px'; d.style.background='#ffffff'; d.style.borderColor='#cdeee2';
    d.innerHTML=label+' <i class="fa-solid fa-xmark"></i>';
    d.onclick=onclear;
    return d;
  }
  function drawChips(){
    const root=document.getElementById('chips'); root.innerHTML='';
    if(cat) root.appendChild(chip('Bo\'lim: '+cat, ()=>{cat=''; $('#f1').value=''; page=1; grid();}));
    if(cat2) root.appendChild(chip('Bo\'lim 2: '+cat2, ()=>{cat2=''; $('#f2').value=''; page=1; grid();}));
    if(cat3) root.appendChild(chip('Bo\'lim 3: '+cat3, ()=>{cat3=''; $('#f3').value=''; page=1; grid();}));
    if(tg) root.appendChild(chip('Tag: '+tg.toUpperCase(), ()=>{tg=''; $('#ft').value=''; page=1; grid();}));
    if(q) root.appendChild(chip('Qidiruv: '+q, ()=>{q=''; $('#fq').value=''; page=1; grid();}));
  }

  function cardCourse(c){
    return `<article class="card3d">${c.image?`<img class="media" src="${c.image}" alt="cover">`:''}
    <div class="body">
      <h3 class="ctitle">${c.title} ${c.tag?`<span class="tag">${String(c.tag).toUpperCase()}</span>`:''} ${c.cat?`<span class="tag">${c.cat}</span>`:''} ${c.cat2?`<span class="tag">${c.cat2}</span>`:''} ${c.cat3?`<span class="tag">${c.cat3}</span>`:''}</h3>
      ${c.desc?`<p class="desc">${c.desc}</p>`:''}
      <div class="foot">
        ${price(c.price)}
        ${c.link?`<a class="pill" href="${c.link}">${c.button||'Boshlash'} <i class="fa-solid fa-play"></i></a>`:''}
      </div>
    </div></article>`;
  }
  const cardSim = cardCourse;

  function cardTest(c){
    return `<article class="card3d" data-start="${c.start||''}" data-end="${c.end||''}" data-href="${c.link||'#'}" data-label="${c.button||'Boshlash'}">
    ${c.image?`<img class="media" src="${c.image}" alt="cover">`:''}
    <div class="body">
      <h3 class="ctitle">${c.title} ${c.tag?`<span class="tag">${String(c.tag).toUpperCase()}</span>`:''} ${c.cat?`<span class="tag">${c.cat}</span>`:''} ${c.cat2?`<span class="tag">${c.cat2}</span>`:''} ${c.cat3?`<span class="tag">${c.cat3}</span>`:''}</h3>
      ${c.desc?`<p class="desc">${c.desc}</p>`:''}
      <div class="foot">
        ${price(c.price)}
        <span class="slot"></span>
      </div>
    </div></article>`;
  }

  function grid(){
    clamp(); const root=document.getElementById('cards'); root.innerHTML='';
    const arr=filtered(); const start=(page-1)*PAGE_SIZE; const slice=arr.slice(start,start+PAGE_SIZE);
    slice.forEach(c=>{
      if('courses'==='tests') root.appendChild(el(cardTest(c))); else if('courses'==='simulators') root.appendChild(el(cardSim(c))); else root.appendChild(el(cardCourse(c)));
    });
    document.getElementById('pi').textContent=page+' / '+totalPages();
    document.getElementById('badge').textContent = arr.length + ' ta';
    drawChips();
    const prev=document.getElementById('prev'), next=document.getElementById('next');
    prev.disabled=page<=1; next.disabled=page>=totalPages();
    prev.onclick=()=>{ if(page>1){page--;grid();} }; next.onclick=()=>{ if(page<totalPages()){page++;grid();} };

    if('courses'==='tests'){
      Array.from(root.querySelectorAll('.card3d')).forEach(card=>{
        const slot=card.querySelector('.slot'); const start=card.dataset.start? new Date(card.dataset.start).getTime() : 0; const end=card.dataset.end? new Date(card.dataset.end).getTime() : 0;
        function fmt(ms){ const s=Math.max(0,Math.floor(ms/1000)); const d=Math.floor(s/86400), h=Math.floor((s%86400)/3600), m=Math.floor((s%3600)/60), ss=s%60; const parts=[]; if(d>0) parts.push(d+'k'); parts.push(String(h).padStart(2,'0')+':'+String(m).padStart(2,'0')+':'+String(ss).padStart(2,'0')); return parts.join(' '); }
        function draw(){
          const now=Date.now();
          if(!start||!end||end<=start){ slot.innerHTML='<span style="color:#b91c1c;font-weight:700">Vaqt sozlanmagan</span>'; return; }
          if(now<start){ slot.innerHTML='<span style="font-weight:700;letter-spacing:.3px" title="Boshlashgacha">'+fmt(start-now)+'</span>'; }
          else if(now>=start && now<end){ slot.innerHTML='<a class="pill" href="'+card.dataset.href+'">'+card.dataset.label+' <i class="fa-solid fa-play"></i></a>'; }
          else{ slot.innerHTML='<span style="color:#b91c1c;font-weight:700">Vaqt tugadi</span>'; }
        }
        draw(); setInterval(draw,1000);
      });
    }
  }

  function toolbar(){
    const f1=document.getElementById('f1'), f2=document.getElementById('f2'), f3=document.getElementById('f3'), ft=document.getElementById('ft'), fq=document.getElementById('fq');
    f1.innerHTML = '<option value="">Barcha bo\'limlar</option>' + uniq(items,'cat').map(v=>'<option>'+v+'</option>').join('');
    f2.innerHTML = '<option value="">Bo\'lim 2</option>' + uniq(items,'cat2').map(v=>'<option>'+v+'</option>').join('');
    f3.innerHTML = '<option value="">Bo\'lim 3</option>' + uniq(items,'cat3').map(v=>'<option>'+v+'</option>').join('');
    ft.onchange=()=>{ tg=ft.value; page=1; grid(); };
    f1.onchange=()=>{ cat=f1.value; page=1; grid(); };
    f2.onchange=()=>{ cat2=f2.value; page=1; grid(); };
    f3.onchange=()=>{ cat3=f3.value; page=1; grid(); };
    fq.oninput=()=>{ q=fq.value.trim(); page=1; grid(); };
    document.getElementById('clear-q').onclick=()=>{ fq.value=''; q=''; page=1; grid(); };
    document.getElementById('reset').onclick=()=>{ cat=cat2=cat3=tg=q=''; f1.value=f2.value=f3.value=ft.value=''; fq.value=''; page=1; grid(); };
  }

  document.addEventListener('DOMContentLoaded', ()=>{ toolbar(); grid(); });
})();
</script>
</body></html>
