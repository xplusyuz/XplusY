<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Testlar — X+Y.uz</title>
  <meta name="description" content="X+Y.uz — sinf va choraklar bo'yicha matematika testlari." />
  
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Covered+By+Your+Grace&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <style>
    /* Testlar sahifasi uchun maxsus uslublar */
    .tests-container {
      padding: 20px 0;
    }
    
    .filter-section {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 30px;
    }
    
    .filter-row {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 15px;
    }
    
    .filter-group {
      flex: 1;
      min-width: 200px;
    }
    
    .filter-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--primary);
    }
    
    .filter-select {
      width: 100%;
      padding: 12px 15px;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      background: rgba(0, 0, 0, 0.2);
      color: var(--text-dark);
      font-size: 15px;
    }
    
    .tests-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }
    
    .test-card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 20px;
      transition: transform 0.3s, box-shadow 0.3s;
      position: relative;
      overflow: hidden;
    }
    
    .test-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    }
    
    .test-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 15px;
    }
    
    .test-card-title {
      font-size: 18px;
      font-weight: 700;
      margin: 0;
      color: var(--primary);
    }
    
    .test-card-badge {
      background: var(--primary);
      color: white;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
    }
    
    .test-card-details {
      margin-bottom: 20px;
    }
    
    .test-card-detail {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
      font-size: 14px;
    }
    
    .test-card-detail i {
      margin-right: 10px;
      width: 16px;
      color: var(--primary);
    }
    
    .test-card-actions {
      display: flex;
      gap: 10px;
    }
    
    .test-card-btn {
      flex: 1;
      text-align: center;
      padding: 10px;
      border-radius: 8px;
      font-weight: 600;
      text-decoration: none;
      transition: all 0.2s;
    }
    
    .test-card-btn.primary {
      background: var(--primary);
      color: white;
    }
    
    .test-card-btn.secondary {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-dark);
    }
    
    .test-card-btn:hover {
      opacity: 0.9;
      transform: translateY(-2px);
    }
    
    .section-divider {
      height: 1px;
      background: rgba(255, 255, 255, 0.1);
      margin: 40px 0;
    }
    
    /* Light mode uchun sozlamalar */
    body.light .filter-section {
      background: rgba(0, 0, 0, 0.03);
    }
    
    body.light .filter-select {
      background: white;
      color: var(--text-light);
      border: 1px solid #ddd;
    }
    
    body.light .test-card {
      background: white;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }
    
    body.light .test-card-btn.secondary {
      background: #f3f4f6;
      color: var(--text-light);
    }
    
    /* Responsive design */
    @media (max-width: 768px) {
      .filter-row {
        flex-direction: column;
      }
      
      .filter-group {
        width: 100%;
      }
      
      .tests-grid {
        grid-template-columns: 1fr;
      }
    }
    
    /* Back to home button */
    .back-home {
      display: inline-flex;
      align-items: center;
      margin-bottom: 20px;
      color: var(--primary);
      text-decoration: none;
      font-weight: 600;
      transition: opacity 0.2s;
    }
    
    .back-home:hover {
      opacity: 0.8;
    }
    
    .back-home i {
      margin-right: 8px;
    }
  </style>
</head>
<body>
  <main>
    <div class="container tests-container">
      <!-- Back to home link -->
      <a href="#" class="back-home" id="backToHome">
        <i class="fas fa-arrow-left"></i> Bosh sahifaga qaytish
      </a>
      
      <div class="section-head">
        <h2>Matematika Testlari</h2>
        <p class="muted">Sinf va choraklar bo'yicha testlar to'plami</p>
      </div>

      <!-- CHSBlar bo'limi -->
      <section id="chsb-tests">
        <h3>CHSBlar</h3>
        
        <div class="filter-section">
          <div class="filter-row">
            <div class="filter-group">
              <label class="filter-label" for="chsb-class">Sinf</label>
              <select id="chsb-class" class="filter-select">
                <option value="5">5-sinf</option>
                <option value="6">6-sinf</option>
                <option value="7">7-sinf</option>
                <option value="8">8-sinf</option>
                <option value="9">9-sinf</option>
                <option value="10">10-sinf</option>
                <option value="11">11-sinf</option>
              </select>
            </div>
            
            <div class="filter-group">
              <label class="filter-label" for="chsb-quarter">Chorak</label>
              <select id="chsb-quarter" class="filter-select">
                <option value="1">1-chorak</option>
                <option value="2">2-chorak</option>
                <option value="3">3-chorak</option>
                <option value="4">4-chorak</option>
              </select>
            </div>
          </div>
        </div>
        
        <div class="tests-grid" id="chsb-tests-grid">
          <!-- Test kartalari JavaScript orqali to'ldiriladi -->
        </div>
      </section>
      
      <div class="section-divider"></div>
      
      <!-- BSB bo'limi -->
      <section id="bsb-tests">
        <h3>BSB</h3>
        
        <div class="filter-section">
          <div class="filter-row">
            <div class="filter-group">
              <label class="filter-label" for="bsb-class">Sinf</label>
              <select id="bsb-class" class="filter-select">
                <option value="1">1-sinf</option>
                <option value="2">2-sinf</option>
                <option value="3">3-sinf</option>
                <option value="4">4-sinf</option>
                <option value="5">5-sinf</option>
                <option value="6">6-sinf</option>
                <option value="7">7-sinf</option>
                <option value="8">8-sinf</option>
                <option value="9">9-sinf</option>
                <option value="10">10-sinf</option>
              </select>
            </div>
            
            <div class="filter-group">
              <label class="filter-label" for="bsb-level">Daraja</label>
              <select id="bsb-level" class="filter-select">
                <option value="1">1-daraja</option>
                <option value="2">2-daraja</option>
                <option value="3">3-daraja</option>
                <option value="4">4-daraja</option>
                <option value="5">5-daraja</option>
              </select>
            </div>
          </div>
        </div>
        
        <div class="tests-grid" id="bsb-tests-grid">
          <!-- Test kartalari JavaScript orqali to'ldiriladi -->
        </div>
      </section>
      
      <div class="section-divider"></div>
      
      <!-- Milliy sertifikat bo'limi -->
      <section id="certificate-tests">
        <h3>Milliy Sertifikat</h3>
        
        <div class="filter-section">
          <div class="filter-row">
            <div class="filter-group">
              <label class="filter-label" for="certificate-type">Test turi</label>
              <select id="certificate-type" class="filter-select">
                <option value="35">35 talik test</option>
                <option value="45">45 talik test</option>
              </select>
            </div>
          </div>
        </div>
        
        <div class="tests-grid" id="certificate-tests-grid">
          <!-- Test kartalari JavaScript orqali to'ldiriladi -->
        </div>
      </section>
      
      <div class="section-divider"></div>
      
      <!-- DTM bo'limi -->
      <section id="dtm-tests">
        <h3>DTM</h3>
        
        <div class="tests-grid" id="dtm-tests-grid">
          <!-- Test kartalari JavaScript orqali to'ldiriladi -->
        </div>
      </section>
    </div>
  </main>

  <!-- JavaScript -->
  <script>
    // Firebase konfiguratsiyasi
    const firebaseConfig = {
      apiKey: "AIzaSyDYwHJou_9GqHZcf8XxtTByC51Z8un8rrM",
      authDomain: "xplusy-760fa.firebaseapp.com",
      projectId: "xplusy-760fa",
      storageBucket: "xplusy-760fa.firebasestorage.app",
      messagingSenderId: "992512966017",
      appId: "1:992512966017:web:5e919dbc9b8d8abcb43c80",
      measurementId: "G-459PLJ7P7L"
    };
    
    // Firebase ni ishga tushirish
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Test ma'lumotlari (namuna)
    const testData = {
      chsb: [
        { id: 1, title: "5-sinf 1-chorak", class: 5, quarter: 1, questions: 20, time: 30, difficulty: "Oʻrta", attempts: 1245 },
        { id: 2, title: "5-sinf 2-chorak", class: 5, quarter: 2, questions: 25, time: 40, difficulty: "Oʻrta", attempts: 987 },
        { id: 3, title: "6-sinf 1-chorak", class: 6, quarter: 1, questions: 20, time: 30, difficulty: "Oʻrta", attempts: 876 },
        { id: 4, title: "6-sinf 2-chorak", class: 6, quarter: 2, questions: 25, time: 40, difficulty: "Oʻrta", attempts: 754 },
        { id: 5, title: "7-sinf 1-chorak", class: 7, quarter: 1, questions: 20, time: 30, difficulty: "Murakkab", attempts: 653 },
        { id: 6, title: "7-sinf 2-chorak", class: 7, quarter: 2, questions: 25, time: 40, difficulty: "Murakkab", attempts: 542 },
        { id: 7, title: "8-sinf 1-chorak", class: 8, quarter: 1, questions: 20, time: 30, difficulty: "Murakkab", attempts: 431 },
        { id: 8, title: "8-sinf 2-chorak", class: 8, quarter: 2, questions: 25, time: 40, difficulty: "Murakkab", attempts: 320 },
        { id: 9, title: "9-sinf 1-chorak", class: 9, quarter: 1, questions: 20, time: 30, difficulty: "Qiyin", attempts: 219 },
        { id: 10, title: "9-sinf 2-chorak", class: 9, quarter: 2, questions: 25, time: 40, difficulty: "Qiyin", attempts: 187 },
        { id: 11, title: "10-sinf 1-chorak", class: 10, quarter: 1, questions: 20, time: 30, difficulty: "Qiyin", attempts: 165 },
        { id: 12, title: "10-sinf 2-chorak", class: 10, quarter: 2, questions: 25, time: 40, difficulty: "Qiyin", attempts: 143 },
        { id: 13, title: "11-sinf 1-chorak", class: 11, quarter: 1, questions: 20, time: 30, difficulty: "Juda qiyin", attempts: 121 },
        { id: 14, title: "11-sinf 2-chorak", class: 11, quarter: 2, questions: 25, time: 40, difficulty: "Juda qiyin", attempts: 109 }
      ],
      bsb: [
        { id: 101, title: "1-sinf BSB", class: 1, level: 1, questions: 15, time: 20, difficulty: "Oson", attempts: 876 },
        { id: 102, title: "2-sinf BSB", class: 2, level: 1, questions: 15, time: 20, difficulty: "Oson", attempts: 765 },
        { id: 103, title: "3-sinf BSB", class: 3, level: 1, questions: 15, time: 20, difficulty: "Oʻrta", attempts: 654 },
        { id: 104, title: "4-sinf BSB", class: 4, level: 1, questions: 15, time: 20, difficulty: "Oʻrta", attempts: 543 },
        { id: 105, title: "5-sinf BSB", class: 5, level: 1, questions: 15, time: 20, difficulty: "Oʻrta", attempts: 432 },
        { id: 106, title: "6-sinf BSB", class: 6, level: 2, questions: 20, time: 30, difficulty: "Murakkab", attempts: 321 },
        { id: 107, title: "7-sinf BSB", class: 7, level: 2, questions: 20, time: 30, difficulty: "Murakkab", attempts: 210 },
        { id: 108, title: "8-sinf BSB", class: 8, level: 3, questions: 25, time: 40, difficulty: "Qiyin", attempts: 198 },
        { id: 109, title: "9-sinf BSB", class: 9, level: 3, questions: 25, time: 40, difficulty: "Qiyin", attempts: 176 },
        { id: 110, title: "10-sinf BSB", class: 10, level: 4, questions: 30, time: 45, difficulty: "Juda qiyin", attempts: 154 }
      ],
      certificate: [
        { id: 201, title: "Matematika 35 talik", type: 35, questions: 35, time: 60, difficulty: "Oʻrta", attempts: 2456 },
        { id: 202, title: "Matematika 45 talik", type: 45, questions: 45, time: 90, difficulty: "Murakkab", attempts: 1876 }
      ],
      dtm: [
        { id: 301, title: "DTM Matematika 2023", questions: 30, time: 60, difficulty: "Qiyin", attempts: 3456 },
        { id: 302, title: "DTM Matematika 2022", questions: 30, time: 60, difficulty: "Qiyin", attempts: 2876 },
        { id: 303, title: "DTM Matematika 2021", questions: 30, time: 60, difficulty: "Qiyin", attempts: 2345 }
      ]
    };

    // Test kartasini yaratish funksiyasi
    function createTestCard(test, type) {
      const card = document.createElement('div');
      card.className = 'test-card';
      
      let detailsHtml = '';
      if (type === 'chsb') {
        detailsHtml = `
          <div class="test-card-detail"><i class="fas fa-graduation-cap"></i> ${test.class}-sinf</div>
          <div class="test-card-detail"><i class="fas fa-calendar-alt"></i> ${test.quarter}-chorak</div>
        `;
      } else if (type === 'bsb') {
        detailsHtml = `
          <div class="test-card-detail"><i class="fas fa-graduation-cap"></i> ${test.class}-sinf</div>
          <div class="test-card-detail"><i class="fas fa-signal"></i> ${test.level}-daraja</div>
        `;
      } else if (type === 'certificate') {
        detailsHtml = `
          <div class="test-card-detail"><i class="fas fa-file-alt"></i> ${test.questions} ta savol</div>
        `;
      } else if (type === 'dtm') {
        detailsHtml = `
          <div class="test-card-detail"><i class="fas fa-file-alt"></i> ${test.questions} ta savol</div>
        `;
      }
      
      card.innerHTML = `
        <div class="test-card-header">
          <h3 class="test-card-title">${test.title}</h3>
          <span class="test-card-badge">${test.difficulty}</span>
        </div>
        <div class="test-card-details">
          ${detailsHtml}
          <div class="test-card-detail"><i class="fas fa-question-circle"></i> ${test.questions} ta savol</div>
          <div class="test-card-detail"><i class="fas fa-clock"></i> ${test.time} daqiqa</div>
          <div class="test-card-detail"><i class="fas fa-users"></i> ${test.attempts} ishtirok</div>
        </div>
        <div class="test-card-actions">
          <a href="#" class="test-card-btn primary require-login">Boshlash</a>
          <a href="#" class="test-card-btn secondary">Tafsilot</a>
        </div>
      `;
      
      return card;
    }

    // Testlarni filtrlash va ko'rsatish
    function filterTests() {
      // CHSB filtri
      const chsbClass = parseInt(document.getElementById('chsb-class').value);
      const chsbQuarter = parseInt(document.getElementById('chsb-quarter').value);
      
      const filteredChsb = testData.chsb.filter(test => 
        test.class === chsbClass && test.quarter === chsbQuarter
      );
      
      const chsbGrid = document.getElementById('chsb-tests-grid');
      chsbGrid.innerHTML = '';
      
      filteredChsb.forEach(test => {
        chsbGrid.appendChild(createTestCard(test, 'chsb'));
      });
      
      // BSB filtri
      const bsbClass = parseInt(document.getElementById('bsb-class').value);
      const bsbLevel = parseInt(document.getElementById('bsb-level').value);
      
      const filteredBsb = testData.bsb.filter(test => 
        test.class === bsbClass && test.level === bsbLevel
      );
      
      const bsbGrid = document.getElementById('bsb-tests-grid');
      bsbGrid.innerHTML = '';
      
      filteredBsb.forEach(test => {
        bsbGrid.appendChild(createTestCard(test, 'bsb'));
      });
      
      // Certificate filtri
      const certType = parseInt(document.getElementById('certificate-type').value);
      
      const filteredCert = testData.certificate.filter(test => 
        test.type === certType
      );
      
      const certGrid = document.getElementById('certificate-tests-grid');
      certGrid.innerHTML = '';
      
      filteredCert.forEach(test => {
        certGrid.appendChild(createTestCard(test, 'certificate'));
      });
      
      // DTM (filtersiz)
      const dtmGrid = document.getElementById('dtm-tests-grid');
      dtmGrid.innerHTML = '';
      
      testData.dtm.forEach(test => {
        dtmGrid.appendChild(createTestCard(test, 'dtm'));
      });
    }

    // DOM yuklanganda
    document.addEventListener('DOMContentLoaded', function() {
      // Boshlang'ich filter qiymatlarini o'rnatish
      document.getElementById('chsb-class').value = "5";
      document.getElementById('chsb-quarter').value = "1";
      
      // Testlarni filtrlash
      filterTests();
      
      // Filter o'zgarishlarini kuzatish
      document.getElementById('chsb-class').addEventListener('change', filterTests);
      document.getElementById('chsb-quarter').addEventListener('change', filterTests);
      document.getElementById('bsb-class').addEventListener('change', filterTests);
      document.getElementById('bsb-level').addEventListener('change', filterTests);
      document.getElementById('certificate-type').addEventListener('change', filterTests);
      
      // Bosh sahifaga qaytish
      document.getElementById('backToHome').addEventListener('click', function(e) {
        e.preventDefault();
        // Agar parent window da contentManager mavjud bo'lsa
        if (window.parent && window.parent.contentManager) {
          window.parent.contentManager.loadPage('home');
        } else {
          // Agar mustaqil sahifa bo'lsa
          window.location.href = 'index.html';
        }
      });
      
      // Kirish talab qilinadigan elementlar
      document.querySelectorAll('.require-login').forEach(element => {
        element.addEventListener('click', (e) => {
          // Agar parent window da auth mavjud bo'lsa
          if (window.parent && window.parent.auth) {
            if (!window.parent.auth.currentUser) {
              e.preventDefault();
              if (window.parent.authModal) {
                window.parent.authModal.style.display = 'flex';
              }
              alert('Iltimos, avval tizimga kiring');
            }
          } else {
            // Agar mustaqil sahifa bo'lsa
            alert('Iltimos, avval tizimga kiring');
          }
        });
      });
    });
  </script>
</body>
</html>