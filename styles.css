/* ===========================================================
   LeaderMath — AURORA NEOGLASS (brand-new mobile-first theme)
   =========================================================== */

/* 0) Base & prefs */
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{margin:0}
:root{color-scheme:light dark}

/* 1) Design tokens — Light */
:root{
  --brand:#2EE6A6;         /* fresh mint */
  --brand-2:#1F6B45;       /* deep evergreen */
  --accent:#59B6FF;        /* aurora blue */
  --pink:#FF77B7;          /* aurora pink */

  --bg:#0C1411;            /* deep for aurora canvas */
  --paper:#0f1814;         /* app surface (dark by default; we invert in light) */
  --card:#0f1915;
  --text:#E8F7F0;
  --muted:#A7CABB;

  --frame:rgba(255,255,255,.08);
  --frame-strong:rgba(255,255,255,.16);
  --glass:rgba(255,255,255,.06);

  --ring:#4BE4AF;
  --radius:18px;

  --sh-soft:0 10px 24px rgba(0,0,0,.35);
  --sh-strong:0 24px 50px rgba(0,0,0,.55);

  --blur:14px;

  /* star tiers (dark-first) */
  --t-bronze-1:#B8845A; --t-bronze-2:#7C4F2E;
  --t-silver-1:#D5E0EF; --t-silver-2:#8A95A6;
  --t-gold-1:#FFD86A;   --t-gold-2:#E08A00;
  --t-emerald-1:#7FE8BB;--t-emerald-2:#2E8B57;
  --t-diamond-1:#A7E5FF;--t-diamond-2:#2FAEF9;

  /* selection & motion */
  --sel:color-mix(in srgb, var(--brand) 35%, transparent);
  --tr:.22s cubic-bezier(.2,.8,.2,1);

  /* layout */
  --maxw:1000px;
}

/* 2) Light scheme override (mobile users ko‘p hollarda light?) */
@media (prefers-color-scheme: light){
  :root{
    --bg:#F6FBF8;
    --paper:#FFFFFF;
    --card:#FFFFFF;
    --text:#0D1B14;
    --muted:#3D5E51;
    --frame:rgba(18,30,26,.08);
    --frame-strong:rgba(18,30,26,.14);
    --glass:rgba(255,255,255,.72);
    --sh-soft:0 10px 24px rgba(0,0,0,.08);
    --sh-strong:0 28px 60px rgba(0,0,0,.15);
  }
}

/* 3) Manual theme toggle (HTML class="dark" ni JS boshqaradi) */
:root.dark{
  --bg:#09110E;
  --paper:#0E1613;
  --card:#0F1A15;
  --text:#E8F7F0;
  --muted:#A3C8B9;
  --frame:rgba(255,255,255,.08);
  --frame-strong:rgba(255,255,255,.18);
  --glass:rgba(20,32,26,.62);
  --sh-soft:0 12px 28px rgba(0,0,0,.45);
  --sh-strong:0 30px 70px rgba(0,0,0,.65);
}

/* 4) Global canvas — aurora gradient field */
html,body{
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:
    radial-gradient(900px 500px at 70% -10%, color-mix(in srgb, var(--accent) 20%, transparent), transparent 60%),
    radial-gradient(900px 520px at -10% 90%, color-mix(in srgb, var(--brand) 22%, transparent), transparent 60%),
    radial-gradient(900px 520px at 110% 120%, color-mix(in srgb, var(--pink) 16%, transparent), transparent 60%),
    var(--bg);
  color:var(--text);
  min-height:100dvh;
}

/* Motion-safe transitions */
@media (prefers-reduced-motion:no-preference){
  *{transition:background-color var(--tr), color var(--tr), border-color var(--tr), box-shadow var(--tr), transform var(--tr), opacity var(--tr)}
}

/* iOS safe area respect */
:root{ --inset-b:env(safe-area-inset-bottom, 0px); --inset-t:env(safe-area-inset-top, 0px) }

/* Selection */
::selection{background:var(--sel)}

/* Focus */
:focus-visible{outline:3px solid color-mix(in srgb, var(--ring) 70%, transparent);outline-offset:2px;border-radius:12px}

/* Subtle scrollbars (webkit) */
*::-webkit-scrollbar{width:10px;height:10px}
*::-webkit-scrollbar-thumb{background:color-mix(in srgb, var(--brand) 55%, #0000);border-radius:999px;border:2px solid transparent;background-clip:content-box}
*::-webkit-scrollbar-thumb:hover{background:color-mix(in srgb, var(--brand) 75%, #0000)}

/* ===================== APPBAR ===================== */
.appbar{
  position:sticky;top:0;z-index:50;
  display:flex;gap:12px;align-items:center;
  padding:10px 14px calc(10px + var(--inset-t));
  background:linear-gradient(180deg, color-mix(in srgb, var(--paper) 75%, transparent), color-mix(in srgb, var(--paper) 40%, transparent));
  backdrop-filter:blur(var(--blur));
  -webkit-backdrop-filter:blur(var(--blur));
  border-bottom:1px solid var(--frame);
  box-shadow:0 10px 30px rgba(0,0,0,.08);
}
.logo{height:44px;width:44px;border-radius:12px;overflow:hidden;border:1px solid var(--frame-strong);display:grid;place-items:center;background:linear-gradient(135deg, color-mix(in srgb, var(--brand) 20%, transparent), color-mix(in srgb, var(--accent) 15%, transparent))}
.logo img{width:100%;height:100%;object-fit:contain}
.title{font-weight:900;letter-spacing:.2px}
.sub{font-size:12px;opacity:.75}
.spacer{flex:1}
.iconbtn{
  padding:9px 12px;border-radius:12px;border:1px solid var(--frame);
  background:color-mix(in srgb, var(--paper) 60%, transparent);color:var(--text);
  box-shadow:0 6px 16px rgba(0,0,0,.08)
}
.iconbtn:hover{transform:translateY(-1px);box-shadow:0 10px 28px rgba(0,0,0,.12)}

/* ===================== USERBAR ===================== */
.userbar{
  margin:14px auto 10px; width:min(100%, var(--maxw));
  background:var(--glass); border:1px solid var(--frame);
  border-radius:22px; padding:14px;
  backdrop-filter:blur(var(--blur)); -webkit-backdrop-filter:blur(var(--blur));
  box-shadow:var(--sh-soft);
  display:grid;grid-template-columns:56px 1fr auto;gap:12px;
}
@media (max-width:560px){
  .userbar{grid-template-columns:56px 1fr;grid-auto-rows:auto}
}
.ava{
  width:56px;height:56px;border-radius:50%;
  display:grid;place-items:center;overflow:hidden;
  color:#fff;font-weight:1000;letter-spacing:.5px;
  background:conic-gradient(from 120deg, var(--brand), var(--accent), var(--pink), var(--brand));
  box-shadow:0 10px 24px rgba(0,0,0,.35), inset 0 0 0 2px rgba(255,255,255,.22)
}
.ava img{width:100%;height:100%;object-fit:cover}

.uinfo b{display:block;font-size:16px;line-height:1.15}
.uinfo .meta{font-size:12px;color:var(--muted)}
.uvals{text-align:right;align-self:center}
.chip{
  display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;
  background:color-mix(in srgb, var(--paper) 60%, transparent);
  border:1px solid var(--frame);font-size:12px;
  box-shadow:inset 0 0 0 1px color-mix(in srgb, var(--accent) 12%, transparent)
}
.link{color:inherit;text-decoration:underline dotted;text-underline-offset:3px}
.ustars{display:inline-flex;gap:4px;margin-left:8px;vertical-align:middle}
.btn-primary{
  display:inline-flex;align-items:center;gap:8px;
  padding:10px 14px;border-radius:14px;font-weight:900;
  background:linear-gradient(135deg, var(--brand) 10%, var(--accent));
  color:#07110E;border:1px solid #0000;
  box-shadow:0 10px 24px color-mix(in srgb, var(--accent) 35%, transparent);
}
.btn-primary:hover{transform:translateY(-1px) scale(1.01)}
.btn-primary:active{transform:translateY(0)}

.mstats{display:none;margin-top:6px;gap:6px;flex-wrap:wrap}
.mchip{
  display:inline-flex;align-items:center;gap:6px;max-width:100%;
  padding:7px 10px;border-radius:999px;background:color-mix(in srgb, var(--paper) 50%, transparent);
  border:1px solid var(--frame);font-size:12px;line-height:1;white-space:nowrap
}
.mchip .txt{display:inline-block;max-width:180px;text-overflow:ellipsis;overflow:hidden}
@media (max-width:560px){
  .uinfo .meta{display:none}
  .mstats{display:flex}
  .mchip .txt{max-width:120px}
}

/* ===================== BANNERS ===================== */
.banner{
  margin:12px auto; width:min(100%, var(--maxw));
  border-radius:24px; overflow:hidden; border:1px solid var(--frame);
  background:
    linear-gradient(135deg, color-mix(in srgb, var(--brand) 16%, transparent), color-mix(in srgb, var(--accent) 16%, transparent)),
    color-mix(in srgb, var(--paper) 65%, transparent);
  backdrop-filter:blur(var(--blur)); -webkit-backdrop-filter:blur(var(--blur));
  box-shadow:var(--sh-soft);
  position:relative;
}
.banner::after{
  content:"";position:absolute;inset:0;
  background:
    radial-gradient(650px 220px at 15% -10%, color-mix(in srgb, var(--brand) 22%, transparent), transparent 60%),
    radial-gradient(650px 220px at 85% 110%, color-mix(in srgb, var(--accent) 22%, transparent), transparent 60%);
  pointer-events:none;mix-blend-mode:screen;opacity:.6
}

/* ===================== FILTERS ===================== */
.filters{
  margin:12px auto; width:min(100%, var(--maxw));
  padding:12px;border-radius:18px;border:1px solid var(--frame);
  background:color-mix(in srgb, var(--paper) 72%, transparent);
  backdrop-filter:blur(var(--blur)); -webkit-backdrop-filter:blur(var(--blur));
  box-shadow:var(--sh-soft)
}
.filters h4{margin:0 0 8px;font-size:13px;opacity:.85}
.chips{display:flex;flex-wrap:wrap;gap:8px}
.chip.filter{
  cursor:pointer;background:color-mix(in srgb, var(--paper) 60%, transparent)
}
.chip.filter[aria-pressed="true"]{
  color:#07110E;
  background:linear-gradient(135deg, var(--brand), var(--accent));
  border-color:#0000;
  box-shadow:0 10px 24px color-mix(in srgb, var(--brand) 30%, transparent)
}
.chip.sm{font-size:11px;padding:6px 9px}

/* ===================== LEADERBOARD ===================== */
.board{
  margin:12px auto; width:min(100%, var(--maxw));
  background:color-mix(in srgb, var(--paper) 70%, transparent);
  border:1px solid var(--frame); border-radius:20px; padding:12px;
  box-shadow:var(--sh-soft); backdrop-filter:blur(var(--blur));
}
.board h3{margin:0 0 8px;font-size:15px;opacity:.92}
.group{border:none;border-radius:16px;overflow:hidden;margin:12px 0;box-shadow:var(--sh-soft)}
.groupBody{padding:10px}
.groupHead{
  display:flex;align-items:center;justify-content:space-between;gap:10px;
  padding:14px 16px;border-radius:16px;border:1px solid var(--frame);
  color:var(--text);
  background:linear-gradient(135deg, color-mix(in srgb, var(--paper) 70%, transparent), color-mix(in srgb, var(--paper) 40%, transparent));
  backdrop-filter:blur(calc(var(--blur) * .6)); -webkit-backdrop-filter:blur(calc(var(--blur) * .6));
}
.groupHead.tier-bronze{background:linear-gradient(135deg, var(--t-bronze-1), color-mix(in srgb, var(--t-bronze-2) 50%, transparent)); color:#24180f}
.groupHead.tier-silver{background:linear-gradient(135deg, var(--t-silver-1), color-mix(in srgb, var(--t-silver-2) 50%, transparent)); color:#0e1420}
.groupHead.tier-gold  {background:linear-gradient(135deg, var(--t-gold-1),   color-mix(in srgb, var(--t-gold-2) 52%, transparent)); color:#201400}
.groupHead.tier-emerald{background:linear-gradient(135deg, var(--t-emerald-1),color-mix(in srgb, var(--t-emerald-2) 55%, transparent)); color:#06130c}
.groupHead.tier-diamond{background:linear-gradient(135deg, var(--t-diamond-1),color-mix(in srgb, var(--t-diamond-2) 55%, transparent)); color:#06111a}
.tier-badge{
  font-weight:900;padding:6px 10px;border-radius:999px;
  background:color-mix(in srgb, #fff 65%, transparent); border:1px solid var(--frame);
}
.legend{display:flex;align-items:center;gap:8px;font-size:12px;opacity:.92}

.rank{
  display:grid;grid-template-columns:54px 1fr auto;gap:12px;align-items:center;
  padding:12px;border-radius:14px;border:1px solid var(--frame);
  background:color-mix(in srgb, var(--paper) 68%, transparent);
  box-shadow:0 2px 8px rgba(0,0,0,.06)
}
.rank + .rank{margin-top:8px}
.rank:hover{transform:translateY(-2px) scale(1.01);box-shadow:0 16px 36px rgba(0,0,0,.16)}
.rnk{font-weight:900;background:color-mix(in srgb, var(--paper) 65%, transparent);border:1px solid var(--frame);padding:7px 11px;border-radius:10px}
.medal{font-size:22px;line-height:1}
.m1,.m2,.m3{display:inline-block;width:40px;text-align:center;filter:drop-shadow(0 4px 8px rgba(0,0,0,.15))}

/* Stars scale per tier */
.stars{display:inline-flex;gap:4px;vertical-align:middle}
.tier-bronze .stars{--s:16}
.tier-silver .stars{--s:17}
.tier-gold .stars{--s:18}
.tier-emerald .stars{--s:20}
.tier-diamond .stars{--s:24}
.stars svg{width:calc(var(--s)*1px);height:calc(var(--s)*1px)}

/* Pager */
.pager{display:flex;align-items:center;justify-content:space-between;gap:10px;margin:10px 0}
.pager .pbtn{
  background:color-mix(in srgb, var(--paper) 65%, transparent);border:1px solid var(--frame);
  border-radius:12px;padding:9px 12px;font-weight:900;cursor:pointer
}
.pager .pbtn:hover{transform:translateY(-1px)}

/* ===================== CARDS (sections) ===================== */
.container{padding:6px 10px calc(80px + var(--inset-b));display:flex;justify-content:center}
#sections{width:100%;max-width:var(--maxw)}
.grid{display:grid;grid-template-columns:1fr;gap:12px}
@media (min-width:560px){.grid{grid-template-columns:repeat(2,1fr)}}
@media (min-width:1000px){.grid{grid-template-columns:repeat(3,1fr)}}

.card{
  position:relative;overflow:hidden;border-radius:22px;
  background:linear-gradient(180deg, color-mix(in srgb, var(--paper) 70%, transparent), color-mix(in srgb, var(--paper) 40%, transparent));
  border:1px solid var(--frame);box-shadow:var(--sh-soft)
}
.card:hover{transform:translateY(-3px);box-shadow:var(--sh-strong)}
.thumb{
  aspect-ratio:16/9;display:grid;place-items:center;
  background:radial-gradient(600px 240px at 110% -10%, color-mix(in srgb, var(--accent) 22%, transparent), transparent 60%),
             radial-gradient(600px 240px at -10% 110%, color-mix(in srgb, var(--brand) 22%, transparent), transparent 60%),
             color-mix(in srgb, var(--paper) 65%, transparent);
}
.badge{
  position:absolute;top:12px;left:12px;z-index:2;
  border-radius:999px;padding:7px 12px;font-weight:900;color:#06110e;
  background:linear-gradient(135deg, var(--brand), var(--accent));
  box-shadow:0 12px 24px color-mix(in srgb, var(--brand) 30%, transparent)
}
.body{padding:12px 12px 14px}
.name{font-size:16px;font-weight:900;margin:0 0 6px}
.desc{font-size:13px;color:var(--muted);margin:0 0 10px}
.actions{display:flex;gap:8px}
.btn{
  flex:1;display:inline-flex;align-items:center;justify-content:center;gap:8px;
  border:none;border-radius:14px;padding:11px 14px;font-weight:900;cursor:pointer;
  color:#06110e;background:linear-gradient(135deg, var(--brand), var(--accent))
}
.btn:hover{transform:translateY(-1px)}
.btn[disabled]{opacity:.55;cursor:not-allowed}
.btn.ghost{
  background:color-mix(in srgb, var(--paper) 65%, transparent);color:var(--text);
  border:1px solid var(--frame)
}
.meta{font-size:12px;color:var(--muted);margin-top:8px;display:flex;gap:10px;align-items:center}
.countdown{font-weight:900;letter-spacing:.3px}

/* ===================== DIAMOND SHINE (subtle) ===================== */
.tier-diamond .stars{position:relative;overflow:visible}
.tier-diamond .stars::after{
  content:"";position:absolute;top:-25%;bottom:-25%;left:-30%;width:40%;
  transform:skewX(-20deg);
  background:linear-gradient(90deg, transparent, rgba(255,255,255,.9), transparent);
  filter:blur(.6px);opacity:.65;pointer-events:none;
  animation:shine 2.8s ease-in-out infinite;
}
@keyframes shine{0%{left:-30%;opacity:0}8%{opacity:.9}60%{left:110%;opacity:0}100%{left:110%;opacity:0}}

/* ===================== MODAL (mobile sheet) ===================== */
.modal-mask{
  position:fixed;inset:0;display:none;align-items:flex-end;justify-content:center;
  background:rgba(0,0,0,.45);z-index:100;
}
.modal{
  width:min(960px,98%);max-height:85dvh;overflow:auto;border-radius:24px 24px 16px 16px;
  border:1px solid var(--frame-strong);
  background:linear-gradient(180deg, color-mix(in srgb, var(--paper) 85%, transparent), color-mix(in srgb, var(--paper) 60%, transparent));
  backdrop-filter:blur(var(--blur)); -webkit-backdrop-filter:blur(var(--blur));
  padding:18px 14px 16px;box-shadow:var(--sh-strong);
  transform:translateY(6px)
}
.modal::before{
  content:"";display:block;width:44px;height:5px;border-radius:999px;margin:0 auto 12px;
  background:color-mix(in srgb, var(--text) 18%, transparent)
}
.ctl label{font-size:12px;color:var(--muted);display:block;margin:0 0 6px}
.ctl input,.ctl textarea,.ctl select{
  width:100%;padding:12px;border:1px solid var(--frame);border-radius:14px;
  background:color-mix(in srgb, var(--paper) 88%, transparent);color:var(--text);
  outline:none
}
.ctl input:focus{border-color:var(--ring);box-shadow:0 0 0 4px color-mix(in srgb, var(--ring) 22%, transparent)}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.grid3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
@media (max-width:560px){.grid2,.grid3{grid-template-columns:1fr}}
.row{display:flex;gap:8px;justify-content:flex-end;margin-top:14px}
.danger{color:#ff6b6b;font-size:12px;margin-right:auto}
.btn-ghost{
  background:color-mix(in srgb, var(--paper) 75%, transparent);
  border:1px solid var(--frame);border-radius:12px;padding:10px 12px;cursor:pointer;color:var(--text)
}
.btn-solid{
  background:linear-gradient(135deg, var(--brand), var(--accent));color:#06110e;
  border:none;border-radius:12px;padding:11px 14px;font-weight:900;cursor:pointer
}

/* ===================== UTILITIES ===================== */
.container{display:flex;justify-content:center}
#sections{width:100%;max-width:var(--maxw)}

.hidden{display:none}

/* Make gradients/borders pop on OLED (slight gamma lift) */
@supports (background: color(display-p3 1 1 1)){
  .appbar,.userbar,.banner,.board,.filters,.card,.modal{
    border-color:color-mix(in display-p3, var(--frame) 80%, transparent);
  }
}
/* ===== USER PANEL — compact + popover (mobile-first) ===== */

/* 2.1) Kompakt userbar: faqat ball + yulduzlar ko‘rinadi */
.userbar{
  position: relative;
  display: grid;
  grid-template-columns: 56px 1fr auto;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  border-radius: 18px;
  border: 1px solid var(--frame);
  background: color-mix(in srgb, var(--paper) 72%, transparent);
  backdrop-filter: blur(var(--blur));
  -webkit-backdrop-filter: blur(var(--blur));
  box-shadow: var(--sh-soft);
}

/* avatar – “trigger” */
.ava{
  cursor: pointer;
  box-shadow: 0 10px 24px rgba(0,0,0,.18), inset 0 0 0 2px rgba(255,255,255,.22);
  transition: transform .18s ease, box-shadow .18s ease;
}
.ava:active{ transform: scale(.98) }
.ava::after{
  content:""; position:absolute; inset:0; border-radius:50%;
}

/* chapdagi ism yo‘q – faqat yulduzlar uchun kichik joy */
.uinfo{ display:flex; align-items:center; gap:8px; min-width:0 }
.uinfo b{ display:none }           /* ism doimiy ko‘rinmaydi */
.uinfo .meta{ display:none }       /* meta ham ko‘rinmaydi */

/* o‘ng tomonda: ball + yulduzlar chipi doim ko‘rinadi */
.uvals{ display:flex; align-items:center; gap:8px; }
.uvals .chip{ margin:0; background: color-mix(in srgb, var(--paper) 60%, transparent); }
#userStarsPts{ margin-left:6px }

/* sign-in/edit/sign-out linklari doim yashirin (menyu ochilganda JS tugma orqali ishlatamiz) */
#signin, #editProfile, #signout{ display:none !important }

/* 2.2) POPUP (avatar bosilganda) */
.user-menu{
  position: absolute;
  top: 64px; left: 10px; right: 10px;   /* mobil: butun panel kengligida */
  z-index: 60;
  display: none;
  padding: 12px;
  border: 1px solid var(--frame);
  border-radius: 16px;
  background: color-mix(in srgb, var(--paper) 80%, transparent);
  backdrop-filter: blur(calc(var(--blur) * .9));
  -webkit-backdrop-filter: blur(calc(var(--blur) * .9));
  box-shadow: var(--sh-strong);
}
.userbar.menu-open .user-menu{ display:block; }

/* PC: popover biroz torroq va o‘ngga ildam */
@media (min-width: 900px){
  .user-menu{ width: 380px; left: auto; right: 12px; }
}

/* menyu ichidagi bloklar */
.um-head{
  display:flex; align-items:center; gap:10px; margin-bottom:8px;
}
.um-ava{
  width:42px; height:42px; border-radius:50%;
  background: linear-gradient(135deg,#2E8B57,#1F6B45); display:grid; place-items:center; color:#fff; font-weight:900; overflow:hidden;
  border:1px solid var(--frame);
}
.um-name{ font-weight:900; }
.um-sub{ font-size:12px; color:var(--muted); }

.um-grid{
  display:grid; grid-template-columns:1fr 1fr; gap:8px; margin:10px 0 12px;
}
.um-item{
  padding:10px; border:1px solid var(--frame); border-radius:12px;
  background: color-mix(in srgb, var(--paper) 65%, transparent);
  font-size:12px;
}
.um-item b{ display:block; font-size:11px; color:var(--muted); margin-bottom:4px }

.um-actions{
  display:flex; gap:8px;
}
.um-btn{
  flex:1; display:inline-flex; align-items:center; justify-content:center; gap:8px;
  border:none; border-radius:12px; padding:11px 12px; cursor:pointer; font-weight:900;
  background: linear-gradient(135deg,#2E8B57,#1F6B45); color:#fff;
}
.um-btn.ghost{
  background: color-mix(in srgb, var(--paper) 65%, transparent); color: var(--text);
  border:1px solid var(--frame);
}

/* Outside-click fon (mobil uchun) */
.userbar.menu-open::after{
  content:""; position:fixed; inset:0; z-index:50; /* user-menu’dan pastda */
  background: transparent;
}

/* kichik micro-animlar */
@media (prefers-reduced-motion:no-preference){
  .userbar.menu-open .user-menu{ animation: umFade .18s ease both }
  @keyframes umFade{ from{ opacity:0; transform: translateY(-4px) } to{ opacity:1; transform: translateY(0) } }
}
