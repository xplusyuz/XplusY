<!doctype html>
<html lang="uz">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>XplusY • MathCenter</title>
  <!-- Minimal, konflikt keltirmaydigan uslub -->
  <style>
    :root{
      --pri:#10b981; --pri-ink:#065f46; --ink:#0f172a; --muted:#667085; --bg:#ffffff; --edge:#e8f3ef;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font:14px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial}
    a{color:inherit;text-decoration:none}
    .container{max-width:1200px;margin:0 auto;padding:12px 16px}
    /* Header */
    header{position:sticky;top:0;z-index:50;background:#fff;border-bottom:1px solid var(--edge);backdrop-filter:blur(8px)}
    .hdr{display:flex;align-items:center;gap:14px;min-height:58px}
    .logo{display:flex;align-items:center;gap:10px;font-weight:900}
    .pi{width:36px;height:36px;display:grid;place-items:center;border-radius:10px;
        background:radial-gradient(circle at 30% 30%,#c7f9e7,#8ff0c2 45%,#43d59a 80%,#2fb180);
        color:#064e3b;font-size:20px;box-shadow:inset 0 0 0 3px #d7f8ee}
    nav{margin-left:auto;display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    nav a{padding:8px 12px;border-radius:10px;border:1px solid transparent}
    nav a.active{color:var(--pri);border-color:#c9efdf;transform:scale(1.03)}
    /* Touch floating menu (mobil) */
    .tabs{position:fixed;left:50%;transform:translateX(-50%);
          bottom:14px;z-index:60;display:flex;gap:10px;padding:8px;border:1px solid var(--edge);
          background:#fff;border-radius:999px;box-shadow:0 10px 24px rgba(16,185,129,.12)}
    .tabs a{padding:8px 12px;border-radius:999px}
    .tabs a.active{background:#ecfdf5;color:var(--pri-ink);border:1px solid #c9efdf}
    @media (min-width:920px){ .tabs{display:none} }
    /* Kontent */
    main{min-height:60vh}
    #app-view{min-height:50vh}
    footer{border-top:1px solid var(--edge);margin-top:24px}
    .muted{color:var(--muted)}
  </style>
</head>
<body>

  <!-- HEADER -->
  <header>
    <div class="container hdr">
      <div class="logo">
        <div class="pi">π</div>
        <div>XplusY <span class="muted" style="font-weight:600">MathCenter</span></div>
      </div>
      <!-- Desktop nav (hash router) -->
      <nav aria-label="Asosiy menyu">
        <a href="#home" data-route="home">Home</a>
        <a href="#courses" data-route="courses">Courses</a>
        <a href="#tests" data-route="tests">Tests</a>
        <a href="#simulators" data-route="simulators">Simulators</a>
      </nav>
    </div>
  </header>

  <!-- MAIN CONTENT -->
  <main class="container">
    <!-- Router shu yerga sahifani yuklaydi -->
    <div id="app-view"></div>
  </main>

  <!-- FLOATING TABS (Mobile) -->
  <div class="tabs" aria-label="Tez menyu">
    <a href="#home" data-route="home">Home</a>
    <a href="#courses" data-route="courses">Courses</a>
    <a href="#tests" data-route="tests">Tests</a>
    <a href="#simulators" data-route="simulators">Sim</a>
  </div>

  <!-- FOOTER -->
  <footer>
    <div class="container muted">© 2025 XplusY • MathCenter</div>
  </footer>

  <!-- ===== Shadow DOM Hash Router: to‘liq sahifalarni (home/courses/tests/simulators) o‘z holicha yuklaydi ===== -->
  <script>
  (function(){
    const ROUTES = {
      home: 'home.html',
      courses: 'courses.html',
      tests: 'tests.html',
      simulators: 'simulators.html'
    };

    const host = document.getElementById('app-view');
    let shadow = host.attachShadow ? host.attachShadow({mode:'open'}) : null;

    function highlight(route){
      document.querySelectorAll('[data-route]').forEach(a=>{
        const r = a.getAttribute('data-route');
        if(r === route){ a.classList.add('active'); }
        else { a.classList.remove('active'); }
      });
    }

    function routeFromHash(){
      const h = (location.hash||'').replace('#','').trim();
      return ROUTES[h] ? h : 'home';
    }

    function injectHTMLDoc(doc){
      const target = shadow || host;
      target.innerHTML = ''; // clear

      // 1) head: style + link rel=stylesheet
      const head = doc.querySelector('head');
      if (head){
        head.querySelectorAll('style,link[rel="stylesheet"]').forEach(node=>{
          target.appendChild(node.cloneNode(true));
        });
      }

      // 2) body: barcha tarkib
      const wrap = document.createElement('div');
      // doc.body bo'lmasa (ba'zi generatorlar documentElementga yozishi mumkin)
      wrap.innerHTML = (doc.body ? doc.body.innerHTML : doc.documentElement.innerHTML) || '';
      target.appendChild(wrap);

      // 3) scriptlarni qayta ishga tushiramiz (clone qilib)
      const scripts = target.querySelectorAll('script');
      scripts.forEach(old=>{
        const s = document.createElement('script');
        [...old.attributes].forEach(a=>s.setAttribute(a.name, a.value));
        if(!old.src) s.textContent = old.textContent || '';
        old.replaceWith(s);
      });
    }

    async function load(route){
      const file = ROUTES[route] || ROUTES.home;
      try{
        const res = await fetch(file, {cache:'no-store'});
        if(!res.ok) throw new Error('HTTP '+res.status);
        const html = await res.text();
        const doc = new DOMParser().parseFromString(html, 'text/html');
        injectHTMLDoc(doc);
        highlight(route);
      }catch(err){
        const target = shadow || host;
        target.innerHTML = `<div style="padding:16px;border:1px solid #e5f3ed;border-radius:12px;background:#f8fdfb">
          <strong>Yuklab bo‘lmadi:</strong> ${file}<br><small>${err.message}</small>
        </div>`;
        highlight(null);
      }
    }

    // SPA uchun ichki #link kliklari (index ichida)
    document.addEventListener('click', (e)=>{
      const a = e.target.closest('a[href^="#"]');
      if(!a) return;
      const r = a.getAttribute('href').slice(1);
      if(ROUTES[r]){
        e.preventDefault();
        if(routeFromHash() !== r) location.hash = r; else load(r);
      }
    });

    window.addEventListener('hashchange', ()=> load(routeFromHash()));
    // start
    load(routeFromHash());
  })();
  </script>
</body>
</html>
