<!doctype html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MathCenter.uz</title>
  <style>
    body{margin:0;font-family:sans-serif;background:#f6fffb}
    header{padding:8px;}
    .header-inner{display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:space-between;}
    .brand{font-weight:800;color:#0a8f52;font-size:18px;}
    .stats{display:flex;gap:8px;flex-wrap:wrap;width:100%}
    .card{background:#fff;border:1px solid #e0f3eb;border-radius:12px;padding:10px 14px;box-shadow:0 2px 6px rgba(0,0,0,.05);display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;flex:1;min-width:0}
    .card .label{font-size:11px;opacity:.7}
    .card .value{font-size:13px;font-weight:700}

    @media(max-width:768px){
      .brand{font-size:16px}
    }

    .fab{position:fixed;bottom:16px;right:16px;z-index:50}
    .fab-btn{width:56px;height:56px;border-radius:50%;background:#0faf64;color:#fff;border:none;font-size:24px;box-shadow:0 4px 10px rgba(0,0,0,.2);transition:transform .2s ease}
    .fab-btn:hover{transform:scale(1.1)}
    .fab-menu{display:none;position:absolute;bottom:70px;right:0;flex-direction:column;gap:8px}
    .fab.open .fab-menu{display:flex}
    .chip{background:#fff;border:1px solid #e0f3eb;padding:10px 14px;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,.1);font-weight:600;cursor:pointer;transition:all .2s ease}
    .chip:hover{transform:scale(1.05)}
    .chip.active{background:#0faf64;color:#fff;border-color:#0faf64}
    /* ===== Qo'shimcha: mobil cardni to'liq va o'qilishi oson qilish ===== */
    .card{min-width:90px;padding:8px 12px}
    @media(max-width:540px){
      .stats{flex-direction:column;width:100%}
      .stats .card{width:100%;min-width:unset;padding:12px 14px;align-items:flex-start;text-align:left}
    }

    /* ===== Menyu: aktiv holat va hover animatsiya ===== */
    .chip{transition:transform .18s ease, box-shadow .18s ease, background-color .18s ease, color .18s ease}
    .chip:hover{transform:scale(1.05); box-shadow:0 4px 12px rgba(0,0,0,.12)}
    .chip.active{background:#0faf64;color:#fff;border-color:#0faf64;box-shadow:0 6px 16px rgba(15,175,100,.35)}
  </style>
</head>
<body>
  <header>
    <div class="header-inner">
      <div class="brand">MathCenter.uz</div>
      <div class="stats" id="headerStats">
        <div class="card"><div class="label">Salom</div><div class="value" id="helloName">—</div><div class="label" id="helloAge">Yosh: —</div></div>
        <div class="card"><div class="label">ID</div><div class="value" id="headerID">—</div></div>
        <div class="card"><div class="label">Balans</div><div class="value" id="headerBalans">0</div></div>
        <div class="card"><div class="label">Ball</div><div class="value" id="headerBall">0</div></div>
      </div>
    </div>
  </header>
  <main id="app"></main>
  <!-- content containers loaded via router -->

  <div class="fab" id="fab">
    <button class="fab-btn" id="fabBtn">≡</button>
    <div class="fab-menu" id="fabMenu">
      <button class="chip" data-route="home">Bosh sahifa</button>
      <button class="chip" data-route="tests">Testlar</button>
      <button class="chip" data-route="profile">Profil</button>
      <button class="chip" data-route="settings">Sozlamalar</button>
    </div>
  </div>

<script>
const fab=document.getElementById('fab');
const fabBtn=document.getElementById('fabBtn');
const fabMenu=document.getElementById('fabMenu');
fabBtn.onclick=()=>{fab.classList.toggle('open')};

// ===== Router + aktiv menyu =====
const routes=['home','tests','profile','settings'];
function setActive(route){
  document.querySelectorAll('.fab-menu .chip').forEach(b=>{
    b.classList.toggle('active', b.getAttribute('data-route')===route);
  });
}
async function loadRoute(route){
  const app=document.getElementById('app');
  try{
    const res=await fetch('partials/'+route+'.html?v='+Date.now());
    if(!res.ok) throw 0; app.innerHTML=await res.text();
  }catch(_){ app.innerHTML='<section class="content"><h2 style="margin:16px">'+route+'</h2><p style="margin:16px">Namuna sahifa.</p></section>'; }
  setActive(route);
  history.replaceState({},'', '#'+route);
}

fabMenu.addEventListener('click',(e)=>{
  const btn=e.target.closest('.chip'); if(!btn) return;
  const r=btn.getAttribute('data-route'); if(!r) return;
  loadRoute(r); fab.classList.remove('open');
});

window.addEventListener('hashchange',()=>{
  const r=location.hash.replace('#','');
  if(routes.includes(r)) loadRoute(r);
});

document.addEventListener('DOMContentLoaded',()=>{
  const start=location.hash.replace('#','')||'home';
  setActive(start); loadRoute(start);
});

function updateHeader(userDoc){(userDoc){
  document.getElementById('helloName').textContent=userDoc?.ism||'—';
  document.getElementById('helloAge').textContent='Yosh: '+(userDoc?.yosh||'—');
  document.getElementById('headerID').textContent=userDoc?.numericId||'—';
  document.getElementById('headerBalans').textContent=userDoc?.balans||0;
  document.getElementById('headerBall').textContent=userDoc?.ball||0;
}

// Active menu highlighting
const chips=[...document.querySelectorAll('.chip')];
function setActive(route){
  chips.forEach(c=>c.classList.remove('active'));
  const active=chips.find(c=>c.dataset.route===route);
  if(active) active.classList.add('active');
}

// Simulate navigation
chips.forEach(chip=>{
  chip.addEventListener('click',()=>{
    setActive(chip.dataset.route);
    document.getElementById('app').innerHTML='<div class="card">'+chip.textContent+' sahifasi</div>';
  });
});
</script>
</body>
</html>
