<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>XplusY — SPA (index + auth + side panel)</title>
  <!-- π favicon (inline SVG) -->
  <link rel="icon" type="image/svg+xml" href='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64"><defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#34d399"/><stop offset="1" stop-color="#10b981"/></linearGradient></defs><rect x="4" y="4" rx="12" ry="12" width="56" height="56" fill="url(#g)"/><text x="32" y="40" font-size="32" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" fill="#0b1210" font-weight="800">π</text></svg>' />
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <!-- Header (mobil: 1-qator — menyu • logo+nom • tema; 2-qator — ID badge) -->
  <header class="site-header">
    <button id="menuBtn" class="icon-btn burger" aria-label="Menyu" aria-controls="sidePanel" aria-expanded="false">
      <span></span><span></span><span></span>
    </button>
    <div class="brand"><span class="logo">π</span><span class="title">XplusY</span></div>
    <button id="themeToggle" class="icon-btn theme-toggle" aria-label="Kun/Tun rejimi"></button>
    <div class="auth-chip" id="authChip">
      <button id="openAuth" class="btn primary">Kirish / Ro‘yxatdan o‘tish</button>
    </div>
  </header>

  <nav class="site-nav">
    <a href="#home" class="nav-link">Bosh sahifa</a>
    <a href="#tests" class="nav-link">Testlar</a>
    <a href="#live" class="nav-link">Live</a>
    <a href="#leaderboard" class="nav-link">Reyting</a>
    <a href="#about" class="nav-link">Biz haqimizda</a>
  </nav>

  <main id="app" class="app"></main>

  <footer class="site-footer">
    <div class="f-left">© <span id="year"></span> XplusY. Barchasi muhofaza qilingan.</div>
    <div class="f-right">Uz • <a href="#about">Biz haqimizda</a></div>
  </footer>

  <!-- Side Panel (kun/tun dan mustaqil doim bir xil qorong‘i) -->
  <aside id="sidePanel" class="side-panel" aria-hidden="true">
    <div class="panel-backdrop" data-close-panel></div>
    <div class="panel-card" role="dialog" aria-modal="true" aria-labelledby="panelTitle" tabindex="-1">
      <div class="panel-head">
        <div class="brand small"><span class="logo">π</span><span class="title" id="panelTitle">Menyu</span></div>
        <button class="icon-btn close" title="Yopish" data-close-panel>×</button>
      </div>
      <div class="panel-body">
        <nav class="panel-nav">
          <a href="#home" class="panel-link" data-panel-link>🏠 Bosh sahifa</a>
          <a href="#tests" class="panel-link" data-panel-link>🧮 Testlar</a>
          <a href="#live" class="panel-link" data-panel-link>🟢 Live</a>
          <a href="#leaderboard" class="panel-link" data-panel-link>🏆 Reyting</a>
          <a href="#about" class="panel-link" data-panel-link>ℹ️ Biz haqimizda</a>
        </nav>
        <div class="panel-sep"></div>
        <div id="panelUser" class="panel-user muted">
          Mehmon. Kirish uchun quyidagi tugmadan foydalaning.
          <div style="display:grid; gap:8px; margin-top:8px">
            <button class="btn" id="panelOpenAuth">Kirish / Ro‘yxatdan o‘tish</button>
          </div>
        </div>
      </div>
    </div>
  </aside>

  <!-- Auth Modal -->
  <div class="modal" id="authModal" aria-hidden="true">
    <div class="modal-backdrop" data-close></div>
    <div class="modal-card" role="dialog" aria-modal="true">
      <div class="modal-head">
        <div class="tabs" role="tablist">
          <button class="tab active" data-tab="login">Kirish (ID + Parol)</button>
          <button class="tab" data-tab="signup">Ro‘yxatdan o‘tish</button>
        </div>
        <button class="icon-btn close" title="Yopish" data-close>×</button>
      </div>

      <div class="modal-body glossy">
        <!-- Login -->
        <section class="tab-panel active" data-panel="login">
          <form id="loginForm" class="form" autocomplete="off">
            <div class="form-row">
              <label for="loginId">ID</label>
              <div class="input-group">
                <span class="ig-icon" aria-hidden="true">🆔</span>
                <input id="loginId" name="id" inputmode="numeric" pattern="\d{7,}" placeholder="1000001" required autocomplete="username" autocapitalize="off" autocorrect="off" spellcheck="false" />
              </div>
            </div>
            <div class="form-row">
              <label for="loginPass">Parol</label>
              <div class="input-group">
                <span class="ig-icon" aria-hidden="true">🔒</span>
                <input id="loginPass" name="password" type="password" minlength="6" placeholder="••••••" required autocomplete="current-password" autocapitalize="off" autocorrect="off" spellcheck="false" />
              </div>
            </div>
            <button class="btn primary wide" type="submit">Kirish</button>
            <p class="muted small">Kirish faqat <b>ID + Parol</b> orqali. Email/Google bilan kirish <b>mavjud emas</b>.</p>
            <div id="loginMsg" class="msg"></div>
          </form>
        </section>

        <!-- Signup -->
        <section class="tab-panel" data-panel="signup">
          <div class="subtabs" role="tablist">
            <button class="subtab active" data-sub="email">Email orqali</button>
            <button class="subtab" data-sub="google">Google (faqat ro‘yxatdan)</button>
            <button class="subtab" data-sub="oneclick">Bir bosishda</button>
            <button class="subtab" data-sub="phone">Telefon raqam</button>
          </div>

          <!-- Email signup -->
          <form id="signupEmailForm" class="form subpanel active" data-subpanel="email" autocomplete="off">
            <div class="form-row">
              <label for="seName">Ism Familiya (ixtiyoriy)</label>
              <input id="seName" name="name" placeholder="Ism Familiya" />
            </div>
            <div class="form-row">
              <label for="seEmail">Email</label>
              <div class="input-group">
                <span class="ig-icon" aria-hidden="true">✉️</span>
                <input id="seEmail" name="email" type="email" placeholder="you@email.com" required />
              </div>
            </div>
            <div class="form-row">
              <label for="sePass">Parol (o‘ylab toping)</label>
              <div class="input-group">
                <span class="ig-icon" aria-hidden="true">🔑</span>
                <input id="sePass" name="password" type="password" minlength="6" placeholder="kamida 6 belgi" required autocomplete="new-password" autocapitalize="off" autocorrect="off" spellcheck="false" />
              </div>
            </div>
            <button class="btn success wide" type="submit">Ro‘yxatdan o‘tish</button>
            <div id="signupEmailMsg" class="msg"></div>
          </form>

          <!-- Google signup -->
          <div class="subpanel" data-subpanel="google">
            <p class="muted">Google bilan ro‘yxatdan o‘ting. So‘ng <b>ID</b> beriladi va <b>parol o‘rnatish</b> shart — keyin kirish faqat ID+Parol.</p>
            <button id="googleBtn" class="btn wide">Google bilan ro‘yxatdan o‘tish</button>
            <div id="signupGoogleStepSetPass" class="hidden">
              <form id="googleSetPassForm" class="form" autocomplete="off">
                <div class="form-row">
                  <label for="sgPass">Parol o‘rnatish</label>
                  <div class="input-group">
                    <span class="ig-icon" aria-hidden="true">🔑</span>
                    <input id="sgPass" type="password" minlength="6" required placeholder="kamida 6 belgi" autocomplete="new-password" autocapitalize="off" autocorrect="off" spellcheck="false" />
                  </div>
                </div>
                <button class="btn success wide" type="submit">Parolni ulash</button>
              </form>
            </div>
            <div id="signupGoogleMsg" class="msg"></div>
          </div>

          <!-- One-click signup -->
          <form id="oneClickForm" class="form subpanel" data-subpanel="oneclick" autocomplete="off">
            <div class="form-row">
              <label for="ocName">Ism Familiya (ixtiyoriy)</label>
              <input id="ocName" placeholder="Ism Familiya" />
            </div>
            <div class="form-row">
              <label for="ocPass">Parol (o‘ylab toping)</label>
              <div class="input-group">
                <span class="ig-icon" aria-hidden="true">🔑</span>
                <input id="ocPass" type="password" minlength="6" placeholder="kamida 6 belgi" required autocomplete="new-password" autocapitalize="off" autocorrect="off" spellcheck="false" />
              </div>
            </div>
            <button class="btn success wide" type="submit">Bir bosishda ro‘yxatdan o‘tish</button>
            <p class="muted small">Email shart emas. Sizga navbatdagi ID beriladi va tizim ichki email yaratadi.</p>
            <div id="oneClickMsg" class="msg"></div>
          </form>

          <!-- Phone signup -->
          <div class="subpanel" data-subpanel="phone">
            <div class="card-lite">
              <form id="phoneStartForm" class="form" autocomplete="off">
                <div class="form-row">
                  <label for="phNumber">Telefon raqam (E.164, masalan: +99890xxxxxxx)</label>
                  <div class="input-group">
                    <span class="ig-icon" aria-hidden="true">📱</span>
                    <input id="phNumber" type="tel" placeholder="+99890xxxxxxx" required autocomplete="tel" />
                  </div>
                </div>
                <button class="btn success wide" id="phSendCode" type="submit">SMS kod yuborish</button>
                <div id="phoneMsg" class="msg"></div>
              </form>

              <form id="phoneVerifyForm" class="form hidden" autocomplete="off">
                <div class="form-row">
                  <label for="phCode">Tasdiqlash kodi</label>
                  <div class="input-group">
                    <span class="ig-icon" aria-hidden="true">🔐</span>
                    <input id="phCode" inputmode="numeric" pattern="\d{4,8}" placeholder="123456" required autocomplete="one-time-code" />
                  </div>
                </div>
                <button class="btn primary wide" type="submit">Kodni tasdiqlash</button>
              </form>

              <form id="phoneSetPassForm" class="form hidden" autocomplete="off">
                <div class="form-row">
                  <label for="phPass">Parol o‘rnatish (kelgusi kirish: ID+Parol)</label>
                  <div class="input-group">
                    <span class="ig-icon" aria-hidden="true">🔑</span>
                    <input id="phPass" type="password" minlength="6" placeholder="kamida 6 belgi" required autocomplete="new-password" />
                  </div>
                </div>
                <button class="btn success wide" type="submit">Parolni ulash</button>
              </form>
            </div>
            <!-- reCAPTCHA konteyner (invisible) -->
            <div id="phoneCaptcha" class="hidden"></div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- Firebase config (siz bergan) -->
  <script>
    window.FIREBASE_CONFIG = {
      apiKey: "AIzaSyDYwHJou_9GqHZcf8XxtTByC51Z8un8rrM",
      authDomain: "xplusy-760fa.firebaseapp.com",
      projectId: "xplusy-760fa",
      storageBucket: "xplusy-760fa.appspot.com",
      messagingSenderId: "992512966017",
      appId: "1:992512966017:web:5e919dbc9b8d8abcb43c80",
      measurementId: "G-459PLJ7P7L"
    };
  </script>
  <script type="module" src="./app.js"></script>
</body>
</html>
