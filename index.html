<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>XplusY ‚Äî Auth (ID+Parol) ‚Ä¢ Email/Google/Phone Signup</title>

  <!-- Favicon (œÄ) -->
  <link rel="icon" type="image/svg+xml" href='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64"><defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="%2334d399"/><stop offset="1" stop-color="%2310b981"/></linearGradient></defs><rect x="4" y="4" rx="12" ry="12" width="56" height="56" fill="url(%23g)"/><text x="32" y="40" font-size="32" text-anchor="middle" font-family="Segoe UI, Arial, sans-serif" fill="%230b1210" font-weight="800">œÄ</text></svg>'/>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <!-- Header -->
  <header class="site-header">
    <button id="menuBtn" class="icon-btn burger" aria-label="Menyu" aria-controls="sidePanel" aria-expanded="false">
      <span></span><span></span><span></span>
    </button>
    <div class="brand"><span class="logo">œÄ</span><span class="title">XplusY</span></div>
    <div class="auth-chip" id="authChip">
      <button id="openAuth" class="btn primary">Kirish / Ro‚Äòyxatdan o‚Äòtish</button>
    </div>
  </header>

  <!-- Nav (demo) -->
  <nav class="site-nav">
    <a href="#home" class="nav-link">Bosh sahifa</a>
    <a href="#tests" class="nav-link">Testlar</a>
    <a href="#live" class="nav-link">Live</a>
    <a href="#leaderboard" class="nav-link">Reyting</a>
    <a href="#about" class="nav-link">Biz haqimizda</a>
  </nav>

  <!-- App -->
  <main id="app" class="app"></main>

  <!-- Footer -->
  <footer class="site-footer">
    <div>¬© <span id="year"></span> XplusY</div>
    <div class="muted">Uz ‚Ä¢ <a href="#about">Biz haqimizda</a></div>
  </footer>

  <!-- Side Panel (hamisha qorong‚Äòi) -->
  <aside id="sidePanel" class="side-panel" aria-hidden="true">
    <div class="panel-backdrop" data-close-panel></div>
    <div class="panel-card" role="dialog" aria-modal="true" aria-labelledby="panelTitle" tabindex="-1">
      <div class="panel-head">
        <div class="brand small"><span class="logo">œÄ</span><span class="title" id="panelTitle">Menyu</span></div>
        <button class="icon-btn close" title="Yopish" data-close-panel>√ó</button>
      </div>
      <div class="panel-body">
        <nav class="panel-nav">
          <a href="#home" class="panel-link" data-panel-link>üè† Bosh sahifa</a>
          <a href="#tests" class="panel-link" data-panel-link>üßÆ Testlar</a>
          <a href="#live" class="panel-link" data-panel-link>üü¢ Live</a>
          <a href="#leaderboard" class="panel-link" data-panel-link>üèÜ Reyting</a>
          <a href="#about" class="panel-link" data-panel-link>‚ÑπÔ∏è Biz haqimizda</a>
        </nav>
        <div class="panel-sep"></div>
        <div id="panelUser" class="panel-user muted">
          Mehmon. Kirish uchun quyidagi tugmadan foydalaning.
          <div style="display:grid; gap:8px; margin-top:8px">
            <button class="btn" id="panelOpenAuth">Kirish / Ro‚Äòyxatdan o‚Äòtish</button>
          </div>
        </div>
      </div>
    </div>
  </aside>

  <!-- Auth Modal (oq+yashil, CSS-only dizayn) -->
  <div class="modal" id="authModal" aria-hidden="true">
    <div class="modal-backdrop" data-close></div>
    <div class="modal-card" role="dialog" aria-modal="true">
      <div class="modal-head">
        <div class="tabs" role="tablist">
          <button class="tab active" data-tab="login">Kirish (ID + Parol)</button>
          <button class="tab" data-tab="signup">Ro‚Äòyxatdan o‚Äòtish</button>
        </div>
        <button class="icon-btn close" title="Yopish" data-close>√ó</button>
      </div>

      <div class="modal-body">
        <!-- Login -->
        <section class="tab-panel active" data-panel="login">
          <form id="loginForm" class="form" autocomplete="off">
            <div class="form-row">
              <label for="loginId">ID</label>
              <div class="input-group">
                <span class="ig-icon" data-i="id" aria-hidden="true"></span>
                <input id="loginId" name="id" inputmode="numeric" pattern="\d{7,}" placeholder="1000001" required autocomplete="username" />
              </div>
            </div>
            <div class="form-row">
              <label for="loginPass">Parol</label>
              <div class="input-group">
                <span class="ig-icon" data-i="lock" aria-hidden="true"></span>
                <input id="loginPass" name="password" type="password" minlength="6" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="current-password" />
              </div>
            </div>
            <button class="btn primary wide" type="submit">Kirish</button>
            <p class="muted small">Kirish faqat <b>ID + Parol</b> orqali.</p>
            <div id="loginMsg" class="msg"></div>
          </form>
        </section>

        <!-- Signup -->
        <section class="tab-panel" data-panel="signup">
          <div class="subtabs" role="tablist">
            <button class="subtab active" data-sub="email">Email</button>
            <button class="subtab" data-sub="google">Google</button>
            <button class="subtab" data-sub="oneclick">Bir bosishda</button>
            <button class="subtab" data-sub="phone">Telefon</button>
          </div>

          <!-- Email -->
          <form id="signupEmailForm" class="form subpanel active" data-subpanel="email" autocomplete="off">
            <div class="form-row">
              <label for="seName">Ism Familiya (ixtiyoriy)</label>
              <input id="seName" name="name" placeholder="Ism Familiya" />
            </div>
            <div class="form-row">
              <label for="seEmail">Email</label>
              <div class="input-group">
                <span class="ig-icon" data-i="mail"></span>
                <input id="seEmail" name="email" type="email" placeholder="you@email.com" required />
              </div>
            </div>
            <div class="form-row">
              <label for="sePass">Parol</label>
              <div class="input-group">
                <span class="ig-icon" data-i="key"></span>
                <input id="sePass" name="password" type="password" minlength="6" placeholder="kamida 6 belgi" required autocomplete="new-password" />
              </div>
            </div>
            <button class="btn success wide" type="submit">Ro‚Äòyxatdan o‚Äòtish</button>
            <div id="signupEmailMsg" class="msg"></div>
          </form>

          <!-- Google -->
          <div class="subpanel" data-subpanel="google">
            <p class="muted small">Google bilan ro‚Äòyxatdan o‚Äòting. So‚Äòng parol o‚Äòrnating ‚Äî keyingi kirish ID+Parol.</p>
            <button id="googleBtn" class="btn wide">Google bilan ro‚Äòyxatdan o‚Äòtish</button>
            <div id="signupGoogleStepSetPass" class="hidden">
              <form id="googleSetPassForm" class="form" autocomplete="off">
                <div class="form-row">
                  <label for="sgPass">Parol o‚Äòrnatish</label>
                  <div class="input-group">
                    <span class="ig-icon" data-i="key"></span>
                    <input id="sgPass" type="password" minlength="6" required placeholder="kamida 6 belgi" autocomplete="new-password" />
                  </div>
                </div>
                <button class="btn success wide" type="submit">Parolni ulash</button>
              </form>
            </div>
            <div id="signupGoogleMsg" class="msg"></div>
          </div>

          <!-- One-click -->
          <form id="oneClickForm" class="form subpanel" data-subpanel="oneclick" autocomplete="off">
            <div class="form-row">
              <label for="ocName">Ism Familiya (ixtiyoriy)</label>
              <input id="ocName" placeholder="Ism Familiya" />
            </div>
            <div class="form-row">
              <label for="ocPass">Parol</label>
              <div class="input-group">
                <span class="ig-icon" data-i="key"></span>
                <input id="ocPass" type="password" minlength="6" placeholder="kamida 6 belgi" required autocomplete="new-password" />
              </div>
            </div>
            <button class="btn success wide" type="submit">Bir bosishda ro‚Äòyxatdan</button>
            <p class="muted small">Email shart emas. Sizga navbatdagi ID beriladi.</p>
            <div id="oneClickMsg" class="msg"></div>
          </form>

          <!-- Phone -->
          <div class="subpanel" data-subpanel="phone">
            <div class="card-lite">
              <form id="phoneStartForm" class="form" autocomplete="off">
                <div class="form-row">
                  <label for="phNumber">Telefon (E.164, masalan: +99890xxxxxxx)</label>
                  <div class="input-group">
                    <span class="ig-icon" data-i="phone"></span>
                    <input id="phNumber" type="tel" placeholder="+99890xxxxxxx" required autocomplete="tel" />
                  </div>
                </div>
                <button class="btn success wide" id="phSendCode" type="submit">SMS yuborish</button>
                <div id="phoneMsg" class="msg"></div>
              </form>

              <form id="phoneVerifyForm" class="form hidden" autocomplete="off">
                <div class="form-row">
                  <label for="phCode">Tasdiqlash kodi</label>
                  <div class="input-group">
                    <span class="ig-icon" data-i="code"></span>
                    <input id="phCode" inputmode="numeric" pattern="\d{4,8}" placeholder="123456" required autocomplete="one-time-code" />
                  </div>
                </div>
                <button class="btn primary wide" type="submit">Kodni tasdiqlash</button>
              </form>

              <form id="phoneSetPassForm" class="form hidden" autocomplete="off">
                <div class="form-row">
                  <label for="phPass">Parol (kelgusi kirish: ID+Parol)</label>
                  <div class="input-group">
                    <span class="ig-icon" data-i="key"></span>
                    <input id="phPass" type="password" minlength="6" placeholder="kamida 6 belgi" required autocomplete="new-password" />
                  </div>
                </div>
                <button class="btn success wide" type="submit">Parolni ulash</button>
              </form>
            </div>
            <div id="phoneCaptcha" class="hidden"></div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- Fallback partial (home) -->
  <template id="tpl-home">
    <div class="card" style="padding:16px; border:1px solid rgba(255,255,255,.06); border-radius:14px; background:var(--card); box-shadow: var(--shadow);">
      <h2 style="margin-top:0">SPA ishlamoqda ‚úÖ</h2>
      <p class="muted">Yon panelni sinang, ro‚Äòyxatdan o‚Äòting va kirishni tekshiring.</p>
    </div>
  </template>

  <!-- Firebase config -->
  <script>
    window.FIREBASE_CONFIG = {
      apiKey: "AIzaSyDYwHJou_9GqHZcf8XxtTByC51Z8un8rrM",
      authDomain: "xplusy-760fa.firebaseapp.com",
      projectId: "xplusy-760fa",
      storageBucket: "xplusy-760fa.appspot.com",
      messagingSenderId: "992512966017",
      appId: "1:992512966017:web:5e919dbc9b8d8abcb43c80",
      measurementId: "G-459PLJ7P7L"
    };
  </script>

  <script type="module" src="./app.js"></script>
</body>
</html>
