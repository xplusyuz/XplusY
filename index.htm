<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MathCenter.uz - Professional Header</title>
    <link rel="icon" type="image/x-icon" href="#">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <style>
        :root {
            --primary: #2E8B57;
            --primary-dark: #1F6B45;
            --primary-light: #4CAF7D;
            --secondary: #1A3C34;
            --accent: #FFC107;
            --light: #F8F9FA;
            --dark: #212529;
            --gray: #6C757D;
            --light-gray: #E9ECEF;
            --border-radius: 6px;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Open Sans', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 1400px;
        }

        .demo-info {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--primary);
        }

        .demo-info h1 {
            color: var(--primary);
            margin-bottom: 10px;
            font-family: 'Montserrat', sans-serif;
        }

        .demo-info p {
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .feature {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .feature i {
            color: var(--primary);
            font-size: 18px;
        }

        /* Header Styles */
        .header {
            background: white;
            box-shadow: var(--shadow);
            position: relative;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            overflow: hidden;
        }

        .header-top {
            background: var(--secondary);
            color: white;
            padding: 8px 0;
            font-size: 14px;
        }

        .header-top-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 30px;
        }

        .contact-info {
            display: flex;
            gap: 20px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .social-links {
            display: flex;
            gap: 15px;
        }

        .social-link {
            color: white;
            transition: var(--transition);
        }

        .social-link:hover {
            color: var(--accent);
        }

        .header-main {
            padding: 0 30px;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
            padding: 15px 0;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: var(--dark);
        }

        .logo-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 28px;
            box-shadow: 0 4px 10px rgba(46, 139, 87, 0.3);
        }

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo-main {
            font-family: 'Montserrat', sans-serif;
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
            line-height: 1;
        }

        .logo-sub {
            font-size: 12px;
            color: var(--gray);
            letter-spacing: 1px;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 5px;
        }

        .nav-item {
            position: relative;
        }

        .nav-item a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 600;
            font-size: 16px;
            transition: var(--transition);
            padding: 12px 20px;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-item a i {
            font-size: 18px;
        }

        .nav-item a:hover {
            background-color: var(--light);
            color: var(--primary);
        }

        .nav-item.active a {
            background-color: var(--primary-light);
            color: white;
        }

        .auth-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 15px;
            background: linear-gradient(to right, var(--light), var(--light-gray));
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid var(--light-gray);
        }

        .user-info:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .user-avatar {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 18px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .user-details {
            display: flex;
            flex-direction: column;
        }

        .user-name {
            font-weight: 600;
            font-size: 15px;
            color: var(--dark);
        }

        .user-stats {
            display: flex;
            gap: 15px;
            margin-top: 5px;
        }

        .user-stat {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            color: var(--gray);
        }

        .user-stat i {
            color: var(--primary);
        }

        .login-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 10px rgba(46, 139, 87, 0.3);
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(46, 139, 87, 0.4);
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--dark);
            padding: 10px;
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .mobile-menu-btn:hover {
            background-color: var(--light-gray);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            transform: scale(0.9);
            animation: modalAppear 0.3s forwards;
        }

        @keyframes modalAppear {
            to {
                transform: scale(1);
            }
        }

        .modal-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 22px;
            font-weight: 600;
            font-family: 'Montserrat', sans-serif;
        }

        .close-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 30px;
            max-height: 70vh;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 14px;
            color: var(--dark);
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--light-gray);
            border-radius: var(--border-radius);
            font-size: 15px;
            transition: var(--transition);
            background-color: var(--light);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(46, 139, 87, 0.1);
            background-color: white;
        }

        .form-select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--light-gray);
            border-radius: var(--border-radius);
            font-size: 15px;
            background-color: var(--light);
            cursor: pointer;
            transition: var(--transition);
        }

        .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(46, 139, 87, 0.1);
            background-color: white;
        }

        .form-row {
            display: flex;
            gap: 20px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .submit-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
            margin-top: 10px;
            font-size: 16px;
            box-shadow: 0 4px 10px rgba(46, 139, 87, 0.3);
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(46, 139, 87, 0.4);
        }

        /* Mobile Styles */
        @media (max-width: 1200px) {
            .nav-menu {
                gap: 0;
            }
            
            .nav-item a {
                padding: 12px 15px;
            }
        }

        @media (max-width: 992px) {
            .header-top {
                display: none;
            }
            
            .nav-menu {
                gap: 0;
            }
            
            .nav-item a {
                padding: 10px 12px;
                font-size: 15px;
            }
            
            .nav-item a i {
                font-size: 16px;
            }
        }

        @media (max-width: 768px) {
            .header-container {
                padding: 10px 0;
            }

            .mobile-menu-btn {
                display: block;
            }

            .nav-menu {
                position: fixed;
                top: 0;
                left: -100%;
                width: 280px;
                height: 100vh;
                background-color: white;
                flex-direction: column;
                padding: 80px 20px 30px;
                gap: 0;
                transition: var(--transition);
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
                z-index: 1000;
            }

            .nav-menu.active {
                left: 0;
            }

            .nav-item {
                width: 100%;
                margin-bottom: 10px;
            }

            .nav-item a {
                display: flex;
                padding: 15px;
                border-radius: var(--border-radius);
                background-color: var(--light);
            }

            .auth-section {
                margin-left: auto;
                margin-right: 15px;
            }

            .user-details {
                display: none;
            }
            
            .logo-text {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 0 10px;
            }

            .header-main {
                padding: 0 15px;
            }

            .logo-icon {
                width: 50px;
                height: 50px;
                font-size: 24px;
            }

            .login-btn {
                padding: 10px 15px;
                font-size: 14px;
            }

            .modal-content {
                width: 95%;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <header class="header">
            <div class="header-top">
                <div class="header-top-container">
                    <div class="contact-info">
                        <div class="contact-item">
                            <i class="fas fa-phone"></i>
                            <span>+998 71 123 45 67</span>
                        </div>
                        <div class="contact-item">
                            <i class="fas fa-envelope"></i>
                            <span>info@mathcenter.uz</span>
                        </div>
                    </div>
                    <div class="social-links">
                        <a href="#" class="social-link"><i class="fab fa-telegram"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
            
            <div class="header-main">
                <div class="header-container">
                    <div class="logo-container">
                        <a href="#" class="logo">
                            <div class="logo-icon">M</div>
                            <div class="logo-text">
                                <div class="logo-main">MathCenter</div>
                                <div class="logo-sub">MATEMATIKA MARKAZI</div>
                            </div>
                        </a>
                    </div>

                    <button class="mobile-menu-btn" id="mobileMenuBtn">
                        <i class="fas fa-bars"></i>
                    </button>

                    <nav>
                        <ul class="nav-menu" id="navMenu">
                            <li class="nav-item active"><a href="#"><i class="fas fa-home"></i> Bosh sahifa</a></li>
                            <li class="nav-item"><a href="#"><i class="fas fa-book-open"></i> Kurslar</a></li>
                            <li class="nav-item"><a href="#"><i class="fas fa-clipboard-list"></i> Testlar</a></li>
                            <li class="nav-item"><a href="#"><i class="fas fa-laptop-code"></i> Simulyatorlar</a></li>
                            <li class="nav-item"><a href="#"><i class="fas fa-chart-line"></i> Natijalar</a></li>
                        </ul>
                    </nav>

                    <div class="auth-section">
                        <div class="user-info" id="userInfo" style="display: none;">
                            <div class="user-avatar" id="userAvatar">U</div>
                            <div class="user-details">
                                <div class="user-name" id="userName">Ism Familiya</div>
                                <div class="user-stats">
                                    <div class="user-stat">
                                        <i class="fas fa-coins"></i>
                                        <span>Balans: <strong id="userBalance">0</strong> ball</span>
                                    </div>
                                    <div class="user-stat">
                                        <i class="fas fa-star"></i>
                                        <span>ID: <strong id="userId">12345</strong></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <button class="login-btn" id="loginBtn">
                            <i class="fab fa-google"></i>
                            Google orqali kirish
                        </button>
                    </div>
                </div>
            </div>
        </header>
    <!-- Profile Modal -->
    <div class="modal" id="profileModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Profil ma'lumotlarini to'ldiring</h2>
                <button class="close-btn" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="profileForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="firstName">Ism</label>
                            <input type="text" id="firstName" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="lastName">Familiya</label>
                            <input type="text" id="lastName" class="form-input" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="middleName">Sharif</label>
                        <input type="text" id="middleName" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="birthDate">Tug'ilgan sana</label>
                        <input type="date" id="birthDate" class="form-input" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label" for="region">Viloyat</label>
                            <select id="region" class="form-select" required>
                                <option value="">Tanlang</option>
                                <option value="toshkent">Toshkent</option>
                                <option value="andijon">Andijon</option>
                                <option value="buxoro">Buxoro</option>
                                <option value="fargona">Farg'ona</option>
                                <option value="jizzax">Jizzax</option>
                                <option value="namangan">Namangan</option>
                                <option value="navoiy">Navoiy</option>
                                <option value="qashqadaryo">Qashqadaryo</option>
                                <option value="samarqand">Samarqand</option>
                                <option value="sirdaryo">Sirdaryo</option>
                                <option value="surxondaryo">Surxondaryo</option>
                                <option value="xorazm">Xorazm</option>
                                <option value="qoraqalpogiston">Qoraqalpog'iston</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="district">Tuman</label>
                            <select id="district" class="form-select" required>
                                <option value="">Tanlang</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="school">Maktab nomi</label>
                        <input type="text" id="school" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="role">Rolingiz</label>
                        <select id="role" class="form-select" required>
                            <option value="">Tanlang</option>
                            <option value="teacher">O'qituvchi</option>
                            <option value="student">O'quvchi</option>
                            <option value="user">Foydalanuvchi</option>
                            <option value="university_student">Talaba</option>
                            <option value="applicant">Abiturient</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="institution">Ta'lim muassasasi nomi</label>
                        <input type="text" id="institution" class="form-input">
                    </div>
                    <button type="submit" class="submit-btn">Ma'lumotlarni saqlash</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Firebase konfiguratsiyasi
        const firebaseConfig = {
            apiKey: "AIzaSyDYwHJou_9GqHZcf8XxtTByC51Z8un8rrM",
            authDomain: "xplusy-760fa.firebaseapp.com",
            projectId: "xplusy-760fa"
        };

        // Firebase ni ishga tushirish
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        // DOM elementlari
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const navMenu = document.getElementById('navMenu');
        const loginBtn = document.getElementById('loginBtn');
        const userInfo = document.getElementById('userInfo');
        const userName = document.getElementById('userName');
        const userAvatar = document.getElementById('userAvatar');
        const userBalance = document.getElementById('userBalance');
        const userId = document.getElementById('userId');
        const profileModal = document.getElementById('profileModal');
        const closeModal = document.getElementById('closeModal');
        const profileForm = document.getElementById('profileForm');
        const regionSelect = document.getElementById('region');
        const districtSelect = document.getElementById('district');

        // Tumanlar ro'yxati (viloyatlarga ko'ra)
        const districtsByRegion = {
            toshkent: ["Bektemir tumani", "Chilonzor tumani", "Yashnobod tumani", "Mirobod tumani", "Mirzo Ulug'bek tumani", "Sergeli tumani", "Shayxontohur tumani", "Olmazor tumani", "Uchtepa tumani", "Yakkasaroy tumani", "Yunusobod tumani"],
            andijon: ["Andijon shahri", "Andijon tumani", "Asaka tumani", "Baliqchi tumani", "Bo'z tumani", "Buloqboshi tumani", "Jalaquduq tumani", "Izboskan tumani", "Xo'jaobod tumani", "Qo'rg'ontepa tumani", "Marhamat tumani", "Oltinko'l tumani", "Paxtaobod tumani", "Shahrixon tumani", "Ulug'nor tumani"],
            buxoro: ["Buxoro shahri", "Buxoro tumani", "Vobkent tumani", "G'ijduvon tumani", "Jondor tumani", "Kogon tumani", "Qorako'l tumani", "Qorovulbozor tumani", "Olot tumani", "Peshku tumani", "Romitan tumani", "Shofirkon tumani", "Qorao'zak tumani"],
            fargona: ["Farg'ona shahri", "Farg'ona tumani", "Beshariq tumani", "Bog'dod tumani", "Buvayda tumani", "Dang'ara tumani", "Yozyovon tumani", "Quva tumani", "Quvasoy shahri", "Qo'qon shahri", "Rishton tumani", "So'x tumani", "Toshloq tumani", "Uchko'prik tumani", "O'zbekiston tumani", "Furqat tumani"],
            jizzax: ["Jizzax shahri", "Jizzax tumani", "Arnasoy tumani", "Baxmal tumani", "G'allaorol tumani", "Do'stlik tumani", "Zarbdor tumani", "Zafarobod tumani", "Zomin tumani", "Mirzacho'l tumani", "Paxtakor tumani", "Forish tumani", "Sharof Rashidov tumani", "Yangiobod tumani"],
            namangan: ["Namangan shahri", "Namangan tumani", "Kosonsoy tumani", "Mingbuloq tumani", "Norin tumani", "Pop tumani", "To'raqo'rg'on tumani", "Uchqo'rg'on tumani", "Uychi tumani", "Chortoq tumani", "Chust tumani", "Yangiqo'rg'on tumani"],
            navoiy: ["Navoiy shahri", "Navoiy tumani", "Zarafshon shahri", "Karmana tumani", "Qiziltepa tumani", "Xatirchi tumani", "Navbahor tumani", "Nurota tumani", "Tomdi tumani", "Uchquduq tumani"],
            qashqadaryo: ["Qarshi shahri", "Qarshi tumani", "Dehqonobod tumani", "Kasbi tumani", "Kitob tumani", "Koson tumani", "Mirishkor tumani", "Muborak tumani", "Nishon tumani", "Chiroqchi tumani", "Shahrisabz shahri", "Yakkabog' tumani"],
            samarqand: ["Samarqand shahri", "Samarqand tumani", "Bulung'ur tumani", "Jomboy tumani", "Ishtixon tumani", "Kattaqo'rg'on shahri", "Qo'shrabot tumani", "Narpay tumani", "Nurobod tumani", "Oqdaryo tumani", "Paxtachi tumani", "Payariq tumani", "Pastdarg'om tumani", "Toyloq tumani", "Urgut tumani"],
            sirdaryo: ["Guliston shahri", "Guliston tumani", "Boyovut tumani", "Mirzaobod tumani", "Oqoltin tumani", "Sayxunobod tumani", "Sardoba tumani", "Sirdaryo tumani", "Xovos tumani", "Shirin shahri", "Yangiyer shahri"],
            surxondaryo: ["Termiz shahri", "Termiz tumani", "Angor tumani", "Boysun tumani", "Denov tumani", "Jarqo'rg'on tumani", "Qiziriq tumani", "Qumqo'rg'on tumani", "Muzrabot tumani", "Oltinsoy tumani", "Sariosiyo tumani", "Sherobod tumani", "Sho'rchi tumani", "Bandixon tumani"],
            xorazm: ["Urganch shahri", "Urganch tumani", "Bog'ot tumani", "Gurlan tumani", "Qo'shko'pir tumani", "Shovot tumani", "Xiva tumani", "Xonqa tumani", "Hazorasp tumani", "Yangiarik tumani", "Yangibozor tumani"],
            qoraqalpogiston: ["Nukus shahri", "Nukus tumani", "Amudaryo tumani", "Beruniy tumani", "Chimboy tumani", "Ellikqala tumani", "Kegayli tumani", "Mo'ynoq tumani", "Qonliko'l tumani", "Qo'ng'irot tumani", "Qorao'zak tumani", "Shumanay tumani", "Taxtako'pir tumani", "To'rtko'l tumani", "Xo'jayli tumani"]
        };

        // Viloyat tanlanganda tumanlarni yangilash
        regionSelect.addEventListener('change', function() {
            const region = this.value;
            districtSelect.innerHTML = '<option value="">Tanlang</option>';
            
            if (region && districtsByRegion[region]) {
                districtsByRegion[region].forEach(district => {
                    const option = document.createElement('option');
                    option.value = district;
                    option.textContent = district;
                    districtSelect.appendChild(option);
                });
            }
        });

        // Mobil menyuni ochish/yopish
        mobileMenuBtn.addEventListener('click', function() {
            navMenu.classList.toggle('active');
        });

        // Modalni yopish
        closeModal.addEventListener('click', function() {
            profileModal.style.display = 'none';
        });

        // Modal tashqarisiga bosilganda yopish
        window.addEventListener('click', function(event) {
            if (event.target === profileModal) {
                profileModal.style.display = 'none';
            }
        });

        // Profil ma'lumotlarini saqlash
        profileForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Ma'lumotlarni saqlash
            const profileData = {
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                middleName: document.getElementById('middleName').value,
                birthDate: document.getElementById('birthDate').value,
                region: document.getElementById('region').value,
                district: document.getElementById('district').value,
                school: document.getElementById('school').value,
                role: document.getElementById('role').value,
                institution: document.getElementById('institution').value
            };
            
            // Ma'lumotlarni localStorage ga saqlash
            localStorage.setItem('userProfile', JSON.stringify(profileData));
            
            // Foydalanuvchi ma'lumotlarini yangilash
            updateUserDisplay(profileData);
            
            // Modalni yopish
            profileModal.style.display = 'none';
            
            alert('Profil ma\'lumotlari muvaffaqiyatli saqlandi!');
        });

        // Google orqali autentifikatsiya
        loginBtn.addEventListener('click', function() {
            const provider = new firebase.auth.GoogleAuthProvider();
            
            auth.signInWithPopup(provider)
                .then((result) => {
                    // Kirish muvaffaqiyatli
                    const user = result.user;
                    
                    // Foydalanuvchi ma'lumotlarini yangilash
                    updateUserDisplayAfterLogin(user);
                    
                    // Profil ma'lumotlari saqlanganligini tekshirish
                    const savedProfile = localStorage.getItem('userProfile');
                    if (!savedProfile) {
                        // Profil ma'lumotlari to'ldirilmagan, modalni ochish
                        profileModal.style.display = 'flex';
                    }
                })
                .catch((error) => {
                    console.error('Xatolik:', error);
                    alert('Kirishda xatolik yuz berdi. Iltimos, qaytadan urinib ko\'ring.');
                });
        });

        // Foydalanuvchi ma'lumotlarini yangilash (login dan keyin)
        function updateUserDisplayAfterLogin(user) {
            // Login tugmasini yashirish
            loginBtn.style.display = 'none';
            
            // Foydalanuvchi ma'lumotlarini ko'rsatish
            userInfo.style.display = 'flex';
            
            // Foydalanuvchi ismini o'rnatish
            userName.textContent = user.displayName || 'Foydalanuvchi';
            
            // Avatar uchun birinchi harf
            const firstLetter = user.displayName ? user.displayName.charAt(0).toUpperCase() : 'U';
            userAvatar.textContent = firstLetter;
            
            // Balans va ID ni tasodifiy qiymatlar bilan o'rnatish
            userBalance.textContent = Math.floor(Math.random() * 1000);
            userId.textContent = Math.floor(10000 + Math.random() * 90000);
        }

        // Profil ma'lumotlaridan foydalanuvchi ma'lumotlarini yangilash
        function updateUserDisplay(profileData) {
            const fullName = `${profileData.firstName} ${profileData.lastName}`;
            userName.textContent = fullName;
            userAvatar.textContent = profileData.firstName.charAt(0).toUpperCase();
        }

        // Sayt yuklanganda autentifikatsiya holatini tekshirish
        auth.onAuthStateChanged((user) => {
            if (user) {
                // Foydalanuvchi tizimga kirgan
                updateUserDisplayAfterLogin(user);
                
                // Saqlangan profil ma'lumotlarini yuklash
                const savedProfile = localStorage.getItem('userProfile');
                if (savedProfile) {
                    const profileData = JSON.parse(savedProfile);
                    updateUserDisplay(profileData);
                }
            } else {
                // Foydalanuvchi tizimga kirmagan
                loginBtn.style.display = 'flex';
                userInfo.style.display = 'none';
            }
        });

        // Profil ma'lumotlarini ko'rish uchun userInfo ni bosganda
        userInfo.addEventListener('click', function() {
            profileModal.style.display = 'flex';
            
            // Saqlangan ma'lumotlarni formaga yuklash
            const savedProfile = localStorage.getItem('userProfile');
            if (savedProfile) {
                const profileData = JSON.parse(savedProfile);
                document.getElementById('firstName').value = profileData.firstName || '';
                document.getElementById('lastName').value = profileData.lastName || '';
                document.getElementById('middleName').value = profileData.middleName || '';
                document.getElementById('birthDate').value = profileData.birthDate || '';
                document.getElementById('region').value = profileData.region || '';
                
                // Viloyat tanlangan bo'lsa, tumanlarni yuklash
                if (profileData.region) {
                    regionSelect.dispatchEvent(new Event('change'));
                    setTimeout(() => {
                        document.getElementById('district').value = profileData.district || '';
                    }, 100);
                }
                
                document.getElementById('school').value = profileData.school || '';
                document.getElementById('role').value = profileData.role || '';
                document.getElementById('institution').value = profileData.institution || '';
            }
        });

        // Nav itemlarni aktiv holatga keltirish
        document.querySelectorAll('.nav-item a').forEach(link => {
            link.addEventListener('click', function(e) {
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                this.parentElement.classList.add('active');
            });
        });
    </script>
</body>
</html>