<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>LeaderMath.UZ â€” Admin Panel</title>
  <link rel="stylesheet" href="assets/css/app.css"/>
  <style>
    .adminShell{display:flex; gap:14px; align-items:stretch; min-height:calc(100vh - 30px);}
    .adminSide{width:320px; max-width:90vw;}
    .adminMain{flex:1; min-width:0;}
    .adminTabs{display:flex; gap:8px; flex-wrap:wrap;}
    .adminTabs .chip{cursor:pointer; user-select:none;}
    .adminTabs .chip.active{outline:2px solid rgba(255,255,255,.25);}
    .adminPane{display:none;}
    .adminPane.active{display:block;}
    .table{width:100%; border-collapse:separate; border-spacing:0 10px;}
    .rowCard{background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.10); border-radius:16px; padding:10px;}
    .rowCard:hover{transform:translateY(-1px); transition:.18s ease; border-color:rgba(255,255,255,.18);}
    .grid2{display:grid; grid-template-columns:1fr 1fr; gap:12px;}
    .grid3{display:grid; grid-template-columns:1fr 1fr 1fr; gap:12px;}
    @media(max-width:980px){ .adminShell{flex-direction:column;} .adminSide{width:100%;} .grid2,.grid3{grid-template-columns:1fr;} }
    .miniBtn{padding:8px 10px; border-radius:12px;}
    .danger{background:rgba(255,70,70,.14)!important; border-color:rgba(255,70,70,.35)!important;}
    .success{background:rgba(40,210,120,.14)!important; border-color:rgba(40,210,120,.35)!important;}
    .muted{opacity:.75}
    .loginCover{position:fixed; inset:0; display:none; place-items:center; padding:20px; z-index:60;
      background:radial-gradient(1000px 600px at 60% 30%, rgba(46,139,87,.22), transparent 60%),
                 rgba(0,0,0,.55); backdrop-filter: blur(10px);}
    .loginCover.show{display:grid;}
    .loginCard{max-width:560px; width:100%;}
    .pill{display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px;
      background:rgba(255,255,255,.07); border:1px solid rgba(255,255,255,.12);}
    .selList{max-height:260px; overflow:auto; padding-right:4px;}
    .selItem{display:flex; align-items:center; gap:10px; padding:8px 10px; border-radius:14px;
      background:rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.10); margin-bottom:8px;}
    .selItem:hover{border-color:rgba(255,255,255,.18);}
    .kbd{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;}
  </style>
</head>
<body>
  <canvas class="seasonCanvas" id="seasonCanvas"></canvas>
  <div class="toast" id="toast"></div>

  <!-- Login cover -->
  <div class="loginCover" id="loginCover">
    <div class="glass loginCard">
      <div class="brand" style="justify-content:center; margin-bottom:10px;">
        <div class="logo" aria-hidden="true"><span>Ï€</span></div>
        <div class="titleWrap">
          <div class="title">LeaderMath Admin</div>
          <div class="subtitle">Google orqali kirish (faqat sohibjonmath@gmail.com)</div>
        </div>
      </div>

      <div class="rowCard" style="margin-top:10px;">
        <div class="muted" style="line-height:1.45">
          1) <b>assets/js/firebase-web-config.js</b> faylga Firebase web configâ€™ni qoâ€˜ying.<br/>
          2) Keyin pastdagi tugma orqali Google login qiling.
        </div>
        <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;">
          <button class="btn primary" id="btnGoogleLogin">Google orqali kirish</button>
          <button class="btn" id="btnReload">Qayta yuklash</button>
        </div>
        <div class="muted" id="loginErr" style="margin-top:10px;"></div>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="glass topbar">
      <div class="brand">
        <div class="logo" aria-hidden="true"><span>Ï€</span></div>
        <div class="titleWrap">
          <div class="title">LeaderMath.UZ â€” Admin Panel</div>
          <div class="subtitle" id="adminSub">Google Admin</div>
        </div>
      </div>

      <div class="topbarRight" style="gap:10px; align-items:center;">
        <div class="pill">
          <span class="muted">ğŸ‘¤</span>
          <b id="adminEmail">â€”</b>
        </div>
        <button class="btn miniBtn" id="btnRefresh">â†» Yangilash</button>
        <button class="btn danger miniBtn" id="btnLogout">Chiqish</button>
      </div>
    </div>

    <div class="adminShell">
      <div class="adminSide">
        <div class="glass">
          <div class="adminTabs" style="margin-bottom:10px;">
            <div class="chip active" id="tabDashboard">ğŸ“Š Dashboard</div>
            <div class="chip" id="tabUsers">ğŸ‘¥ Users</div>
            <div class="chip" id="tabComments">ğŸ’¬ Sharhlar</div>
            <div class="chip" id="tabNotify">ğŸ”” Bildirishnoma</div>
            <div class="chip" id="tabHistory">ğŸ§¾ Tarix</div>
          </div>

          <div class="rowCard">
            <div class="muted">Tezkor:</div>
            <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
              <button class="btn miniBtn" id="quickLoadUsers">Users</button>
              <button class="btn miniBtn" id="quickLoadComments">Sharhlar</button>
              <button class="btn miniBtn" id="quickLoadHistory">Tarix</button>
            </div>
          </div>

          <div class="rowCard" style="margin-top:12px;">
            <div class="muted">Holat</div>
            <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
              <div class="chip"><span class="k">Users:</span> <b id="statUsers">â€”</b></div>
              <div class="chip"><span class="k">Sharh:</span> <b id="statComments">â€”</b></div>
              <div class="chip"><span class="k">Unread:</span> <b id="statUnread">â€”</b></div>
            </div>
            <div class="muted" style="margin-top:10px;">Soâ€˜nggi yangilanish: <span class="kbd" id="statAt">â€”</span></div>
          </div>
        </div>
      </div>

      <div class="adminMain">
        <!-- Dashboard -->
        <div class="glass adminPane active" id="paneDashboard">
          <div class="title" style="font-size:18px;">Dashboard</div>
          <div class="muted" style="margin-top:6px;">Admin panel: foydalanuvchilar, sharh moderatsiya, bildirishnoma yuborish va tarix.</div>
          <div class="grid3" style="margin-top:14px;">
            <div class="rowCard">
              <div class="muted">Top users (preview)</div>
              <div id="dashTopUsers" style="margin-top:8px;"></div>
            </div>
            <div class="rowCard">
              <div class="muted">Soâ€˜nggi sharhlar</div>
              <div id="dashLastComments" style="margin-top:8px;"></div>
            </div>
            <div class="rowCard">
              <div class="muted">Soâ€˜nggi notif</div>
              <div id="dashLastNotif" style="margin-top:8px;"></div>
            </div>
          </div>
        </div>

        <!-- Users -->
        <div class="glass adminPane" id="paneUsers">
          <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;">
            <div>
              <div class="title" style="font-size:18px;">ğŸ‘¥ Users</div>
              <div class="muted">Qidirish, tanlash va bildirishnoma uchun belgilash.</div>
            </div>
            <div style="display:flex; gap:10px; flex-wrap:wrap;">
              <input class="input" id="userSearch" placeholder="ID / ism boâ€˜yicha qidirish..." style="min-width:240px;"/>
              <button class="btn miniBtn" id="usersLoadMore">Yana</button>
            </div>
          </div>
          <div class="selList" id="usersList" style="margin-top:14px;"></div>
        </div>

        <!-- Comments -->
        <div class="glass adminPane" id="paneComments">
          <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;">
            <div>
              <div class="title" style="font-size:18px;">ğŸ’¬ Sharhlar</div>
              <div class="muted">Admin sifatida tahrirlash/oâ€˜chirish (moderatsiya).</div>
            </div>
            <div style="display:flex; gap:10px; flex-wrap:wrap;">
              <input class="input" id="commentSearch" placeholder="ID / matn boâ€˜yicha qidirish..." style="min-width:240px;"/>
              <button class="btn miniBtn" id="commentsLoadMore">Yana</button>
            </div>
          </div>
          <div class="selList" id="commentsList" style="margin-top:14px;"></div>
        </div>

        <!-- Notify -->
        <div class="glass adminPane" id="paneNotify">
          <div class="title" style="font-size:18px;">ğŸ”” Bildirishnoma yuborish</div>
          <div class="muted" style="margin-top:6px;">Umumiy / bitta user / tanlanganlarga yuboring. Read receipts Tarixda koâ€˜rinadi.</div>

          <div class="grid2" style="margin-top:14px;">
            <div class="rowCard">
              <div class="muted">Audience</div>
              <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
                <label class="chip"><input type="radio" name="aud" value="all" checked> Barchaga</label>
                <label class="chip"><input type="radio" name="aud" value="user"> Bitta user</label>
                <label class="chip"><input type="radio" name="aud" value="selected"> Tanlanganlar</label>
              </div>
              <div style="margin-top:10px;">
                <input class="input" id="singleUserId" placeholder="Bitta user ID (LM-000001)..." />
                <div class="muted" style="margin-top:6px;">Tanlanganlar: Users boâ€˜limida checkbox bilan tanlang.</div>
              </div>
            </div>

            <div class="rowCard">
              <div class="muted">Xabar</div>
              <input class="input" id="notifTitle" placeholder="Sarlavha (60gacha)..." style="margin-top:10px;"/>
              <textarea class="input" id="notifBody" placeholder="Matn (240gacha)..." style="margin-top:10px; min-height:120px;"></textarea>
              <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
                <select class="input" id="notifType" style="max-width:220px;">
                  <option value="info">â„¹ï¸ Info</option>
                  <option value="success">âœ… Success</option>
                  <option value="warning">âš ï¸ Warning</option>
                  <option value="danger">â›” Danger</option>
                </select>
                <button class="btn primary" id="btnSendNotif">Yuborish</button>
              </div>
            </div>
          </div>

          <div class="rowCard" style="margin-top:12px;">
            <div class="muted">Tanlanganlar (preview)</div>
            <div id="selectedPreview" style="margin-top:10px;"></div>
          </div>
        </div>

        <!-- History -->
        <div class="glass adminPane" id="paneHistory">
          <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;">
            <div>
              <div class="title" style="font-size:18px;">ğŸ§¾ Tarix</div>
              <div class="muted">Yuborilgan bildirishnomalar va kim oâ€˜qigani.</div>
            </div>
            <button class="btn miniBtn" id="historyLoadMore">Yana</button>
          </div>
          <div class="selList" id="historyList" style="margin-top:14px;"></div>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="assets/js/seasons.js"></script>
  <script type="module" src="assets/js/admin.js"></script>
</body>
</html>
