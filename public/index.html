<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover"/>
<meta name="theme-color" content="#0ea5e9"/>
<link rel="icon" sizes="192x192" href="logo.png"/>
<link rel="apple-touch-icon" href="logo.png"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.min.js"></script>
<link rel="stylesheet" href="assets/css/style.css"/>
<link rel="stylesheet" href="assets/css/bridge.css"/>
<link rel="manifest" href="manifest.webmanifest"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<meta name="mobile-web-app-capable" content="yes"/>
<link rel="apple-touch-icon" sizes="180x180" href="icons/icon-180x180.png"/>
<link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192x192.png"/>
<link rel="stylesheet" href="assets/css/pwa.css"/>

<title>LeaderMath.UZ — Kirish</title>

<style id="premium-login-css">
/* === Premium Login (index.html) — 2026-01-20 === */
:root{
  --lm-green:#2E8B57;
  --lm-emerald:#3bb78f;
  --lm-ink: rgba(15,23,42,.92);
  --lm-glass: rgba(255,255,255,.70);
  --lm-glass2: rgba(255,255,255,.55);
  --lm-border: rgba(20,40,60,.14);
}
body[data-page="login"] .app{max-width:1120px;}
body[data-page="login"] header{position:relative;}
body[data-page="login"] .header-card{
  position:relative;
  overflow:hidden;
  border-radius:22px;
  background: radial-gradient(circle at 20% 10%, rgba(46,139,87,.22), transparent 55%),
              radial-gradient(circle at 80% 10%, rgba(14,165,233,.18), transparent 60%),
              rgba(255,255,255,.62);
  border:1px solid rgba(255,255,255,.55);
  box-shadow: 0 30px 80px rgba(2,6,23,.18);
}
body[data-page="login"] .header-card:before{
  content:"";
  position:absolute; inset:-2px;
  background: linear-gradient(135deg, rgba(46,139,87,.32), rgba(59,130,246,.20), rgba(46,139,87,.22));
  filter: blur(22px);
  opacity:.75;
}
body[data-page="login"] .header-card > *{position:relative;}

.loginMain{
  display:grid;
  grid-template-columns: 1.05fr .95fr;
  gap:16px;
  align-items:stretch;
}
@media (max-width: 860px){
  .loginMain{grid-template-columns:1fr;}
}

.brandPanel{
  position:relative;
  border-radius:22px;
  background: rgba(255,255,255,.48);
  border: 1px solid rgba(255,255,255,.50);
  box-shadow: 0 28px 80px rgba(2,6,23,.12);
  overflow:hidden;
}
.brandPanel:before{
  content:"";
  position:absolute; inset:-40%;
  background: conic-gradient(from 180deg, rgba(46,139,87,.18), rgba(14,165,233,.16), rgba(59,183,143,.18), rgba(46,139,87,.18));
  animation: spin 14s linear infinite;
  opacity:.8;
}
.brandPanel:after{
  content:"";
  position:absolute; inset:0;
  background: radial-gradient(circle at 30% 20%, rgba(255,255,255,.78), transparent 50%),
              radial-gradient(circle at 80% 40%, rgba(255,255,255,.35), transparent 55%),
              rgba(255,255,255,.22);
  backdrop-filter: blur(10px);
}
@keyframes spin{to{transform: rotate(360deg);}}
.brandInner{position:relative; z-index:1; padding:18px;}

.brandHero{
  display:flex; gap:14px; align-items:center;
  padding:14px; border-radius:18px;
  background: rgba(255,255,255,.66);
  border:1px solid rgba(20,40,60,.10);
}
.brandLogoWrap{
  width:72px;height:72px;border-radius:22px;
  display:grid;place-items:center;
  background: radial-gradient(circle at 30% 30%, rgba(46,139,87,.30), transparent 60%),
              linear-gradient(135deg, rgba(46,139,87,.22), rgba(59,130,246,.16));
  border:1px solid rgba(46,139,87,.26);
  box-shadow: 0 18px 40px rgba(2,6,23,.14);
}
.brandLogoWrap img{width:42px;height:42px;object-fit:contain;filter: drop-shadow(0 10px 18px rgba(2,6,23,.22));}
.brandText .title{font-weight:900;font-size:20px;letter-spacing:.2px;color:var(--lm-ink);}
.brandText .sub{margin-top:2px; font-size:12px; opacity:.78;}

.featureGrid{
  margin-top:12px;
  display:grid; grid-template-columns: repeat(2, minmax(0, 1fr));
  gap:10px;
}
@media (max-width: 520px){
  .featureGrid{grid-template-columns:1fr;}
}
.feat{
  padding:12px; border-radius:18px;
  background: rgba(255,255,255,.60);
  border:1px solid rgba(20,40,60,.10);
  display:flex; gap:10px; align-items:flex-start;
}
.feat .ic{
  width:34px;height:34px;border-radius:14px;
  display:grid;place-items:center;
  background: rgba(46,139,87,.12);
  border:1px solid rgba(46,139,87,.22);
  flex:0 0 auto;
}
.feat b{display:block; font-size:12px;}
.feat small{display:block; font-size:11px; opacity:.76; margin-top:2px;}

.loginCard{
  border-radius:22px;
  background: rgba(255,255,255,.62);
  border:1px solid rgba(255,255,255,.55);
  box-shadow: 0 30px 80px rgba(2,6,23,.14);
  overflow:hidden;
}
.loginCard .card{
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}

/* Buttons: more premium */
body[data-page="login"] .btn{
  border-radius: 16px;
  padding: 12px 14px;
  font-weight: 900;
  letter-spacing: .2px;
  box-shadow: 0 18px 38px rgba(2,6,23,.10);
}
body[data-page="login"] .btn:not(.secondary){
  background: linear-gradient(135deg, rgba(46,139,87,.92), rgba(59,183,143,.92));
  border: 1px solid rgba(46,139,87,.26);
}
body[data-page="login"] .btn.secondary{
  background: rgba(255,255,255,.78);
  border: 1px solid rgba(20,40,60,.14);
}
body[data-page="login"] .input{
  border-radius: 16px;
  padding: 12px 14px;
  background: rgba(255,255,255,.72);
  border: 1px solid rgba(20,40,60,.14);
}
body[data-page="login"] .card-title{font-weight: 950;}

/* Modal polish */
body[data-page="login"] .lm-modal-card{
  border-radius: 24px;
  background: rgba(255,255,255,.78);
  border: 1px solid rgba(255,255,255,.62);
  box-shadow: 0 40px 120px rgba(2,6,23,.25);
}
</style>
</head>
<body data-page="login">
  <div class="scroll-progress"><div class="scroll-progress-bar" id="scrollProgress"></div></div>
  <button class="scroll-to-top" id="scrollToTop" aria-label="Yuqoriga"><i class="fa-solid fa-arrow-up"></i></button>
  <canvas id="three-canvas"></canvas>

  <div class="app">
    <header class="loginTop">
      <div class="topRow">
        <a class="topBrand" href="#" aria-label="LeaderMath.UZ">
          <span class="topMark"></span>
          <span class="topName">LeaderMath.UZ</span>
          <span class="topBeta">PREMIUM</span>
        </a>
        <div class="topMini">
          <span class="miniPill"><i class="fa-solid fa-shield-halved"></i> Xavfsiz kirish</span>
          <span class="miniPill"><i class="fa-solid fa-bolt"></i> Tez start</span>
        </div>
      </div>
    </header>

    <main class="loginMain">
      <section class="brandPanel" aria-label="LeaderMath haqida">
        <div class="brandLogoWrap">
          <img src="logo.png" alt="LeaderMath.UZ">
        </div>

        <div class="brandText">
          <div class="title">Matematika — Premium tajriba</div>
          <div class="sub">Testlar, simulyatorlar, o‘yinlar va reyting — barchasi bitta joyda.</div>
        </div>

        <div class="featureGrid">
          <div class="feat">
            <div class="h"><i class="fa-solid fa-trophy"></i> Reyting & Darajalar</div>
            <div class="d">Ball to‘plang, medalyon oching, tengdoshlardan o‘zingizni sinang.</div>
          </div>
          <div class="feat">
            <div class="h"><i class="fa-solid fa-brain"></i> Aqlli kontent</div>
            <div class="d">Mavzu bo‘yicha tartiblangan darslar va mashqlar — tez topiladi.</div>
          </div>
          <div class="feat">
            <div class="h"><i class="fa-solid fa-gamepad"></i> O‘yin rejimi</div>
            <div class="d">Tez hisob-kitob, bosqichma-bosqich kuchayib boradigan treninglar.</div>
          </div>
          <div class="feat">
            <div class="h"><i class="fa-solid fa-cloud-arrow-up"></i> Bulut sinx</div>
            <div class="d">Natijalar saqlanadi, qurilmangiz o‘zgarsa ham hammasi joyida.</div>
          </div>
        </div>

        <div class="brandFoot">
          <span class="dot"></span>
          <span>“Men yangiman” tugmasi avtomatik ID+Parol yaratadi.</span>
        </div>
      </section>

      <section class="authPanel" aria-label="Kirish">
        <div class="authCard">
          <div class="authTitle">
            <div class="t"><i class="fa-solid fa-right-to-bracket"></i> Kirish</div>
            <div class="s">ID + Parol bilan kiring yoki 1 bosishda yangi hisob yarating.</div>
          </div>

          <div class="authForm">
            <label class="field">
              <span>ID</span>
              <div class="fieldRow">
                <i class="fa-solid fa-id-card"></i>
                <input id="inId" class="input" placeholder="LM-000000" autocomplete="username"/>
              </div>
            </label>

            <label class="field">
              <span>Parol</span>
              <div class="fieldRow">
                <i class="fa-solid fa-key"></i>
                <input id="inPw" class="input" placeholder="Parol" type="password" autocomplete="current-password"/>
              </div>
            </label>

            <div class="authBtns">
              <button class="btn" id="btnLogin" type="button"><i class="fa-solid fa-lock-open"></i> Kirish</button>
              <button class="btn secondary" id="btnStart" type="button"><i class="fa-solid fa-wand-magic-sparkles"></i> Men yangiman</button>
            </div>

            <div id="already" class="alreadyBox" style="display:none;">
              <div class="row">
                <div class="k"><i class="fa-solid fa-circle-check"></i> Siz avval kirgansiz</div>
                <a href="app.html" class="goApp"><i class="fa-solid fa-arrow-right"></i> App’ga o‘tish</a>
              </div>
              <div class="note">Brauzer token saqlangan — tez kirish mumkin.</div>
            </div>

            <div class="hintLine"><i class="fa-solid fa-triangle-exclamation"></i> ID va Parolni esdan chiqarmang!</div>
          </div>
        </div>

        <div class="authMini">
          <div class="miniItem"><i class="fa-solid fa-lock"></i> Parol shifrlanadi</div>
          <div class="miniItem"><i class="fa-solid fa-mobile-screen-button"></i> Telefon/PC mos</div>
          <div class="miniItem"><i class="fa-solid fa-wifi"></i> PWA o‘rnatish bor</div>
        </div>
      </section>
    </main>

    <footer>
      <div class="footer-card">
        <div class="footer-left">
          <div class="footer-name">LeaderMath.UZ</div>
          <div class="small-note">Matematikadan super interaktiv sayt!</div>
        </div>
        <div class="footer-right">
          <a class="footer-link" href="#"><i class="fa-solid fa-headset"></i> Yordam</a>
        
          <div class="storeBar" id="lmStoreBar" style="margin-top:10px;">
            <a class="storeBtn" id="btnPlayStore" href="#" title="Android (Play Market)"><img class="osIcon" src="icon.png" alt=""> <span>Play Market</span></a>
            <a class="storeBtn" id="btnAppStore" href="#" title="iPhone/iPad (App Store)"><img class="osIcon" src="icon.png" alt=""> <span>App Store</span></a>
            <a class="storeBtn" id="btnMsStore" href="#" title="Windows (Microsoft Store)"><img class="osIcon" src="icon.png" alt=""> <span>Microsoft Store</span></a>
            <a class="storeBtn install" id="btnInstallPWA" href="#" title="PWA o‘rnatish"><img class="osIcon" src="icon.png" alt=""> <span>O‘rnatish</span></a>
          </div>
        </div>
      </div>
    </footer>
  </div>

  <div id="toast" class="toast">...</div>

  <!-- Credentials modal -->
  <div id="credsModal" class="lm-modal">
    <div id="credsBackdrop" class="lm-backdrop"></div>
    <div class="lm-modal-card">
      <button class="close-btn" id="credsClose" aria-label="Yopish"><i class="fa-solid fa-xmark"></i></button>
      <div class="card-title" style="margin-bottom:6px">✅ ID + Parol yaratildi</div>
      <div class="small-note" style="margin-bottom:12px">Iltimos, saqlab qo‘ying. Keyin shu ID va Parol bilan kirishingiz mumkin.</div>

      <div class="auth-grid">
        <div>
          <div class="card-label">Sizning ID</div>
          <div class="form-row">
            <input id="newId" class="input" readonly value="LM-000000" />
            <button class="btn" id="copyId" type="button"><i class="fa-solid fa-copy"></i> Nusxa</button>
          </div>
        </div>
        <div>
          <div class="card-label">Sizning Parol</div>
          <div class="form-row">
            <input id="newPw" class="input" readonly value="AB-1234" />
            <button class="btn" id="copyPw" type="button"><i class="fa-solid fa-copy"></i> Nusxa</button>
          </div>
        </div>

        <div class="auth-actions">
          <button class="btn" id="goApp" type="button"><i class="fa-solid fa-arrow-right"></i> Ilovaga o‘tish</button>
          <button class="btn secondary" type="button" onclick="document.getElementById('credsClose').click()"><i class="fa-solid fa-bookmark"></i> Keyinroq</button>
        </div>
      </div>
    </div>
  </div>

  <script src="assets/js/core.js"></script>

    <script src="assets/js/pwa.js" defer></script>

<script type="module">
    import { registerAuto, login, getToken } from "./assets/js/auth.js";
    const $=id=>document.getElementById(id);

    const toast=(t)=>{
      const el=$("toast");
      el.textContent=t;
      el.classList.add("show");
      clearTimeout(window.__t);
      window.__t=setTimeout(()=>el.classList.remove("show"), 2600);
    };

    // already logged in?
    try{
      if(getToken && getToken()){
        $("already").style.display="block";
      }
    }catch{}

    function openModal(){
      $("credsModal").classList.add("open");
    }
    function closeModal(){
      $("credsModal").classList.remove("open");
    }
    $("credsBackdrop").onclick = closeModal;
    $("credsClose").onclick = closeModal;

    async function copyText(t){
      try{ await navigator.clipboard.writeText(t); toast("✅ Nusxalandi"); }
      catch{ toast("⚠️ Nusxalab bo‘lmadi"); }
    }
    $("copyId").onclick = ()=> copyText($("newId").value);
    $("copyPw").onclick = ()=> copyText($("newPw").value);
    $("goApp").onclick = ()=> location.href="./app.html";

    $("btnStart").onclick = async ()=>{
      try{
        $("btnStart").disabled=true;
        const r = await registerAuto();
        $("inId").value = r.loginId;
        $("inPw").value = r.password;
        $("newId").value = r.loginId;
        $("newPw").value = r.password;
        openModal();
      }catch(e){
        toast(e?.message || "Xatolik");
      }finally{
        $("btnStart").disabled=false;
      }
    };

    $("btnLogin").onclick = async ()=>{
      const id=$("inId").value.trim();
      const pw=$("inPw").value;
      if(!id || !pw) return toast("ID va Parolni kiriting");
      try{
        $("btnLogin").disabled=true;
        await login(id,pw);
        location.href="./app.html";
      }catch(e){
        toast("Kirish xato: "+(e?.message || ""));
      }finally{
        $("btnLogin").disabled=false;
      }
    };
  </script>
</body>
</html>
