<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Orzumall Admin Panel</title>
  <style>
    body {font-family:sans-serif;background:#f3f4f6;margin:0;padding:0;}
    header {background:#111827;color:#fff;text-align:center;padding:1rem;font-size:1.5rem;font-weight:bold;}
    main {padding:1rem;}
    section {background:#fff;padding:1rem;margin-bottom:1rem;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,0.1);}
    h2 {margin-top:0;}
    input, textarea, select {
      width:100%;padding:8px;margin:5px 0;border:1px solid #ccc;border-radius:6px;
    }
    button {
      background:#2563eb;color:#fff;border:none;padding:10px 15px;border-radius:6px;cursor:pointer;
    }
    button:hover {background:#1e40af;}
    .item {border:1px solid #ddd;padding:10px;margin-top:10px;border-radius:6px;}
    .delete-btn {background:#ef4444;margin-top:5px;}
  </style>
</head>
<body>

<header>Orzumall Admin Panel</header>
<main>
  <section>
    <h2>üñºÔ∏è Banner qo‚Äòshish</h2>
    <textarea id="bannerHtml" rows="4" placeholder="Banner HTML kodini kiriting..."></textarea>
    <button onclick="addBanner()">Banner qo‚Äòshish</button>
    <div id="bannerList"></div>
  </section>

  <section>
    <h2>üß© Card qo‚Äòshish</h2>
    <input type="text" id="cardTitle" placeholder="Sarlavha">
    <select id="cardType">
      <option value="simple">Oddiy</option>
      <option value="timed">Vaqtli</option>
      <option value="modal">Modal</option>
    </select>
    <input type="text" id="cardLink" placeholder="Link (faqat oddiy/vaqtli uchun)">
    <input type="datetime-local" id="cardStart" placeholder="Boshlanish vaqti (vaqtli uchun)">
    <input type="datetime-local" id="cardEnd" placeholder="Tugash vaqti (vaqtli uchun)">
    <textarea id="cardHtml" rows="3" placeholder="Card HTML kodini kiriting..."></textarea>
    <textarea id="modalHtml" rows="3" placeholder="Modal HTML (faqat modal uchun)"></textarea>
    <button onclick="addCard()">Card qo‚Äòshish</button>
    <div id="cardList"></div>
  </section>

  <button onclick="saveJson()">üíæ Saqlash</button>
</main>

<script>
let data = { banners: [], cards: [] };

async function loadJson() {
  try {
    const res = await fetch('index.json');
    data = await res.json();
  } catch {
    data = { banners: [], cards: [] };
  }
  render();
}

function render() {
  const bList = document.getElementById("bannerList");
  bList.innerHTML = "";
  data.banners.forEach((b, i) => {
    const div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `
      <b>Banner ${i+1}</b><br>
      <iframe srcdoc="${b.html}" style="width:100%;height:80px;border:none;"></iframe><br>
      <button class="delete-btn" onclick="delBanner(${i})">O‚Äòchirish</button>
    `;
    bList.appendChild(div);
  });

  const cList = document.getElementById("cardList");
  cList.innerHTML = "";
  data.cards.forEach((c, i) => {
    const div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `
      <b>${c.title}</b> (${c.type})<br>
      <iframe srcdoc="${c.html}" style="width:100%;height:80px;border:none;"></iframe><br>
      <button class="delete-btn" onclick="delCard(${i})">O‚Äòchirish</button>
    `;
    cList.appendChild(div);
  });
}

function addBanner() {
  const html = document.getElementById("bannerHtml").value.trim();
  if (!html) return alert("Banner HTML kiriting!");
  data.banners.push({ html });
  document.getElementById("bannerHtml").value = "";
  render();
}

function addCard() {
  const title = document.getElementById("cardTitle").value.trim();
  const type = document.getElementById("cardType").value;
  const link = document.getElementById("cardLink").value.trim();
  const start = document.getElementById("cardStart").value;
  const end = document.getElementById("cardEnd").value;
  const html = document.getElementById("cardHtml").value.trim();
  const modalHtml = document.getElementById("modalHtml").value.trim();

  if (!title || !html) return alert("Sarlavha va HTML kerak!");

  const card = { title, type, html };
  if (type === "simple") card.link = link;
  if (type === "timed") { card.link = link; card.start = start; card.end = end; }
  if (type === "modal") card.modalHtml = modalHtml;

  data.cards.push(card);

  document.getElementById("cardTitle").value = "";
  document.getElementById("cardLink").value = "";
  document.getElementById("cardHtml").value = "";
  document.getElementById("modalHtml").value = "";
  render();
}

function delBanner(i) {
  if (confirm("O‚Äòchirishni xohlaysizmi?")) {
    data.banners.splice(i, 1);
    render();
  }
}

function delCard(i) {
  if (confirm("O‚Äòchirishni xohlaysizmi?")) {
    data.cards.splice(i, 1);
    render();
  }
}

function saveJson() {
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "index.json";
  a.click();
  URL.revokeObjectURL(url);
  alert("‚úÖ index.json fayl yuklab olindi! Endi uni sayt papkangizga joylashtiring.");
}

loadJson();
</script>
</body>
</html>
