
<!DOCTYPE html>
<html lang="uz"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>XplusY — Admin (Stable)</title>
<link rel="icon" href="data:,">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
<style>
:root{
  --bg:#f6f9fb; --card:#fff; --ink:#0d1b1e; --muted:#61726f;
  --ring:rgba(16,185,129,.35); --shadow:0 10px 30px rgba(16,185,129,.12);
}
*{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--ink);
  font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans",sans-serif}
.btn{appearance:none;border:1px solid #dbe7e2;background:#fff;color:#0b3b32;padding:10px 14px;border-radius:12px;cursor:pointer;transition:.2s;box-shadow:0 2px 0 #e8f3ef}
.btn:hover{transform:translateY(-1px)}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.hdr{display:flex;align-items:center;justify-content:space-between;gap:12px;margin:16px;padding:14px 16px;background:linear-gradient(135deg,#eafff4,#fff);border:1px solid #e4f4ee;border-radius:16px;box-shadow:var(--shadow)}
.logo{width:44px;height:44px;border-radius:12px;display:grid;place-items:center;background:radial-gradient(circle at 30% 30%,#baf7d8,#8ff0c2 40%,#62e6aa 60%,#43d59a 75%,#2fb180 100%);color:#064e3b;font-weight:900;transform:rotate(-8deg);box-shadow:inset 0 0 0 2px #c7f9e7}
h1{margin:0;font-size:20px} .sub{margin:2px 0 0;color:var(--muted);font-size:13px}
.wrap{display:grid;grid-template-columns:300px 1fr;gap:16px;margin:0 16px 16px}
.card{background:var(--card);border:1px solid #eef3f1;border-radius:16px;padding:16px;box-shadow:var(--shadow)}
.field{display:grid;gap:6px;margin:8px 0} .field>span{font-size:13px;color:var(--muted)}
.field input,.field select,.field textarea{width:100%;padding:10px 12px;border:1px solid #e4eeea;border-radius:12px;background:#fff;outline:none;box-shadow:0 1px 0 #f5fbf9}
.field input:focus,.field select:focus,.field textarea:focus{box-shadow:0 0 0 3px var(--ring);border-color:#bfeedd}
.tabs{display:flex;gap:8px;margin:0 0 12px;flex-wrap:wrap} .tab{padding:10px 14px;border-radius:12px;border:1px solid #e3efea;background:#fff;cursor:pointer}
.tab.active{background:linear-gradient(180deg,#eafff5,#ffffff);border-color:#d1eee3;box-shadow:inset 0 0 0 2px #ccf5e6}
.pane{display:none} .pane.active{display:block}
.list{display:grid;gap:10px} .item{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center;background:#f8fbfa;border:1px solid #ecf3f0;border-radius:12px;padding:10px 12px}
.icbtn{width:36px;height:36px;border-radius:10px;border:1px solid #e7f3ef;background:#fff;display:grid;place-items:center;cursor:pointer}
.stats{list-style:none;margin:0;padding:0;display:grid;gap:8px} .stats li{display:flex;justify-content:space-between;background:#f8fbfa;padding:10px 12px;border-radius:10px}
.small{font-size:12px;color:#6a8880}
</style></head>
<body>
<header class="hdr">
  <div class="row" style="gap:12px">
    <div class="logo">π</div>
    <div><h1>XplusY — Admin (Separate Pages)</h1><p class="sub">home.html • courses.html • simulators.html • tests.html</p></div>
  </div>
  <nav class="row">
    <button id="open-home" class="btn"><i class="fa-solid fa-up-right-from-square"></i> home.html</button>
    <button id="open-courses" class="btn">courses.html</button>
    <button id="open-sims" class="btn">simulators.html</button>
    <button id="open-tests" class="btn">tests.html</button>
    <button id="ex-json" class="btn"><i class="fa-solid fa-file-export"></i> JSON eksport</button>
    <label class="btn"><input type="file" id="im-json" accept="application/json" hidden><span><i class="fa-solid fa-file-import"></i> JSON import</span></label>
    <button id="clear" class="btn"><i class="fa-solid fa-trash"></i> Tozalash</button>
  </nav>
</header>

<main class="wrap">
  <aside class="card">
    <h3 style="margin:0 0 12px 0">Statistika</h3>
    <ul class="stats">
      <li><span>Cardlar</span><strong id="st-count">0</strong></li>
      <li><span>Oxirgi o‘zgarish</span><strong id="st-upd">—</strong></li>
      <li><span>Saqlash</span><strong>LocalStorage</strong></li>
    </ul>
    <p class="small">Muammo bo‘lsa: brauzer keshini tozalang yoki <b>Tozalash</b> tugmasini bosing.</p>
  </aside>

  <section class="card">
    <div class="tabs">
      <button class="tab active" data-id="add">Qo‘shish</button>
      <button class="tab" data-id="manage">Boshqarish</button>
    </div>

    <div id="pane-add" class="pane active">
      <form id="form" class="card" style="margin:0">
        <h3 style="margin:0 0 12px 0">Yangi karta</h3>
        <div class="row" style="gap:12px">
          <label class="field" style="min-width:220px;flex:1 1 220px"><span>Turi</span>
            <select id="f-type">
              <option value="home">Home (katta banner)</option>
              <option value="course">Course</option>
              <option value="sim">Simulator</option>
              <option value="test">Test (online)</option>
            </select>
          </label>
          <label class="field" style="min-width:260px;flex:2 1 300px"><span>Sarlavha</span><input id="f-title" required></label>
          <label class="field" style="min-width:260px;flex:2 1 300px"><span>Tavsif</span><textarea id="f-desc" rows="2"></textarea></label>
          <label class="field" style="min-width:260px;flex:2 1 300px"><span>Rasm URL</span><input id="f-img" placeholder="https://... yoki img/rasm.jpg"></label>
          <label class="field" style="min-width:220px;flex:1 1 220px"><span>Rasm fayli</span><input type="file" id="f-img-file" accept="image/*"></label>
          <label class="field" style="min-width:260px;flex:2 1 300px"><span>Havola</span><input id="f-link" placeholder="courses.html yoki #"></label>
          <label class="field" style="min-width:220px;flex:1 1 220px"><span>Tugma matni</span><input id="f-btn" placeholder="Boshlash"></label>

          <!-- Only for course/sim/test -->
          <label class="field only-nothome" style="min-width:180px;flex:1 1 180px"><span>Narx</span><input type="number" id="f-price" min="0" step="1000" placeholder="0 = FREE"></label>
          <label class="field only-nothome" style="min-width:160px;flex:1 1 160px"><span>Teg</span>
            <select id="f-tag">
              <option value="">—</option><option value="free">FREE</option><option value="pro">PRO</option><option value="new">NEW</option>
            </select>
          </label>
          <label class="field only-nothome" style="min-width:180px;flex:1 1 180px"><span>Bo‘lim</span><input id="f-cat"></label>
          <label class="field only-nothome" style="min-width:160px;flex:1 1 160px"><span>Bo‘lim 2</span><input id="f-cat2"></label>
          <label class="field only-nothome" style="min-width:160px;flex:1 1 160px"><span>Bo‘lim 3</span><input id="f-cat3"></label>
          <label class="field only-sim" style="display:none;min-width:180px;flex:1 1 180px"><span>Sim rejimi</span>
            <select id="f-mode"><option value="oddiy">Oddiy</option><option value="online">Online</option></select>
          </label>
          <label class="field only-test" style="display:none;min-width:220px;flex:1 1 220px"><span>Start (test)</span><input type="datetime-local" id="f-start"></label>
          <label class="field only-test" style="display:none;min-width:220px;flex:1 1 220px"><span>End (test)</span><input type="datetime-local" id="f-end"></label>
          <label class="field" style="min-width:220px;flex:1 1 220px"><span>TAG / ishorat (ixtiyoriy)</span><input id="f-promotag" placeholder="PROMO, AKSIYA..."></label>
        </div>
        <div class="row"><button class="btn" type="submit"><i class="fa-solid fa-plus"></i> Qo‘shish</button></div>
      </form>
    </div>

    <div id="pane-manage" class="pane">
      <div class="card" style="margin:0">
        <h3 style="margin:0 0 12px 0">Mavjud kartalar</h3>
        <div id="list" class="list"></div>
      </div>
    </div>
  </section>
</main>

<footer class="row" style="justify-content:center;padding:18px;color:#57736b">© 2025 XplusY | Admin</footer>

<script>
(function(){
  // Helpers
  function $(s,c){return (c||document).querySelector(s)}
  function $all(s,c){return Array.prototype.slice.call((c||document).querySelectorAll(s));}
  function get(o,k,def){return (o && o[k]!==undefined && o[k]!==null)? o[k] : def;}

  var LS_KEY="xplusy_admin_v3";
  var state={items:[],updatedAt:null};

  // Tabs
  $all('.tab').forEach(function(t){
    t.addEventListener('click', function(){
      $all('.tab').forEach(function(x){x.classList.remove('active')});
      $all('.pane').forEach(function(x){x.classList.remove('active')});
      t.classList.add('active');
      $('#pane-'+t.dataset.id).classList.add('active');
    });
  });

  function load(){
    var raw=localStorage.getItem(LS_KEY);
    if(raw){
      try{ var o=JSON.parse(raw); state.items=o.items||[]; state.updatedAt=o.updatedAt||null; }catch(e){}
    } else {
      state.items=[{"type": "home", "title": "Matematika bo\u2018yicha super kurslar!", "desc": "Yangi mavsumga start! Algebra, Geometriya va Online Testlar \u2014 hammasi bitta joyda.", "image": "https://picsum.photos/seed/promo/1200/600", "link": "courses.html", "button": "Boshlash", "promotag": "PROMO"}, {"type": "course", "title": "Algebra \u2014 Boshlang\u2018ich", "desc": "Qiziqarli misollar bilan", "image": "https://picsum.photos/seed/algebra/800/500", "price": 0, "tag": "free", "cat": "Algebra", "cat2": "9-sinf", "cat3": "Boshlang\u2018ich", "link": "#", "button": "Boshlash"}, {"type": "sim", "title": "Geometriya PRO", "desc": "Yuzalar va hajmlar", "image": "https://picsum.photos/seed/geo/800/500", "price": 59000, "tag": "pro", "cat": "Geometriya", "link": "#", "button": "Ko\u2018rish", "mode": "oddiy"}, {"type": "test", "title": "Trigonometrik test", "desc": "50 savol, 60 daqiqa", "image": "https://picsum.photos/seed/test/800/500", "price": 0, "tag": "new", "cat": "Trigonometriya", "link": "#", "button": "Start", "start": "2025-09-22T18:00", "end": "2025-09-22T20:00"}];
    }
  }
  function save(){
    state.updatedAt=new Date().toISOString();
    localStorage.setItem(LS_KEY, JSON.stringify(state));
    renderList(); stat();
  }
  function stat(){
    $('#st-count').textContent=String(state.items.length);
    $('#st-upd').textContent= state.updatedAt? new Date(state.updatedAt).toLocaleString() : '—';
  }

  function showOnly(){
    var t=$('#f-type').value;
    $all('.only-sim').forEach(function(x){x.style.display = (t==='sim')?'block':'none';});
    $all('.only-test').forEach(function(x){x.style.display = (t==='test')?'block':'none';});
    $all('.only-nothome').forEach(function(x){x.style.display = (t==='home')?'none':'block';});
  }

  function setForm(c){
    $('#f-type').value=get(c,'type','home');
    $('#f-title').value=get(c,'title','');
    $('#f-desc').value=get(c,'desc','');
    $('#f-img').value=get(c,'image','');
    $('#f-link').value=get(c,'link','');
    $('#f-btn').value=get(c,'button','Boshlash');
    $('#f-price').value=get(c,'price','');
    $('#f-tag').value=get(c,'tag','');
    $('#f-cat').value=get(c,'cat','');
    $('#f-cat2').value=get(c,'cat2','');
    $('#f-cat3').value=get(c,'cat3','');
    $('#f-mode').value=get(c,'mode','oddiy');
    $('#f-start').value=get(c,'start','');
    $('#f-end').value=get(c,'end','');
    $('#f-promotag').value=get(c,'promotag','');
    showOnly();
  }

  function fromForm(){
    function v(id){return $('#'+id).value}
    return {
      type: v('f-type'),
      title: v('f-title').trim(),
      desc: v('f-desc').trim(),
      image: v('f-img').trim(),
      link: v('f-link').trim(),
      button: (v('f-btn')||'Boshlash').trim(),
      price: Number(v('f-price')||0),
      tag: v('f-tag'),
      cat: v('f-cat').trim(),
      cat2: v('f-cat2').trim(),
      cat3: v('f-cat3').trim(),
      mode: v('f-mode'),
      start: v('f-start'),
      end: v('f-end'),
      promotag: v('f-promotag').trim()
    };
  }

  function esc(s){return String(s||'').replace(/[&<>"]/g,function(c){return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c];});}

  function renderList(){
    var root=$('#list'); root.innerHTML='';
    state.items.forEach(function(c,i){
      var div=document.createElement('div'); div.className='item';
      var line1 = '<div class="row" style="gap:8px;flex-wrap:wrap"><strong>['+esc(c.type)+']</strong> '+esc(c.title||'—');
      if(c.type==='home' && c.promotag){ line1 += ' <span class="tag">'+esc(c.promotag)+'</span>'; }
      if(c.tag){ line1 += ' <span class="tag">'+esc(String(c.tag).toUpperCase())+'</span>'; }
      if(c.cat){ line1 += ' <span class="tag">'+esc(c.cat)+'</span>'; }
      if(c.cat2){ line1 += ' <span class="tag">'+esc(c.cat2)+'</span>'; }
      if(c.cat3){ line1 += ' <span class="tag">'+esc(c.cat3)+'</span>'; }
      line1 += '</div>';

      var extra = 'Rasm: '+esc(c.image||'—')+' • Link: '+esc(c.link||'—');
      if(c.type!=='home'){ extra += ' • Narx: '+(c.price||0); }
      if(c.type==='sim'){ extra += ' • Rejim: '+esc(c.mode||'oddiy'); }
      if(c.type==='test'){ extra += ' • Start: '+esc(c.start||'—')+' • End: '+esc(c.end||'—'); }

      div.innerHTML = '<div>'+ line1 +
        '<div style="color:#60827b;font-size:13px;margin-top:4px">'+esc(c.desc||'')+'</div>' +
        '<div style="color:#7aa39a;font-size:12px;margin-top:6px">'+ extra +'</div>' +
        '</div>' +
        '<div class="row">' +
          '<button class="icbtn" data-a="edit" data-i="'+i+'"><i class="fa-solid fa-pen-to-square"></i></button>' +
          '<button class="icbtn" data-a="dup" data-i="'+i+'"><i class="fa-solid fa-copy"></i></button>' +
          '<button class="icbtn" data-a="del" data-i="'+i+'"><i class="fa-solid fa-trash"></i></button>' +
        '</div>';
      root.appendChild(div);
    });
  }

  function onList(e){
    var btn=e.target.closest && e.target.closest('[data-a]');
    if(!btn) return;
    var i=Number(btn.dataset.i), a=btn.dataset.a;
    if(a==='edit'){ setForm(state.items[i]); }
    if(a==='dup'){ state.items.splice(i+1,0, JSON.parse(JSON.stringify(state.items[i])) ); save(); }
    if(a==='del'){ if(confirm('O‘chirishni tasdiqlang')){ state.items.splice(i,1); save(); } }
  }

  function exportJSON(){
    var a=document.createElement('a');
    a.href=URL.createObjectURL(new Blob([JSON.stringify(state,null,2)],{type:'application/json'}));
    a.download='xplusy_data.json'; a.click();
    setTimeout(function(){URL.revokeObjectURL(a.href)},3000);
  }
  function importJSON(file){
    var fr=new FileReader();
    fr.onload=function(){
      try{ var o=JSON.parse(fr.result); state.items=o.items||o.cards||[]; save(); alert('Import ok'); }
      catch(e){ alert('JSON xato'); }
    };
    fr.readAsText(file);
  }

  function init(){
    load(); stat(); renderList(); setForm({});
    $('#f-type').addEventListener('change', showOnly);
    $('#form').addEventListener('submit', function(e){ e.preventDefault(); var obj=fromForm(); if(!obj.title){ alert('Sarlavha shart'); return; } state.items.push(obj); save(); alert('Qo‘shildi'); });
    $('#list').addEventListener('click', onList);
    $('#ex-json').addEventListener('click', exportJSON);
    $('#im-json').addEventListener('change', function(e){ if(e.target.files[0]) importJSON(e.target.files[0]); });
    $('#clear').addEventListener('click', function(){ if(confirm('Tozalansinmi?')){ localStorage.removeItem(LS_KEY); location.reload(); } });
    // Open viewers
    $('#open-home').onclick=function(){ window.open('home.html','_blank'); };
    $('#open-courses').onclick=function(){ window.open('courses.html','_blank'); };
    $('#open-sims').onclick=function(){ window.open('simulators.html','_blank'); };
    $('#open-tests').onclick=function(){ window.open('tests.html','_blank'); };
    // Image file -> data URL
    $('#f-img-file').addEventListener('change', function(e){
      var f=e.target.files && e.target.files[0]; if(!f) return;
      var fr=new FileReader(); fr.onload=function(){ $('#f-img').value=fr.result; alert('Rasm data: URL o‘rnatildi.'); }; fr.readAsDataURL(f);
    });
  }
  document.addEventListener('DOMContentLoaded', init);
})();</script>
</body></html>
