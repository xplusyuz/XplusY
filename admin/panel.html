<!doctype html>
<html lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OrzuMall Admin — Panel</title>
  <link rel="stylesheet" href="./assets/admin.css" />
</head>
<body style="display:none;">
  <div class="wrap">
    <aside class="sidebar">
      <div class="brand">
        <div class="mark"></div>
        <div>
          <h1>OrzuMall Admin</h1>
          <p>Secure dashboard</p>
        </div>
      </div>

      <div class="nav">
        <button data-tab="overview" class="active"><span>Overview</span><span class="badge" id="bOverview">•</span></button>
        <button data-tab="products"><span>Mahsulotlar</span><span class="badge" id="bProducts">0</span></button>
        <button data-tab="orders"><span>Buyurtmalar</span><span class="badge" id="bOrders">0</span></button>
        <button data-tab="users"><span>Foydalanuvchilar</span><span class="badge" id="bUsers">0</span></button>
        <button data-tab="settings"><span>Sozlamalar</span><span class="badge">⚙</span></button>
      </div>

      <div class="bottom">
        <button class="btn gold" id="goSite">Saytga o‘tish</button>
        <button class="btn danger" id="logout">Chiqish</button>
      </div>
    </aside>

    <main class="main">
      <div class="topbar">
        <div class="title">
          <h2 id="pageTitle">Overview</h2>
          <p id="pageSub">Admin gmail tasdiqlangan. Ma’lumotlar faqat admin uchun.</p>
        </div>
        <div class="userchip">
          <div class="avatar">A</div>
          <div>
            <div style="font-size:13px;font-weight:700" id="adminEmail">—</div>
            <div style="font-size:12px;color:var(--muted)">Secure</div>
          </div>
        </div>
      </div>

      <!-- OVERVIEW -->
      <section id="tab-overview">
        <div class="grid">
          <div class="card kpi">
            <div class="hd"><h3>Mahsulotlar</h3><span class="badge">live</span></div>
            <div class="bd"><div class="num" id="kProducts">—</div><div class="lab">collection: products</div></div>
          </div>
          <div class="card kpi">
            <div class="hd"><h3>Buyurtmalar</h3><span class="badge">live</span></div>
            <div class="bd"><div class="num" id="kOrders">—</div><div class="lab">collection: orders</div></div>
          </div>
          <div class="card kpi">
            <div class="hd"><h3>Foydalanuvchilar</h3><span class="badge">live</span></div>
            <div class="bd"><div class="num" id="kUsers">—</div><div class="lab">collection: users</div></div>
          </div>
          <div class="card kpi">
            <div class="hd"><h3>Xavfsizlik</h3><span class="badge">OK</span></div>
            <div class="bd"><div class="num">100%</div><div class="lab">admin-only access</div></div>
          </div>

          <div class="card panel">
            <div class="hd"><h3>Tezkor eslatma</h3><span class="badge">rules</span></div>
            <div class="bd">
              <div class="note">
                • Admin sahifa foydalanuvchilarga ko‘rinmaydi (auth + email guard).<br/>
                • Firestore’da write faqat admin (rules bilan).<br/>
                • Panelda: mahsulot CRUD + buyurtma ko‘rish + user ro‘yxat (read-only).<br/>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- PRODUCTS -->
      <section id="tab-products" class="hidden">
        <div class="card">
          <div class="hd">
            <h3>Mahsulotlar</h3>
            <div class="row-actions">
              <button class="btn small gold" id="btnNewProduct">+ Yangi mahsulot</button>
              <button class="btn small" id="btnReloadProducts">Yangilash</button>
            </div>
          </div>
          <div class="bd">
            <div class="note">Eslatma: rasm URL larni yozing (Storage public URL bo‘lsa yaxshi). Tags — vergul bilan.</div>
            <hr class="sep"/>
            <div style="overflow:auto">
              <table class="table" id="productsTable">
                <thead>
                  <tr>
                    <th>Title</th><th>Price</th><th>Old</th><th>Category</th><th>Tags</th><th>Actions</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>

        <div class="card" style="margin-top:14px">
          <div class="hd"><h3 id="prodFormTitle">Mahsulot qo‘shish / tahrirlash</h3><span class="badge" id="prodFormBadge">new</span></div>
          <div class="bd">
            <form id="productForm" class="form">
              <input type="hidden" id="pid" />
              <div class="field full">
                <label>Title</label>
                <input id="ptitle" placeholder="Masalan: iPhone 14 Pro Max" required />
              </div>
              <div class="field">
                <label>Price (son)</label>
                <input id="pprice" type="number" min="0" step="1" placeholder="12000000" required />
              </div>
              <div class="field">
                <label>Old Price (ixtiyoriy)</label>
                <input id="pold" type="number" min="0" step="1" placeholder="13000000" />
              </div>
              <div class="field">
                <label>Category</label>
                <input id="pcat" placeholder="telefonlar" />
              </div>
              <div class="field">
                <label>Tags (vergul bilan)</label>
                <input id="ptags" placeholder="premium, new, sale" />
              </div>
              <div class="field full">
                <label>Images (URL lar, har qatorda bitta)</label>
                <textarea id="pimgs" placeholder="https://.../1.jpg&#10;https://.../2.jpg"></textarea>
              </div>
              <div class="field full">
                <label>Description (ixtiyoriy)</label>
                <textarea id="pdesc" placeholder="Qisqacha tavsif..."></textarea>
              </div>
              <div class="field full" style="display:flex; gap:10px; flex-wrap:wrap">
                <button class="btn gold" type="submit">Saqlash</button>
                <button class="btn" type="button" id="btnClearForm">Tozalash</button>
                <button class="btn danger" type="button" id="btnDeleteProduct" style="display:none">O‘chirish</button>
              </div>
            </form>
          </div>
        </div>
      </section>

      <!-- ORDERS -->
      <section id="tab-orders" class="hidden">
        <div class="card">
          <div class="hd">
            <h3>Buyurtmalar (read-only)</h3>
            <div class="row-actions">
              <button class="btn small" id="btnReloadOrders">Yangilash</button>
            </div>
          </div>
          <div class="bd">
            <div style="overflow:auto">
              <table class="table" id="ordersTable">
                <thead>
                  <tr>
                    <th>ID</th><th>User</th><th>Total</th><th>Status</th><th>Created</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
      </section>

      <!-- USERS -->
      <section id="tab-users" class="hidden">
        <div class="card">
          <div class="hd">
            <h3>Foydalanuvchilar (read-only)</h3>
            <div class="row-actions">
              <button class="btn small" id="btnReloadUsers">Yangilash</button>
            </div>
          </div>
          <div class="bd">
            <div style="overflow:auto">
              <table class="table" id="usersTable">
                <thead>
                  <tr>
                    <th>UID</th><th>Name</th><th>Phone</th><th>Role</th><th>Created</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
      </section>

      <!-- SETTINGS -->
      <section id="tab-settings" class="hidden">
        <div class="card">
          <div class="hd"><h3>Sozlamalar</h3><span class="badge">security</span></div>
          <div class="bd">
            <div class="note">
              <b>Admin Email:</b> sohibjonmath@gmail.com<br/>
              <b>Qoidalar:</b> Firestore’da write faqat admin bo‘lishi shart.<br/><br/>
              <b>Deployment:</b> Netlify’da <code>/admin/login.html</code> orqali kirasiz.
            </div>
            <hr class="sep"/>
            <button class="btn" id="openRules">Firestore Rules faylini ochish (zip ichida)</button>
          </div>
        </div>
      </section>

      <div class="toast" id="toast"><span id="toastTxt"></span></div>

      <script type="module" src="./assets/admin.js"></script>
    </main>
  </div>
</body>
</html>
