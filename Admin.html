<!doctype html>
<html lang="uz">
<head>
  <meta charset="utf-8">
  <title>Admin Panel - Balans boshqarish</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; }
    #panel { display: none; margin-top: 20px; }
  </style>
</head>
<body>
  <h2>üîê Admin Panel</h2>

  <div id="loginBox">
    <p>Parolni kiriting:</p>
    <input type="password" id="adminPass">
    <button onclick="checkPassword()">Kirish</button>
    <p id="error" style="color:red;"></p>
  </div>

  <div id="panel">
    <form id="updateForm">
      <label>Foydalanuvchi ID: </label><br>
      <input type="text" id="userId" required><br><br>

      <label>Yangi balans: </label><br>
      <input type="number" id="newBalance" required><br><br>

      <button type="submit">Yangilash</button>
    </form>

    <div id="result"></div>
  </div>

  <script>
    const ADMIN_PASSWORD = "your-secret-password"; // **O'zingiz yozing**
    const apiUrl = "https://script.google.com/macros/s/AKfycbzvzLP7aVpALMvrqaXxVLYX_Vn4IBrIU9k-pQwDeLP-TOGp5M4_AdCURJClCtN6jo3P/exec";

    function checkPassword() {
      let inputPass = document.getElementById("adminPass").value;
      if (inputPass === ADMIN_PASSWORD) {
        document.getElementById("loginBox").style.display = "none";
        document.getElementById("panel").style.display = "block";
      } else {
        document.getElementById("error").innerText = "‚ùå Noto‚Äòg‚Äòri parol!";
      }
    }

    document.getElementById("updateForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      let userId = document.getElementById("userId").value;
      let newBalance = document.getElementById("newBalance").value;

      let response = await fetch(apiUrl, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          id: userId,
          action: "update_balance",
          balance: newBalance
        })
      });

      let data = await response.json();

      document.getElementById("result").innerHTML =
        `<p>‚úÖ Balans yangilandi: <b>${data.balans} so ªm</b></p>`;
    });
  </script>
</body>
</html>
