<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<title>Buyurtma</title>
<style>
input,textarea,button{width:100%;margin-top:10px;padding:10px}
button{background:#2563eb;color:#fff;border:none;border-radius:8px}
</style>
</head>
<body>

<h2>üì¶ Buyurtma berish</h2>

<input id="name" placeholder="Ism Familiya">
<input id="phone" placeholder="Telefon raqam">
<textarea id="address" placeholder="Manzil"></textarea>

<button onclick="submitOrder()">Buyurtma berish</button>

<script>
async function submitOrder(){
  const order = {
    telegram_id: Telegram.WebApp?.initDataUnsafe?.user?.id || 0,
    name: name.value,
    phone: phone.value,
    address: address.value,
    items: JSON.parse(localStorage.getItem("cart")||"[]")
  };

  if(!order.name || !order.phone || !order.address){
    alert("‚ùó Hamma maydonlarni to‚Äòldiring");
    return;
  }

  await fetch("/.netlify/functions/createOrder",{
    method:"POST",
    body:JSON.stringify(order)
  });

  alert("‚úÖ Buyurtma yuborildi");
  localStorage.removeItem("cart");
}
</script>
</body>
</html>
