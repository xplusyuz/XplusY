<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Admin ‚Ä¢ Home (Ultra Stable)</title>
<style>
  :root{--g:#10b981;--b:#0ea5e9;--line:#e5e7eb;--mut:#64748b}
  *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;background:#f6fbf9}
  .wrap{max-width:1080px;margin:auto;padding:16px}
  .card{background:#fff;border:1px solid var(--line);border-radius:18px;box-shadow:0 8px 22px rgba(2,6,23,.06)}
  .btn{display:inline-block;padding:10px 14px;border:1px solid var(--line);border-radius:14px;background:#fff;font-weight:700;cursor:pointer}
  .btn:active{transform:translateY(1px)}
  .btn.p{background:linear-gradient(135deg,var(--g),var(--b));border:0;color:#fff}
  .btn.mini{padding:8px 10px;border-radius:12px}
  .input{width:100%;padding:10px 12px;border:1px solid var(--line);border-radius:12px}
  .muted{color:var(--mut);font-size:12px}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .hero{position:relative;overflow:hidden;border-radius:22px}
  .hero img{width:100%;height:300px;object-fit:cover;display:block}
  .hero .layer{position:absolute;inset:0;background:linear-gradient(0deg,rgba(0,0,0,.6),rgba(0,0,0,.25),transparent)}
  .hero .txt{position:absolute;left:16px;right:16px;bottom:16px;color:#fff}
  .tag{font-size:12px;background:#d1fae5;color:#065f46;border-radius:999px;padding:3px 9px;font-weight:800;letter-spacing:.02em}
  .price{font-size:12px;background:#e0f2fe;color:#075985;border-radius:999px;padding:3px 9px;font-weight:800}
  .badge{position:absolute;top:10px;left:10px}
  .badgeR{position:absolute;top:10px;right:10px}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px;margin-top:14px}
  /* Modal */
  #ov{position:fixed;inset:0;background:rgba(2,6,23,.55);display:none;align-items:center;justify-content:center;padding:16px;z-index:50}
  #modal{background:#fff;border:1px solid var(--line);border-radius:18px;max-width:760px;width:100%;padding:14px}
</style>
</head>
<body>
<!-- LOGIN -->
<div id="login" class="wrap" style="min-height:100vh;display:grid;place-items:center">
  <div class="card" style="padding:16px;max-width:460px;width:100%">
    <div class="row">
      <div style="width:48px;height:48px;border-radius:14px;background:linear-gradient(135deg,#10b981,#059669);display:grid;place-items:center;color:#fff;font-weight:900">œÄ</div>
      <div><div style="font-weight:900">Admin ‚Ä¢ Home (Ultra)</div><div class="muted">Xavfsiz kirish</div></div>
    </div>
    <div style="margin-top:10px">
      <div class="muted">Login</div>
      <input id="L" class="input" placeholder="Login">
    </div>
    <div style="margin-top:8px">
      <div class="muted">Parol</div>
      <input id="P" type="password" class="input" placeholder="Parol">
      <label class="muted" style="display:flex;gap:6px;align-items:center;margin-top:6px">
        <input type="checkbox" id="show" onclick="P.type=this.checked?'text':'password'"> Parolni ko‚Äòrsatish
      </label>
    </div>
    <div style="margin-top:10px">
      <button class="btn p" onclick="doLogin();return false;">Kirish</button>
    </div>
    <div class="muted" style="margin-top:6px">Variantlar: <b>Math@1999 / Math@1999</b> ‚Ä¢ <b>admin / Math@1999</b> ‚Ä¢ <b>1999 / 1999</b></div>
  </div>
</div>

<!-- APP -->
<div id="app" class="wrap" style="display:none">
  <div class="row" style="justify-content:space-between">
    <div class="row"><div style="width:44px;height:44px;border-radius:12px;background:linear-gradient(135deg,#10b981,#0ea5e9);display:grid;place-items:center;color:#fff;font-weight:900">œÄ</div><div><div style="font-weight:900">Katta reklama bannerlari</div><div class="muted">FREE/PRO teg, narx, havola</div></div></div>
    <div class="row">
      <button class="btn p" onclick="openModal();return false;">‚ûï Banner</button>
      <button class="btn" onclick="downloadHtml();return false;">üíæ home.html</button>
    </div>
  </div>

  <div class="hero card" style="margin-top:12px">
    <img id="hImg" alt="">
    <div class="layer"></div>
    <div class="txt">
      <span id="hTag" class="tag">BANNER</span>
      <div id="hTitle" style="font-size:26px;font-weight:900;margin-top:6px">Sarlavha</div>
      <div id="hSub" class="muted" style="color:#e2e8f0">Qisqa ta‚Äôrif</div>
      <div class="row" style="margin-top:10px">
        <a id="hA" class="btn p" target="_blank">‚ñ∂ Boshlash</a>
        <a id="hB" class="btn" target="_blank">‚Ñπ Batafsil</a>
      </div>
    </div>
  </div>

  <div id="list" class="grid"></div>
</div>

<!-- Modal -->
<div id="ov"><div id="modal">
  <div class="row" style="justify-content:space-between">
    <div style="font-weight:900">Banner</div>
    <button class="btn mini" onclick="closeModal();return false;">‚úñ</button>
  </div>
  <div class="row" style="margin-top:8px">
    <div style="flex:1;min-width:220px"><div class="muted">Sarlavha</div><input id="tTitle" class="input" placeholder="Algebra marafoni"></div>
    <div style="flex:1;min-width:220px"><div class="muted">Qisqa ta‚Äôrif</div><input id="tSub" class="input" placeholder="Qisqa izoh"></div>
    <div style="flex:1;min-width:220px"><div class="muted">Rasm URL</div><input id="tImg" class="input" placeholder="https://..."></div>
    <div style="flex:1;min-width:220px"><div class="muted">Havola</div><input id="tHref" class="input" placeholder="https://..."></div>
    <div style="flex:1;min-width:140px"><div class="muted">Narx (0 = FREE)</div><input id="tPrice" class="input" type="number" min="0" value="0"></div>
    <div style="flex:1;min-width:140px"><div class="muted">Yorliq</div>
      <select id="tTag" class="input"><option>FREE</option><option>PRO</option><option>YANGI</option></select>
    </div>
  </div>
  <div class="row" style="justify-content:flex-end;margin-top:10px">
    <button id="delBtn" class="btn mini" style="display:none" onclick="delBanner();return false;">üóë O‚Äòchirish</button>
    <button class="btn p" onclick="saveBanner();return false;">üíæ Saqlash</button>
  </div>
</div></div>

<script id="embedded" type="application/json">[]</script>
<script>
// ===== GLOBAL STATE =====
var banners = [];
var editIdx = null;

// ===== SIMPLE HELPERS =====
function $(id){ return document.getElementById(id) }
function show(el, on){ el.style.display = on ? 'flex' : 'none' }
function save(){ try{ localStorage.setItem('home.banners', JSON.stringify(banners)) }catch(e){} }
function load(){
  try{ banners = JSON.parse(localStorage.getItem('home.banners')||'[]') || [] }catch(e){ banners=[] }
  if(!banners.length){
    banners = [{title:'Matematika BOOM 2025', subtitle:'Algebra + Geometriya', image:'https://images.unsplash.com/photo-1522202176988-66273c2fd55f?q=80&w=1600&auto=format&fit=crop', link:'#', price:0, tag:'YANGI'}];
  }
}
function render(){
  var h = banners[0] || {};
  $('hImg').src = h.image || '';
  $('hTag').textContent = h.tag || (h.price>0 ? 'PRO' : 'FREE');
  $('hTitle').textContent = h.title || '';
  $('hSub').textContent = h.subtitle || '';
  $('hA').href = h.link || '#'; $('hB').href = h.link || '#';

  var html = '';
  for(var i=0;i<banners.length;i++){
    var b = banners[i];
    html += '<div class="card" style="padding:10px;position:relative">'+
      '<div style="position:relative;border-radius:14px;overflow:hidden">'+
      '<img src="'+(b.image||'')+'" style="width:100%;height:150px;object-fit:cover">'+
      '<span class="tag badge">'+(b.tag||(b.price>0?'PRO':'FREE'))+'</span>'+
      '<span class="price badgeR">'+((b.price&&b.price>0)?(b.price+' so‚Äòm'):'0 so‚Äòm')+'</span>'+
      '</div>'+
      '<div style="font-weight:900;margin-top:6px">'+(b.title||'')+'</div>'+
      '<div class="muted">'+(b.subtitle||'')+'</div>'+
      '<div class="row" style="margin-top:8px">'+
      '<a class="btn p" target="_blank" href="'+(b.link||'#')+'">‚û° Boshlash</a>'+
      '<button class="btn" onclick="edit('+i+');return false;">‚úè Tahrirlash</button>'+
      '</div></div>';
  }
  $('list').innerHTML = html;
}

// ===== MODAL CRUD =====
function openModal(){ editIdx=null; $('delBtn').style.display='none';
  $('tTitle').value=''; $('tSub').value=''; $('tImg').value=''; $('tHref').value=''; $('tPrice').value=0; $('tTag').value='FREE';
  show($('ov'), true);
}
function closeModal(){ show($('ov'), false) }
function edit(i){ editIdx=i; var b=banners[i];
  $('tTitle').value=b.title||''; $('tSub').value=b.subtitle||''; $('tImg').value=b.image||''; $('tHref').value=b.link||'';
  $('tPrice').value=b.price||0; $('tTag').value=b.tag||(b.price>0?'PRO':'FREE');
  $('delBtn').style.display='inline-block'; show($('ov'), true);
}
function delBanner(){ if(editIdx==null) return; if(confirm('O‚Äòchirish?')){ banners.splice(editIdx,1); save(); render(); closeModal(); } }
function saveBanner(){
  var d={ title:$('tTitle').value.trim(), subtitle:$('tSub').value.trim(), image:$('tImg').value.trim(),
          link:$('tHref').value.trim(), price:Number($('tPrice').value||0), tag:$('tTag').value };
  if(!d.title || !d.image){ alert('Sarlavha va Rasm URL majburiy.'); return }
  if(editIdx==null) banners.unshift(d); else banners[editIdx]=d;
  save(); render(); closeModal();
}

// ===== LOGIN =====
function doLogin(){
  var L=$('L').value.trim(), P=$('P').value.trim();
  var ok=(L==='Math@1999'&&P==='Math@1999')||(L.toLowerCase()==='admin'&&P==='Math@1999')||(L==='1999'&&P==='1999');
  if(ok){ $('login').style.display='none'; $('app').style.display='block'; } else { alert('Login/parol noto‚Äòg‚Äòri'); }
}

// ===== DOWNLOAD (NO CLONE) =====
function downloadHtml(){
  var payload = JSON.stringify(banners);
  var html = '<!DOCTYPE html>\\n'+
'<!-- Generated by Ultra Stable Admin Home -->\\n'+
'<html lang="uz"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">'+
'<title>home.html</title></head><body>'+
'<script id="embedded" type="application/json">'+payload.replace(/</g,'\\u003c')+'</script>'+
'<script>(function(){try{var emb=document.getElementById("embedded");var arr=JSON.parse(emb.textContent||"[]")||[];localStorage.setItem("home.banners", JSON.stringify(arr));}catch(e){};location.href=location.href.split("#")[0].split("?")[0];})();<\/script>'+
'</body></html>';
  try{
    var blob = new Blob([html], {type:'text/html;charset=utf-8'});
    if(navigator.msSaveBlob){ navigator.msSaveBlob(blob, 'home.html'); return; }
    var a=document.createElement('a'); a.download='home.html'; a.href=URL.createObjectURL(blob); document.body.appendChild(a); a.click(); setTimeout(function(){ URL.revokeObjectURL(a.href); a.remove(); }, 1500);
  }catch(e){
    var data='data:text/html;charset=utf-8,'+encodeURIComponent(html);
    var a=document.createElement('a'); a.href=data; a.download='home.html'; document.body.appendChild(a); a.click(); setTimeout(function(){ a.remove(); }, 800);
  }
}

// ===== INIT =====
(function(){
  // load embedded if present
  try{ var emb=$('embedded'); if(emb){ var arr=JSON.parse(emb.textContent||'[]'); if(Array.isArray(arr)&&arr.length){ banners=arr; } } }catch(e){}
  if(!banners.length){ load(); }
  save(); render();
  // autologin if asked
  var u=location.search+location.hash; if(u.indexOf('autologin=1')>-1 || /#autologin\\b/.test(u)){ $('L').value='admin'; $('P').value='Math@1999'; doLogin(); }
})();</script>
</body>
</html>
