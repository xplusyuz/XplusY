<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Admin • Home (Premium 3D Granite)</title>
<style>
  :root{
    --g1:#10b981; --g2:#34d399; --g3:#a7f3d0;
    --d1:#0ea5e9;
    --bg1:#f7fff9; --bg2:#ecfdf5;
    --ink:#0f172a; --mut:#64748b; --line:#e5e7eb;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background:
      radial-gradient(1200px 600px at -10% -10%, rgba(16,185,129,.28), transparent 60%),
      radial-gradient(1000px 700px at 110% 10%, rgba(14,165,233,.25), transparent 65%),
      linear-gradient(180deg, var(--bg1), var(--bg2));
    color:var(--ink);
  }
  .wrap{max-width:1120px;margin:auto;padding:16px}
  .glass{backdrop-filter: blur(16px); background: linear-gradient(180deg, rgba(255,255,255,.82), rgba(255,255,255,.68)); border:1px solid rgba(255,255,255,.6)}
  .card{background:#fff;border:1px solid var(--line);border-radius:22px;box-shadow:0 10px 35px rgba(16,185,129,.12), 0 20px 50px rgba(2,6,23,.06)}
  .g3d{position:relative; isolation:isolate; border-radius:24px}
  .g3d::before{content:""; position:absolute; inset:-2px; z-index:-1; border-radius:inherit;
    background: conic-gradient(from 180deg at 50% 50%, #10b981, #06b6d4, #a78bfa, #10b981);
    filter: blur(18px); opacity:.4; transition:.3s}
  .g3d:hover::before{opacity:.75; filter:blur(12px)}
  .btn{display:inline-grid; place-items:center; gap:.55rem; grid-auto-flow:column; padding:10px 14px; border-radius:16px; border:1px solid var(--line); background:#fff; font-weight:700; cursor:pointer; user-select:none; transition:.18s ease}
  .btn:active{transform:translateY(1px)}
  .btn.p{background:linear-gradient(135deg, var(--g1), var(--d1)); color:#fff; border:0; box-shadow:0 14px 36px rgba(16,185,129,.35)}
  .btn.gh{background:transparent; color:#fff; border:1px solid rgba(255,255,255,.7)}
  .btn.mini{padding:8px 10px;border-radius:14px;font-weight:600}
  .input{width:100%; padding:11px 12px; border:1px solid var(--line); border-radius:14px; background:#fff; outline:none}
  .input:focus{box-shadow:0 0 0 3px rgba(16,185,129,.25); border-color:#10b981}
  .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
  .muted{color:var(--mut); font-size:13px}
  .tag{font-size:12px;background:#d1fae5;color:#065f46;border-radius:999px;padding:4px 10px;font-weight:800;letter-spacing:.02em}
  .price{font-size:12px;background:#e0f2fe;color:#075985;border-radius:999px;padding:4px 10px;font-weight:800}
  .badge{position:absolute;top:10px;left:10px}
  .badgeR{position:absolute;top:10px;right:10px}
  .hero{position:relative;overflow:hidden;border-radius:28px}
  .hero img{width:100%;height:320px;object-fit:cover;display:block;filter:saturate(1.05)}
  .hero .layer{position:absolute;inset:0;background:linear-gradient(0deg, rgba(0,0,0,.6), rgba(0,0,0,.2) 50%, rgba(0,0,0,0))}
  .hero .text{position:absolute;left:20px;right:20px;bottom:18px;color:#fff;text-shadow:0 2px 18px rgba(0,0,0,.5)}
  .title{font-size:22px;font-weight:900;letter-spacing:.01em}
  .title.xl{font-size:30px}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(270px,1fr));gap:16px}
  .toolbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}
  @media(min-width:860px){ .title.xl{font-size:40px} }

  /* FLOATING QUICK MENU (draggable) */
  .float{position:fixed; right:16px; bottom:16px; z-index:50; width:64px; height:64px; border-radius:20px;
    background:linear-gradient(135deg, var(--g1), var(--d1)); color:#fff; display:grid; place-items:center;
    box-shadow:0 22px 60px rgba(16,185,129,.45), 0 10px 30px rgba(2,6,23,.25); cursor:grab; user-select:none}
  .float:active{cursor:grabbing}
  .float .dot{font-size:26px; font-weight:900}
  .fabMenu{position:absolute; right:72px; bottom:0; display:flex; gap:10px}
  .fabMenu .btn{backdrop-filter:blur(10px)}
  .fabMenu .btn.p{box-shadow:0 10px 26px rgba(16,185,129,.35)}

  /* LOGIN */
  .loginWrap{min-height:100vh; display:grid; place-items:center; padding:18px}
  .loginCard{max-width:460px; width:100%; border-radius:28px; padding:16px}
  .brand{width:54px; height:54px; border-radius:16px; background:linear-gradient(135deg, var(--g1), #059669);
    color:#fff; display:grid; place-items:center; font-weight:900; font-size:24px; box-shadow:0 12px 30px rgba(16,185,129,.35)}
  .hint{font-size:12px; color:#475569}
</style>
</head>
<body>
<!-- LOGIN -->
<section id="login" class="loginWrap">
  <div class="loginCard glass g3d">
    <div class="row">
      <div class="brand">π</div>
      <div>
        <div class="title">Admin • Home (Premium)</div>
        <div class="muted">Xavfsiz kirish</div>
      </div>
    </div>

    <div class="row" style="margin-top:12px">
      <div style="flex:1;min-width:200px">
        <div class="muted">Login</div>
        <input id="L" class="input" placeholder="Login">
      </div>
      <div style="flex:1;min-width:200px">
        <div class="muted">Parol</div>
        <input id="P" type="password" class="input" placeholder="Parol">
        <div class="row" style="margin-top:6px">
          <label class="muted" style="display:flex;align-items:center;gap:6px">
            <input type="checkbox" id="show"> Parolni ko‘rsatish
          </label>
          <div id="caps" class="muted" style="margin-left:auto;display:none;color:#b45309">Caps Lock yoqilgan</div>
        </div>
      </div>
    </div>
    <div class="row" style="margin-top:12px; justify-content:space-between">
      <div class="hint">Kirish: <b>Math@1999 / Math@1999</b> • <b>admin / Math@1999</b> • <b>1999 / 1999</b></div>
      <button id="go" class="btn p">Kirish</button>
    </div>
  </div>
</section>

<!-- APP -->
<main id="app" class="wrap" style="display:none">
  <div class="toolbar">
    <div class="row">
      <div class="brand">π</div>
      <div>
        <div class="title">Katta reklama bannerlari</div>
        <div class="muted">FREE/PRO teglari, narx, havola — hammasi bir joyda</div>
      </div>
    </div>
    <div class="row">
      <button class="btn p" onclick="openModal()">➕ Banner</button>
      <button class="btn" onclick="downloadHtml()">💾 home.html</button>
    </div>
  </div>

  <!-- HERO -->
  <section class="hero g3d card">
    <img id="hImg" alt="">
    <div class="layer"></div>
    <div class="text">
      <span id="hTag" class="tag">BANNER</span>
      <div id="hTitle" class="title xl" style="margin-top:8px">Sarlavha</div>
      <div id="hSub" class="muted" style="color:#e2e8f0">Qisqa ta’rif</div>
      <div class="row" style="margin-top:12px">
        <a id="hA" class="btn p" target="_blank">▶ Boshlash</a>
        <a id="hB" class="btn gh" target="_blank">ℹ Batafsil</a>
      </div>
    </div>
  </section>

  <!-- LIST -->
  <section id="list" class="grid" style="margin-top:16px"></section>
</main>

<!-- MODAL (glass) -->
<div id="ov" style="position:fixed;inset:0;background:rgba(2,6,23,.55);display:none;align-items:center;justify-content:center;padding:16px;z-index:40">
  <div class="glass card" style="max-width:780px;width:100%;padding:16px;border-radius:26px">
    <div class="row" style="justify-content:space-between">
      <div class="title">Banner</div>
      <button class="btn mini" onclick="closeModal()">✖</button>
    </div>
    <div class="row" style="margin-top:10px">
      <div style="flex:1;min-width:220px"><div class="muted">Sarlavha</div><input id="tTitle" class="input" placeholder="Masalan: Algebra marafoni"></div>
      <div style="flex:1;min-width:220px"><div class="muted">Qisqa ta’rif</div><input id="tSub" class="input" placeholder="Qisqa izoh"></div>
      <div style="flex:1;min-width:220px"><div class="muted">Rasm URL</div><input id="tImg" class="input" placeholder="https://..."></div>
      <div style="flex:1;min-width:220px"><div class="muted">Havola</div><input id="tHref" class="input" placeholder="https://..."></div>
      <div style="flex:1;min-width:140px"><div class="muted">Narx (0 = FREE)</div><input id="tPrice" class="input" type="number" min="0" value="0"></div>
      <div style="flex:1;min-width:140px"><div class="muted">Yorliq</div>
        <select id="tTag" class="input">
          <option>FREE</option><option>PRO</option><option>YANGI</option>
        </select>
      </div>
    </div>
    <div class="row" style="justify-content:flex-end;margin-top:12px">
      <button id="delBtn" class="btn mini" style="display:none" onclick="delBanner()">🗑 O‘chirish</button>
      <button class="btn p" onclick="saveBanner()">💾 Saqlash</button>
    </div>
  </div>
</div>

<!-- FLOATING QUICK MENU -->
<div id="fab" class="float" title="Tez menyu">
  <div class="dot">⋯</div>
  <div class="fabMenu" style="display:none">
    <button class="btn p mini" onclick="openModal()">➕ Banner</button>
    <button class="btn mini" onclick="downloadHtml()">💾 Saqlash</button>
  </div>
</div>

<script>
// ======== CORE STATE ========
var $ = function(id){ return document.getElementById(id) };
var banners = [];
var editIdx = null;

// ======== SEED / RENDER ========
function seed(){
  try{ banners = JSON.parse(localStorage.getItem('home.banners')||'[]') || [] }catch(e){ banners=[] }
  if(!banners.length){
    banners=[{title:'Matematika BOOM 2025',subtitle:'Algebra + Geometriya',
      image:'https://images.unsplash.com/photo-1522202176988-66273c2fd55f?q=80&w=1600&auto=format&fit=crop',
      link:'#',price:0,tag:'YANGI'}];
  }
  save(); render();
}
function save(){ localStorage.setItem('home.banners', JSON.stringify(banners)) }
function render(){
  // hero
  var h=banners[0] || {};
  $('hImg').src = h.image || '';
  $('hTag').textContent = h.tag || (h.price>0?'PRO':'FREE');
  $('hTitle').textContent = h.title || '';
  $('hSub').textContent = h.subtitle || '';
  $('hA').href = h.link || '#'; $('hB').href = h.link || '#';

  // cards
  var html='';
  for(var i=0;i<banners.length;i++){
    var b=banners[i];
    html+= '<div class="card g3d" style="padding:12px; position:relative">'+
      '<div style="position:relative;border-radius:18px;overflow:hidden">'+
        '<img src="'+(b.image||'')+'" style="width:100%;height:160px;object-fit:cover">'+
        '<span class="tag badge">'+(b.tag || (b.price>0?'PRO':'FREE'))+'</span>'+
        '<span class="price badgeR">'+((b.price&&b.price>0)?(b.price+' so‘m'):'0 so‘m')+'</span>'+
      '</div>'+
      '<div class="title" style="margin-top:8px;font-size:18px">'+(b.title||'')+'</div>'+
      '<div class="muted">'+(b.subtitle||'')+'</div>'+
      '<div class="row" style="margin-top:10px">'+
        '<a class="btn p" target="_blank" href="'+(b.link||'#')+'">➡ Boshlash</a>'+
        '<button class="btn" onclick="edit('+i+')">✏ Tahrirlash</button>'+
      '</div>'+
    '</div>';
  }
  $('list').innerHTML = html;
}

// ======== MODAL CRUD ========
function openModal(){ editIdx=null; $('delBtn').style.display='none';
  $('tTitle').value=''; $('tSub').value=''; $('tImg').value=''; $('tHref').value=''; $('tPrice').value=0; $('tTag').value='FREE';
  $('ov').style.display='flex';
}
function closeModal(){ $('ov').style.display='none' }
function edit(i){
  editIdx=i; var b=banners[i];
  $('tTitle').value=b.title||''; $('tSub').value=b.subtitle||''; $('tImg').value=b.image||''; $('tHref').value=b.link||'';
  $('tPrice').value=b.price||0; $('tTag').value=b.tag||(b.price>0?'PRO':'FREE');
  $('delBtn').style.display='inline-grid'; $('ov').style.display='flex';
}
function delBanner(){ if(editIdx==null) return; if(confirm('O‘chirish?')){ banners.splice(editIdx,1); save(); render(); closeModal(); } }
function saveBanner(){
  var d={ title:$('tTitle').value.trim(), subtitle:$('tSub').value.trim(), image:$('tImg').value.trim(),
    link:$('tHref').value.trim(), price:Number($('tPrice').value||0), tag:$('tTag').value };
  if(!d.title || !d.image){ alert('Sarlavha va Rasm URL majburiy.'); return }
  if(editIdx==null) banners.unshift(d); else banners[editIdx]=d;
  save(); render(); closeModal();
}

// ======== DOWNLOAD ========
function downloadHtml(){
  var doc = document.documentElement.cloneNode(true);
  // ensure current banners embedded
  var emb = doc.querySelector('#embedded'); if(!emb){ emb = doc.createElement('script'); emb.id='embedded'; emb.type='application/json'; doc.body.appendChild(emb); }
  emb.textContent = JSON.stringify(banners);
  // show login by default
  var app=doc.getElementById('app'), login=doc.getElementById('login');
  if(app) app.style.display='none'; if(login) login.style.display='grid';
  var html='<!DOCTYPE html>\\n'+doc.outerHTML;
  var blob=new Blob([html],{type:'text/html;charset=utf-8'});
  var a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='home.html'; document.body.appendChild(a); a.click(); setTimeout(function(){URL.revokeObjectURL(a.href); a.remove();}, 700);
}

// ======== LOGIN & UX ========
function doLogin(){
  var L=$('L').value.trim(), P=$('P').value.trim();
  var ok=(L==='Math@1999'&&P==='Math@1999')||(L.toLowerCase()==='admin'&&P==='Math@1999')||(L==='1999'&&P==='1999');
  if(ok){ $('login').style.display='none'; $('app').style.display='block' } else { alert('Login/parol noto‘g‘ri') }
}

(function init(){
  $('go').onclick = doLogin;
  $('show').onchange = function(){ $('P').type = this.checked?'text':'password' };
  ['keydown','keyup'].forEach(function(ev){
    $('P').addEventListener(ev, function(e){
      var caps = e.getModifierState && e.getModifierState('CapsLock');
      $('caps').style.display = caps ? 'block' : 'none';
      if(e.key==='Enter') doLogin();
    })
  });
  // Drag for FAB
  (function(){
    var fab=$('fab'), menu=fab.querySelector('.fabMenu'); var dx=0,dy=0,drag=false;
    fab.addEventListener('mousedown',start); fab.addEventListener('touchstart',start,{passive:true});
    function start(ev){ drag=true; var r=fab.getBoundingClientRect(); dx=(ev.touches?ev.touches[0].clientX:ev.clientX)-r.left; dy=(ev.touches?ev.touches[0].clientY:ev.clientY)-r.top }
    window.addEventListener('mousemove',move); window.addEventListener('touchmove',move,{passive:false});
    function move(ev){ if(!drag) return; ev.preventDefault && ev.preventDefault(); var x=(ev.touches?ev.touches[0].clientX:ev.clientX)-dx, y=(ev.touches?ev.touches[0].clientY:ev.clientY)-dy; fab.style.left='auto'; fab.style.top='auto'; fab.style.right=(window.innerWidth - x - 64 - 8)+'px'; fab.style.bottom=(window.innerHeight - y - 64 - 8)+'px' }
    window.addEventListener('mouseup',end); window.addEventListener('touchend',end);
    function end(){ drag=false }
    // Toggle submenu on click
    fab.addEventListener('click', function(e){ if(!drag){ menu.style.display = menu.style.display==='none'?'flex':'none' } });
  })();

  // Load embedded banners (if file reopened)
  try{ var emb=document.getElementById('embedded'); if(emb){ var arr=JSON.parse(emb.textContent||'[]'); if(Array.isArray(arr) && arr.length){ banners=arr; } } }catch(e){}
  seed();
})();
</script>

<!-- Embedded banners placeholder for downloaded file -->
<script id="embedded" type="application/json">[]</script>
</body>
</html>
