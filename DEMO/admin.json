{
  "schemaVersion": 2,
  "chips": [
    {
      "id": "home",
      "title": "Bosh Sahifa",
      "tags": [
        "Bosh sahifa"
      ],
      "desc": "",
      "icon": "/svg/home.svg",
      "html": "<style>\n  .home-wrap{display:flex;flex-direction:column;gap:16px}\n  .sec{background:var(--card, #fff);border:1px solid var(--frame,#e5e7eb);border-radius:16px;padding:12px}\n  .sec-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}\n  .sec-title{font-weight:800}\n  .nav{display:flex;gap:6px}\n  .nav button{border:1px solid var(--frame,#e5e7eb);background:var(--card,#fff);border-radius:10px;padding:6px 10px;cursor:pointer}\n  .rail{display:grid;grid-auto-flow:column;gap:12px;overflow-x:auto;scroll-snap-type:x mandatory;scrollbar-width:none}\n  .rail::-webkit-scrollbar{display:none}\n  .card{position:relative;scroll-snap-align:center;border-radius:14px;overflow:hidden;flex:0 0 auto;aspect-ratio:16/9;background:#f3f4f6}\n  .card[data-ratio=\"1:1\"]{aspect-ratio:1/1}\n  .card[data-ratio=\"4:3\"]{aspect-ratio:4/3}\n  .img{position:absolute;inset:0;background:#ddd center/cover no-repeat;transition:transform .25s}\n  .card:hover .img{transform:scale(1.02)}\n  .grad{position:absolute;inset:auto 0 0 0;height:48%;background:linear-gradient( to top, rgba(0,0,0,.55), rgba(0,0,0,0) )}\n  .ttl{position:absolute;left:10px;bottom:10px;right:10px;color:#fff;font-weight:700;text-shadow:0 2px 6px rgba(0,0,0,.5)}\n  .badge{position:absolute;top:8px;left:8px;padding:4px 8px;border-radius:999px;font-size:12px;color:#fff;background:#0008}\n  .dots{display:flex;gap:6px;justify-content:center;margin-top:8px}\n  .dot{width:6px;height:6px;border-radius:999px;background:#cbd5e1;opacity:.8}\n  .dot.active{width:18px;background:#0ea5e9;opacity:1;transition:all .2s}\n  @media (max-width:640px){ .sec{padding:10px} }\n</style>\n\n<div id=\"home\" class=\"home-wrap\"></div>\n\n<script>\n(async function(){\n  const hostJSON = '/home.json'; // kerak bo'lsa absolyut/relativ yo'lni o'zgartiring\n  const container = document.getElementById('home');\n\n  // utils\n  const esc = s=>String(s||'').replace(/[&<>\\\"']/g,m=>({\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",\"\\\"\":\"&quot;\",\"'\":\"&#39;\"}[m]));\n  const inDate = iso => !iso || (new Date(iso).getTime() > Date.now());\n\n  let data = {sections:[]};\n  try{\n    data = await fetch(hostJSON,{cache:'no-store'}).then(r=>r.json());\n  }catch(e){\n    container.innerHTML = `<div class=\"sec\"><div class=\"sec-title\">home.json topilmadi</div><div class=\"subtitle\">Faylni joylang: ${esc(hostJSON)}</div></div>`;\n    return;\n  }\n\n  const timers = [];\n\n  data.sections.forEach((sec, si)=>{\n    // wrapper\n    const wrap = document.createElement('section');\n    wrap.className = 'sec';\n    wrap.innerHTML = `\n      <div class=\"sec-head\">\n        <div class=\"sec-title\">${esc(sec.title||'Bo\\'lim')}</div>\n        <div class=\"nav\">\n          <button aria-label=\"prev\">◀</button>\n          <button aria-label=\"next\">▶</button>\n        </div>\n      </div>\n      <div class=\"rail\" id=\"rail-${si}\"></div>\n      <div class=\"dots\" id=\"dots-${si}\"></div>\n    `;\n    container.appendChild(wrap);\n\n    const rail = wrap.querySelector(`#rail-${si}`);\n    const dots = wrap.querySelector(`#dots-${si}`);\n\n    const items = (sec.items||[]).filter(it=>inDate(it.until));\n    if(items.length===0){\n      rail.innerHTML = `<div class=\"subtitle\" style=\"padding:6px 2px\">Banner yo‘q</div>`;\n      return;\n    }\n\n    // cards\n    items.forEach((it, idx)=>{\n      const a = document.createElement('a');\n      a.className = 'card';\n      a.dataset.ratio = sec.ratio || '16:9';\n      a.href = it.link || '#';\n      a.target = (it.link && it.link.startsWith('http'))? '_blank':'_self';\n      a.rel = 'noopener';\n\n      const img = document.createElement('div');\n      img.className = 'img';\n      img.style.backgroundImage = `url('${esc(it.img)}')`;\n      a.appendChild(img);\n\n      if(it.badge){\n        const b = document.createElement('div');\n        b.className = 'badge';\n        b.style.background = it.badgeColor || '#ef4444';\n        b.textContent = it.badge;\n        a.appendChild(b);\n      }\n\n      const grad = document.createElement('div'); grad.className='grad'; a.appendChild(grad);\n      const ttl = document.createElement('div'); ttl.className='ttl'; ttl.innerHTML = esc(it.title||'');\n      if(it.subtitle) ttl.innerHTML += `<div style=\"font-weight:500;opacity:.9\">${esc(it.subtitle)}</div>`;\n      a.appendChild(ttl);\n\n      rail.appendChild(a);\n\n      const d = document.createElement('div'); d.className='dot'+(idx===0?' active':''); dots.appendChild(d);\n    });\n\n    // navigation\n    const prevBtn = wrap.querySelector('.nav button[aria-label=\"prev\"]');\n    const nextBtn = wrap.querySelector('.nav button[aria-label=\"next\"]');\n    const cards = Array.from(rail.children);\n    const dotsList = Array.from(dots.children);\n\n    function goTo(index){\n      const i = Math.max(0, Math.min(index, cards.length-1));\n      cards[i].scrollIntoView({behavior:'smooth', inline:'center', block:'nearest'});\n      dotsList.forEach((d,k)=>d.classList.toggle('active', k===i));\n      rail.dataset.idx = i;\n    }\n    function curr(){ return Number(rail.dataset.idx||0); }\n    prevBtn.onclick = ()=> goTo(curr()-1);\n    nextBtn.onclick = ()=> goTo(curr()+1);\n\n    // autoplay (stories)\n    const interval = Number(sec.autoplayMs||0);\n    if(interval>0 && cards.length>1){\n      const t = setInterval(()=>{\n        let i = curr()+1;\n        if(i>=cards.length) i=0;\n        goTo(i);\n      }, interval);\n      timers.push(t);\n      // pause on hover/touch\n      rail.addEventListener('mouseenter', ()=>clearInterval(t));\n      rail.addEventListener('touchstart', ()=>clearInterval(t), {passive:true});\n    }\n\n    // sync dots on manual scroll\n    rail.addEventListener('scroll', ()=>{\n      // find nearest card to the center\n      const c = cards.map((el, i)=>{\n        const r = el.getBoundingClientRect();\n        const center = window.innerWidth/2;\n        const dist = Math.abs((r.left+r.right)/2 - center);\n        return {i, dist};\n      }).sort((a,b)=>a.dist-b.dist)[0];\n      if(c) { dotsList.forEach((d,k)=>d.classList.toggle('active', k===c.i)); rail.dataset.idx = c.i; }\n    }, {passive:true});\n  });\n\n  // cleanup if chip o'chsa (ihtiyoriy)\n  window.addEventListener('beforeunload', ()=> timers.forEach(t=>clearInterval(t)));\n})();\n</script>\n"
    }
  ]
}